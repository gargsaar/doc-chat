var ts=Object.defineProperty;var es=(K,i,L)=>i in K?ts(K,i,{enumerable:!0,configurable:!0,writable:!0,value:L}):K[i]=L;var Dt=(K,i,L)=>(es(K,typeof i!="symbol"?i+"":i,L),L),he=(K,i,L)=>{if(!i.has(K))throw TypeError("Cannot "+L)};var m=(K,i,L)=>(he(K,i,"read from private field"),L?L.call(K):i.get(K)),et=(K,i,L)=>{if(i.has(K))throw TypeError("Cannot add the same private member more than once");i instanceof WeakSet?i.add(K):i.set(K,L)},pt=(K,i,L,l)=>(he(K,i,"write to private field"),l?l.call(K,L):i.set(K,L),L),ie=(K,i,L,l)=>({set _(S){pt(K,i,S,L)},get _(){return m(K,i,l)}}),ot=(K,i,L)=>(he(K,i,"access private method"),L);import{S as SvelteComponent,i as init,s as safe_not_equal,k as element,l as claim_element,m as children,h as detach,n as attr,p as set_style,b as insert_hydration,C as append_hydration,H as noop,o as onMount,W as onDestroy,w as binding_callbacks,a as space,e as empty,c as claim_space,g as transition_in,d as transition_out,q as text,r as claim_text,u as set_data,v as group_outros,f as check_outros,y as create_component,z as claim_component,A as mount_component,B as destroy_component,E as svg_element,F as claim_svg_element,G as listen,X as stop_propagation,I as run_all,Y as bubble}from"../chunks/index.76caacdb.js";import{b as beforeNavigate}from"../chunks/navigation.eadda804.js";import{r as resetAll,C as ChatPanel,s as sendMessage}from"../chunks/ChatPanel.5d5a3d05.js";import{b as getAugmentedNamespace}from"../chunks/axios.a4108bf7.js";function commonjsRequire(K){throw new Error('Could not dynamically require "'+K+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(i,L){module.exports=L()})(globalThis,()=>(()=>{var __webpack_modules__=[,(K,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.VerbosityLevel=i.Util=i.UnknownErrorException=i.UnexpectedResponseException=i.TextRenderingMode=i.RenderingIntentFlag=i.PermissionFlag=i.PasswordResponses=i.PasswordException=i.PageActionEventType=i.OPS=i.MissingPDFException=i.MAX_IMAGE_SIZE_TO_CACHE=i.LINE_FACTOR=i.LINE_DESCENT_FACTOR=i.InvalidPDFException=i.ImageKind=i.IDENTITY_MATRIX=i.FormatError=i.FeatureTest=i.FONT_IDENTITY_MATRIX=i.DocumentActionEventType=i.CMapCompressionType=i.BaseException=i.BASELINE_FACTOR=i.AnnotationType=i.AnnotationStateModelType=i.AnnotationReviewState=i.AnnotationReplyType=i.AnnotationMode=i.AnnotationMarkedState=i.AnnotationFlag=i.AnnotationFieldFlag=i.AnnotationEditorType=i.AnnotationEditorPrefix=i.AnnotationEditorParamsType=i.AnnotationBorderStyleType=i.AnnotationActionEventType=i.AbortException=void 0,i.assert=yt,i.bytesToString=F,i.createPromiseCapability=xt,i.createValidAbsoluteUrl=f,i.getModificationDate=At,i.getVerbosityLevel=ut,i.info=lt,i.isArrayBuffer=gt,i.isArrayEqual=Et,i.objectFromMap=x,i.objectSize=b,i.setVerbosityLevel=it,i.shadow=p,i.string32=h,i.stringToBytes=e,i.stringToPDFString=dt,i.stringToUTF8String=ct,i.unreachable=bt,i.utf8StringToString=mt,i.warn=ft;const L=[1,0,0,1,0,0];i.IDENTITY_MATRIX=L;const l=[.001,0,0,.001,0,0];i.FONT_IDENTITY_MATRIX=l;const S=1e7;i.MAX_IMAGE_SIZE_TO_CACHE=S;const W=1.35;i.LINE_FACTOR=W;const N=.35;i.LINE_DESCENT_FACTOR=N;const J=N/W;i.BASELINE_FACTOR=J;const R={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};i.RenderingIntentFlag=R;const C={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};i.AnnotationMode=C;const _="pdfjs_internal_editor_";i.AnnotationEditorPrefix=_;const w={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};i.AnnotationEditorType=w;const y={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};i.AnnotationEditorParamsType=y;const A={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};i.PermissionFlag=A;const d={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};i.TextRenderingMode=d;const g={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};i.ImageKind=g;const s={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};i.AnnotationType=s;const r={MARKED:"Marked",REVIEW:"Review"};i.AnnotationStateModelType=r;const k={MARKED:"Marked",UNMARKED:"Unmarked"};i.AnnotationMarkedState=k;const M={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};i.AnnotationReviewState=M;const v={GROUP:"Group",REPLY:"R"};i.AnnotationReplyType=v;const t={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};i.AnnotationFlag=t;const c={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};i.AnnotationFieldFlag=c;const o={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};i.AnnotationBorderStyleType=o;const n={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};i.AnnotationActionEventType=n;const u={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};i.DocumentActionEventType=u;const T={O:"PageOpen",C:"PageClose"};i.PageActionEventType=T;const a={ERRORS:0,WARNINGS:1,INFOS:5};i.VerbosityLevel=a;const D={NONE:0,BINARY:1};i.CMapCompressionType=D;const $={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};i.OPS=$;const Y={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};i.PasswordResponses=Y;let tt=a.WARNINGS;function it(P){Number.isInteger(P)&&(tt=P)}function ut(){return tt}function lt(P){tt>=a.INFOS&&console.log(`Info: ${P}`)}function ft(P){tt>=a.WARNINGS&&console.log(`Warning: ${P}`)}function bt(P){throw new Error(P)}function yt(P,H){P||bt(H)}function G(P){if(!P)return!1;switch(P.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function f(P,H=null,q=null){if(!P)return null;try{if(q&&typeof P=="string"){if(q.addDefaultProtocol&&P.startsWith("www.")){const Ct=P.match(/\./g);Ct&&Ct.length>=2&&(P=`http://${P}`)}if(q.tryConvertEncoding)try{P=ct(P)}catch{}}const _t=H?new URL(P,H):new URL(P);if(G(_t))return _t}catch{}return null}function p(P,H,q,_t=!1){return Object.defineProperty(P,H,{value:q,enumerable:!_t,configurable:!0,writable:!1}),q}const E=function(){function H(q,_t){this.constructor===H&&bt("Cannot initialize BaseException."),this.message=q,this.name=_t}return H.prototype=new Error,H.constructor=H,H}();i.BaseException=E;class U extends E{constructor(H,q){super(H,"PasswordException"),this.code=q}}i.PasswordException=U;class O extends E{constructor(H,q){super(H,"UnknownErrorException"),this.details=q}}i.UnknownErrorException=O;class X extends E{constructor(H){super(H,"InvalidPDFException")}}i.InvalidPDFException=X;class V extends E{constructor(H){super(H,"MissingPDFException")}}i.MissingPDFException=V;class Q extends E{constructor(H,q){super(H,"UnexpectedResponseException"),this.status=q}}i.UnexpectedResponseException=Q;class z extends E{constructor(H){super(H,"FormatError")}}i.FormatError=z;class j extends E{constructor(H){super(H,"AbortException")}}i.AbortException=j;function F(P){(typeof P!="object"||P===null||P.length===void 0)&&bt("Invalid argument for bytesToString");const H=P.length,q=8192;if(H<q)return String.fromCharCode.apply(null,P);const _t=[];for(let Ct=0;Ct<H;Ct+=q){const Z=Math.min(Ct+q,H),ht=P.subarray(Ct,Z);_t.push(String.fromCharCode.apply(null,ht))}return _t.join("")}function e(P){typeof P!="string"&&bt("Invalid argument for stringToBytes");const H=P.length,q=new Uint8Array(H);for(let _t=0;_t<H;++_t)q[_t]=P.charCodeAt(_t)&255;return q}function h(P){return String.fromCharCode(P>>24&255,P>>16&255,P>>8&255,P&255)}function b(P){return Object.keys(P).length}function x(P){const H=Object.create(null);for(const[q,_t]of P)H[q]=_t;return H}function I(){const P=new Uint8Array(4);return P[0]=1,new Uint32Array(P.buffer,0,1)[0]===1}function B(){try{return new Function(""),!0}catch{return!1}}class nt{static get isLittleEndian(){return p(this,"isLittleEndian",I())}static get isEvalSupported(){return p(this,"isEvalSupported",B())}static get isOffscreenCanvasSupported(){return p(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?p(this,"platform",{isWin:!1,isMac:!1}):p(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}i.FeatureTest=nt;const st=[...Array(256).keys()].map(P=>P.toString(16).padStart(2,"0"));class rt{static makeHexColor(H,q,_t){return`#${st[H]}${st[q]}${st[_t]}`}static scaleMinMax(H,q){let _t;H[0]?(H[0]<0&&(_t=q[0],q[0]=q[1],q[1]=_t),q[0]*=H[0],q[1]*=H[0],H[3]<0&&(_t=q[2],q[2]=q[3],q[3]=_t),q[2]*=H[3],q[3]*=H[3]):(_t=q[0],q[0]=q[2],q[2]=_t,_t=q[1],q[1]=q[3],q[3]=_t,H[1]<0&&(_t=q[2],q[2]=q[3],q[3]=_t),q[2]*=H[1],q[3]*=H[1],H[2]<0&&(_t=q[0],q[0]=q[1],q[1]=_t),q[0]*=H[2],q[1]*=H[2]),q[0]+=H[4],q[1]+=H[4],q[2]+=H[5],q[3]+=H[5]}static transform(H,q){return[H[0]*q[0]+H[2]*q[1],H[1]*q[0]+H[3]*q[1],H[0]*q[2]+H[2]*q[3],H[1]*q[2]+H[3]*q[3],H[0]*q[4]+H[2]*q[5]+H[4],H[1]*q[4]+H[3]*q[5]+H[5]]}static applyTransform(H,q){const _t=H[0]*q[0]+H[1]*q[2]+q[4],Ct=H[0]*q[1]+H[1]*q[3]+q[5];return[_t,Ct]}static applyInverseTransform(H,q){const _t=q[0]*q[3]-q[1]*q[2],Ct=(H[0]*q[3]-H[1]*q[2]+q[2]*q[5]-q[4]*q[3])/_t,Z=(-H[0]*q[1]+H[1]*q[0]+q[4]*q[1]-q[5]*q[0])/_t;return[Ct,Z]}static getAxialAlignedBoundingBox(H,q){const _t=rt.applyTransform(H,q),Ct=rt.applyTransform(H.slice(2,4),q),Z=rt.applyTransform([H[0],H[3]],q),ht=rt.applyTransform([H[2],H[1]],q);return[Math.min(_t[0],Ct[0],Z[0],ht[0]),Math.min(_t[1],Ct[1],Z[1],ht[1]),Math.max(_t[0],Ct[0],Z[0],ht[0]),Math.max(_t[1],Ct[1],Z[1],ht[1])]}static inverseTransform(H){const q=H[0]*H[3]-H[1]*H[2];return[H[3]/q,-H[1]/q,-H[2]/q,H[0]/q,(H[2]*H[5]-H[4]*H[3])/q,(H[4]*H[1]-H[5]*H[0])/q]}static singularValueDecompose2dScale(H){const q=[H[0],H[2],H[1],H[3]],_t=H[0]*q[0]+H[1]*q[2],Ct=H[0]*q[1]+H[1]*q[3],Z=H[2]*q[0]+H[3]*q[2],ht=H[2]*q[1]+H[3]*q[3],vt=(_t+ht)/2,St=Math.sqrt((_t+ht)**2-4*(_t*ht-Z*Ct))/2,Ft=vt+St||1,Pt=vt-St||1;return[Math.sqrt(Ft),Math.sqrt(Pt)]}static normalizeRect(H){const q=H.slice(0);return H[0]>H[2]&&(q[0]=H[2],q[2]=H[0]),H[1]>H[3]&&(q[1]=H[3],q[3]=H[1]),q}static intersect(H,q){const _t=Math.max(Math.min(H[0],H[2]),Math.min(q[0],q[2])),Ct=Math.min(Math.max(H[0],H[2]),Math.max(q[0],q[2]));if(_t>Ct)return null;const Z=Math.max(Math.min(H[1],H[3]),Math.min(q[1],q[3])),ht=Math.min(Math.max(H[1],H[3]),Math.max(q[1],q[3]));return Z>ht?null:[_t,Z,Ct,ht]}static bezierBoundingBox(H,q,_t,Ct,Z,ht,vt,St){const Ft=[],Pt=[[],[]];let kt,wt,Rt,Tt,Nt,Mt,Ot,Lt;for(let Ht=0;Ht<2;++Ht){if(Ht===0?(wt=6*H-12*_t+6*Z,kt=-3*H+9*_t-9*Z+3*vt,Rt=3*_t-3*H):(wt=6*q-12*Ct+6*ht,kt=-3*q+9*Ct-9*ht+3*St,Rt=3*Ct-3*q),Math.abs(kt)<1e-12){if(Math.abs(wt)<1e-12)continue;Tt=-Rt/wt,0<Tt&&Tt<1&&Ft.push(Tt);continue}Ot=wt*wt-4*Rt*kt,Lt=Math.sqrt(Ot),!(Ot<0)&&(Nt=(-wt+Lt)/(2*kt),0<Nt&&Nt<1&&Ft.push(Nt),Mt=(-wt-Lt)/(2*kt),0<Mt&&Mt<1&&Ft.push(Mt))}let jt=Ft.length,It;const Bt=jt;for(;jt--;)Tt=Ft[jt],It=1-Tt,Pt[0][jt]=It*It*It*H+3*It*It*Tt*_t+3*It*Tt*Tt*Z+Tt*Tt*Tt*vt,Pt[1][jt]=It*It*It*q+3*It*It*Tt*Ct+3*It*Tt*Tt*ht+Tt*Tt*Tt*St;return Pt[0][Bt]=H,Pt[1][Bt]=q,Pt[0][Bt+1]=vt,Pt[1][Bt+1]=St,Pt[0].length=Pt[1].length=Bt+2,[Math.min(...Pt[0]),Math.min(...Pt[1]),Math.max(...Pt[0]),Math.max(...Pt[1])]}}i.Util=rt;const at=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function dt(P){if(P[0]>="ï"){let q;if(P[0]==="þ"&&P[1]==="ÿ"?q="utf-16be":P[0]==="ÿ"&&P[1]==="þ"?q="utf-16le":P[0]==="ï"&&P[1]==="»"&&P[2]==="¿"&&(q="utf-8"),q)try{const _t=new TextDecoder(q,{fatal:!0}),Ct=e(P);return _t.decode(Ct)}catch(_t){ft(`stringToPDFString: "${_t}".`)}}const H=[];for(let q=0,_t=P.length;q<_t;q++){const Ct=at[P.charCodeAt(q)];H.push(Ct?String.fromCharCode(Ct):P.charAt(q))}return H.join("")}function ct(P){return decodeURIComponent(escape(P))}function mt(P){return unescape(encodeURIComponent(P))}function gt(P){return typeof P=="object"&&P!==null&&P.byteLength!==void 0}function Et(P,H){if(P.length!==H.length)return!1;for(let q=0,_t=P.length;q<_t;q++)if(P[q]!==H[q])return!1;return!0}function At(P=new Date){return[P.getUTCFullYear().toString(),(P.getUTCMonth()+1).toString().padStart(2,"0"),P.getUTCDate().toString().padStart(2,"0"),P.getUTCHours().toString().padStart(2,"0"),P.getUTCMinutes().toString().padStart(2,"0"),P.getUTCSeconds().toString().padStart(2,"0")].join("")}function xt(){const P=Object.create(null);let H=!1;return Object.defineProperty(P,"settled",{get(){return H}}),P.promise=new Promise(function(q,_t){P.resolve=function(Ct){H=!0,q(Ct)},P.reject=function(Ct){H=!0,_t(Ct)}}),P}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var K,L,l,S,$t,N,re,R,C,_,w,y,A,d,g,de,r,k,ue,v,t;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(10),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultFilterFactory=_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:o,NodeCMapReaderFactory:n,NodeFilterFactory:u,NodeStandardFontDataFactory:T}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=o,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=n,exports.DefaultFilterFactory=DefaultFilterFactory=u,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=T}let createPDFNetworkStream;if(_is_node.isNodeJS){const{PDFNodeStream:o}=__w_pdfjs_require__(21);createPDFNetworkStream=n=>new o(n)}else{const{PDFNetworkStream:o}=__w_pdfjs_require__(24),{PDFFetchStream:n}=__w_pdfjs_require__(25);createPDFNetworkStream=u=>(0,_display_utils.isValidFetchUrl)(u.url)?new n(u):new o(u)}function getDocument(o){if(typeof o=="string"||o instanceof URL?o={url:o}:(0,_util.isArrayBuffer)(o)&&(o={data:o}),typeof o!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!o.url&&!o.data&&!o.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const n=new PDFDocumentLoadingTask,{docId:u}=n,T=o.url?getUrlProp(o.url):null,a=o.data?getDataProp(o.data):null,D=o.httpHeaders||null,$=o.withCredentials===!0,Y=o.password??null,tt=o.range instanceof PDFDataRangeTransport?o.range:null,it=Number.isInteger(o.rangeChunkSize)&&o.rangeChunkSize>0?o.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let ut=o.worker instanceof PDFWorker?o.worker:null;const lt=o.verbosity,ft=typeof o.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(o.docBaseUrl)?o.docBaseUrl:null,bt=typeof o.cMapUrl=="string"?o.cMapUrl:null,yt=o.cMapPacked!==!1,G=o.CMapReaderFactory||DefaultCMapReaderFactory,f=typeof o.standardFontDataUrl=="string"?o.standardFontDataUrl:null,p=o.StandardFontDataFactory||DefaultStandardFontDataFactory,E=o.stopAtErrors!==!0,U=Number.isInteger(o.maxImageSize)&&o.maxImageSize>-1?o.maxImageSize:-1,O=o.isEvalSupported!==!1,X=typeof o.isOffscreenCanvasSupported=="boolean"?o.isOffscreenCanvasSupported:!_is_node.isNodeJS,V=Number.isInteger(o.canvasMaxAreaInBytes)?o.canvasMaxAreaInBytes:-1,Q=typeof o.disableFontFace=="boolean"?o.disableFontFace:_is_node.isNodeJS,z=o.fontExtraProperties===!0,j=o.enableXfa===!0,F=o.ownerDocument||globalThis.document,e=o.disableRange===!0,h=o.disableStream===!0,b=o.disableAutoFetch===!0,x=o.pdfBug===!0,I=tt?tt.length:o.length??NaN,B=typeof o.useSystemFonts=="boolean"?o.useSystemFonts:!_is_node.isNodeJS&&!Q,nt=typeof o.useWorkerFetch=="boolean"?o.useWorkerFetch:G===_display_utils.DOMCMapReaderFactory&&p===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(bt,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(f,document.baseURI),st=o.canvasFactory||new DefaultCanvasFactory({ownerDocument:F}),rt=o.filterFactory||new DefaultFilterFactory({docId:u,ownerDocument:F}),at=null;(0,_util.setVerbosityLevel)(lt);const dt={canvasFactory:st,filterFactory:rt};if(nt||(dt.cMapReaderFactory=new G({baseUrl:bt,isCompressed:yt}),dt.standardFontDataFactory=new p({baseUrl:f})),!ut){const gt={verbosity:lt,port:_worker_options.GlobalWorkerOptions.workerPort};ut=gt.port?PDFWorker.fromPort(gt):new PDFWorker(gt),n._worker=ut}const ct={docId:u,apiVersion:"3.5.141",data:a,password:Y,disableAutoFetch:b,rangeChunkSize:it,length:I,docBaseUrl:ft,enableXfa:j,evaluatorOptions:{maxImageSize:U,disableFontFace:Q,ignoreErrors:E,isEvalSupported:O,isOffscreenCanvasSupported:X,canvasMaxAreaInBytes:V,fontExtraProperties:z,useSystemFonts:B,cMapUrl:nt?bt:null,standardFontDataUrl:nt?f:null}},mt={ignoreErrors:E,isEvalSupported:O,disableFontFace:Q,fontExtraProperties:z,enableXfa:j,ownerDocument:F,disableAutoFetch:b,pdfBug:x,styleElement:at};return ut.promise.then(function(){if(n.destroyed)throw new Error("Loading aborted");const gt=_fetchDocument(ut,ct),Et=new Promise(function(At){let xt;tt?xt=new _transport_stream.PDFDataTransportStream({length:I,initialData:tt.initialData,progressiveDone:tt.progressiveDone,contentDispositionFilename:tt.contentDispositionFilename,disableRange:e,disableStream:h},tt):a||(xt=createPDFNetworkStream({url:T,length:I,httpHeaders:D,withCredentials:$,rangeChunkSize:it,disableRange:e,disableStream:h})),At(xt)});return Promise.all([gt,Et]).then(function([At,xt]){if(n.destroyed)throw new Error("Loading aborted");const P=new _message_handler.MessageHandler(u,At,ut.port),H=new WorkerTransport(P,n,xt,mt,dt);n._transport=H,P.send("Ready",null)})}).catch(n._capability.reject),n}async function _fetchDocument(o,n){if(o.destroyed)throw new Error("Worker was destroyed");const u=await o.messageHandler.sendWithPromise("GetDocRequest",n,n.data?[n.data.buffer]:null);if(o.destroyed)throw new Error("Worker was destroyed");return u}function getUrlProp(o){if(o instanceof URL)return o.href;try{return new URL(o,window.location).href}catch{if(_is_node.isNodeJS&&typeof o=="string")return o}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(o){if(_is_node.isNodeJS&&typeof Buffer<"u"&&o instanceof Buffer)return(0,_display_utils.deprecated)("Please provide binary data as `Uint8Array`, rather than `Buffer`."),new Uint8Array(o);if(o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength)return o;if(typeof o=="string")return(0,_util.stringToBytes)(o);if(typeof o=="object"&&!isNaN(o==null?void 0:o.length)||(0,_util.isArrayBuffer)(o))return new Uint8Array(o);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const i=class{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${ie(i,K)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var n;this.destroyed=!0,await((n=this._transport)==null?void 0:n.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=i;K=new WeakMap,et(PDFDocumentLoadingTask,K,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(n,u,T=!1,a=null){this.length=n,this.initialData=u,this.progressiveDone=T,this.contentDispositionFilename=a,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(n){this._rangeListeners.push(n)}addProgressListener(n){this._progressListeners.push(n)}addProgressiveReadListener(n){this._progressiveReadListeners.push(n)}addProgressiveDoneListener(n){this._progressiveDoneListeners.push(n)}onDataRange(n,u){for(const T of this._rangeListeners)T(n,u)}onDataProgress(n,u){this._readyCapability.promise.then(()=>{for(const T of this._progressListeners)T(n,u)})}onDataProgressiveRead(n){this._readyCapability.promise.then(()=>{for(const u of this._progressiveReadListeners)u(n)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const n of this._progressiveDoneListeners)n()})}transportReady(){this._readyCapability.resolve()}requestDataRange(n,u){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(n,u){this._pdfInfo=n,this._transport=u}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(n){return this._transport.getPage(n)}getPageIndex(n){return this._transport.getPageIndex(n)}getDestinations(){return this._transport.getDestinations()}getDestination(n){return this._transport.getDestination(n)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(n=!1){return this._transport.startCleanup(n||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(n,u,T,a=!1){et(this,S);et(this,N);et(this,L,null);et(this,l,!1);this._pageIndex=n,this._pageInfo=u,this._transport=T,this._stats=a?new _display_utils.StatTimer:null,this._pdfBug=a,this.commonObjs=T.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:n,rotation:u=this.rotate,offsetX:T=0,offsetY:a=0,dontFlip:D=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:n,rotation:u,offsetX:T,offsetY:a,dontFlip:D})}getAnnotations({intent:n="display"}={}){const u=this._transport.getRenderingIntent(n);return this._transport.getAnnotations(this._pageIndex,u.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var n;return((n=this._transport._htmlForXfa)==null?void 0:n.children[this._pageIndex])||null}render({canvasContext:n,viewport:u,intent:T="display",annotationMode:a=_util.AnnotationMode.ENABLE,transform:D=null,background:$=null,optionalContentConfigPromise:Y=null,annotationCanvasMap:tt=null,pageColors:it=null,printAnnotationStorage:ut=null}){var p,E,U;if((p=arguments[0])!=null&&p.canvasFactory)throw new Error("render no longer accepts the `canvasFactory`-option, please pass it to the `getDocument`-function instead.");(E=this._stats)==null||E.time("Overall");const lt=this._transport.getRenderingIntent(T,a,ut);pt(this,l,!1),ot(this,N,re).call(this),Y||(Y=this._transport.getOptionalContentConfig());let ft=this._intentStates.get(lt.cacheKey);ft||(ft=Object.create(null),this._intentStates.set(lt.cacheKey,ft)),ft.streamReaderCancelTimeout&&(clearTimeout(ft.streamReaderCancelTimeout),ft.streamReaderCancelTimeout=null);const bt=!!(lt.renderingIntent&_util.RenderingIntentFlag.PRINT);ft.displayReadyCapability||(ft.displayReadyCapability=(0,_util.createPromiseCapability)(),ft.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(U=this._stats)==null||U.time("Page Request"),this._pumpOperatorList(lt));const yt=O=>{var X,V;ft.renderTasks.delete(G),(this._maybeCleanupAfterRender||bt)&&pt(this,l,!0),ot(this,S,$t).call(this,!bt),O?(G.capability.reject(O),this._abortOperatorList({intentState:ft,reason:O instanceof Error?O:new Error(O)})):G.capability.resolve(),(X=this._stats)==null||X.timeEnd("Rendering"),(V=this._stats)==null||V.timeEnd("Overall")},G=new InternalRenderTask({callback:yt,params:{canvasContext:n,viewport:u,transform:D,background:$},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:tt,operatorList:ft.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!bt,pdfBug:this._pdfBug,pageColors:it});(ft.renderTasks||(ft.renderTasks=new Set)).add(G);const f=G.task;return Promise.all([ft.displayReadyCapability.promise,Y]).then(([O,X])=>{var V;if(m(this,l)){yt();return}(V=this._stats)==null||V.time("Rendering"),G.initializeGraphics({transparency:O,optionalContentConfig:X}),G.operatorListChanged()}).catch(yt),f}getOperatorList({intent:n="display",annotationMode:u=_util.AnnotationMode.ENABLE,printAnnotationStorage:T=null}={}){var tt;function a(){$.operatorList.lastChunk&&($.opListReadCapability.resolve($.operatorList),$.renderTasks.delete(Y))}const D=this._transport.getRenderingIntent(n,u,T,!0);let $=this._intentStates.get(D.cacheKey);$||($=Object.create(null),this._intentStates.set(D.cacheKey,$));let Y;return $.opListReadCapability||(Y=Object.create(null),Y.operatorListChanged=a,$.opListReadCapability=(0,_util.createPromiseCapability)(),($.renderTasks||($.renderTasks=new Set)).add(Y),$.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(tt=this._stats)==null||tt.time("Page Request"),this._pumpOperatorList(D)),$.opListReadCapability.promise}streamTextContent({includeMarkedContent:n=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:n===!0},{highWaterMark:100,size(T){return T.items.length}})}getTextContent(n={}){if(this._transport._htmlForXfa)return this.getXfa().then(T=>_xfa_text.XfaText.textContent(T));const u=this.streamTextContent(n);return new Promise(function(T,a){function D(){$.read().then(function({value:tt,done:it}){if(it){T(Y);return}Object.assign(Y.styles,tt.styles),Y.items.push(...tt.items),D()},a)}const $=u.getReader(),Y={items:[],styles:Object.create(null)};D()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const n=[];for(const u of this._intentStates.values())if(this._abortOperatorList({intentState:u,reason:new Error("Page was destroyed."),force:!0}),!u.opListReadCapability)for(const T of u.renderTasks)n.push(T.completed),T.cancel();return this.objs.clear(),pt(this,l,!1),ot(this,N,re).call(this),Promise.all(n)}cleanup(n=!1){pt(this,l,!0);const u=ot(this,S,$t).call(this,!1);return n&&u&&this._stats&&(this._stats=new _display_utils.StatTimer),u}_startRenderPage(n,u){var a,D;const T=this._intentStates.get(u);T&&((a=this._stats)==null||a.timeEnd("Page Request"),(D=T.displayReadyCapability)==null||D.resolve(n))}_renderPageChunk(n,u){for(let T=0,a=n.length;T<a;T++)u.operatorList.fnArray.push(n.fnArray[T]),u.operatorList.argsArray.push(n.argsArray[T]);u.operatorList.lastChunk=n.lastChunk,u.operatorList.separateAnnots=n.separateAnnots;for(const T of u.renderTasks)T.operatorListChanged();n.lastChunk&&ot(this,S,$t).call(this,!0)}_pumpOperatorList({renderingIntent:n,cacheKey:u,annotationStorageMap:T}){const D=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:n,cacheKey:u,annotationStorage:T}).getReader(),$=this._intentStates.get(u);$.streamReader=D;const Y=()=>{D.read().then(({value:tt,done:it})=>{if(it){$.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(tt,$),Y())},tt=>{if($.streamReader=null,!this._transport.destroyed){if($.operatorList){$.operatorList.lastChunk=!0;for(const it of $.renderTasks)it.operatorListChanged();ot(this,S,$t).call(this,!0)}if($.displayReadyCapability)$.displayReadyCapability.reject(tt);else if($.opListReadCapability)$.opListReadCapability.reject(tt);else throw tt}})};Y()}_abortOperatorList({intentState:n,reason:u,force:T=!1}){if(n.streamReader){if(n.streamReaderCancelTimeout&&(clearTimeout(n.streamReaderCancelTimeout),n.streamReaderCancelTimeout=null),!T){if(n.renderTasks.size>0)return;if(u instanceof _display_utils.RenderingCancelledException){let a=RENDERING_CANCELLED_TIMEOUT;u.extraDelay>0&&u.extraDelay<1e3&&(a+=u.extraDelay),n.streamReaderCancelTimeout=setTimeout(()=>{n.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:n,reason:u,force:!0})},a);return}}if(n.streamReader.cancel(new _util.AbortException(u.message)).catch(()=>{}),n.streamReader=null,!this._transport.destroyed){for(const[a,D]of this._intentStates)if(D===n){this._intentStates.delete(a);break}this.cleanup()}}}get stats(){return this._stats}}L=new WeakMap,l=new WeakMap,S=new WeakSet,$t=function(n=!1){if(ot(this,N,re).call(this),!m(this,l))return!1;if(n)return pt(this,L,setTimeout(()=>{pt(this,L,null),ot(this,S,$t).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:u,operatorList:T}of this._intentStates.values())if(u.size>0||!T.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),pt(this,l,!1),!0},N=new WeakSet,re=function(){m(this,L)&&(clearTimeout(m(this,L)),pt(this,L,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){et(this,R,new Set);et(this,C,Promise.resolve())}postMessage(n,u){const T={data:structuredClone(n,u?{transfer:u}:null)};m(this,C).then(()=>{for(const a of m(this,R))a.call(this,T)})}addEventListener(n,u){m(this,R).add(u)}removeEventListener(n,u){m(this,R).delete(u)}terminate(){m(this,R).clear()}}R=new WeakMap,C=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const o=(_=document==null?void 0:document.currentScript)==null?void 0:_.src;o&&(PDFWorkerUtil.fallbackWorkerSrc=o.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(o,n){let u;try{if(u=new URL(o),!u.origin||u.origin==="null")return!1}catch{return!1}const T=new URL(n,u);return u.origin===T.origin},PDFWorkerUtil.createCDNWrapper=function(o){const n=`importScripts("${o}");`;return URL.createObjectURL(new Blob([n]))}}const _PDFWorker=class{constructor({name:o=null,port:n=null,verbosity:u=(0,_util.getVerbosityLevel)()}={}){if(n&&m(_PDFWorker,w).has(n))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=o,this.destroyed=!1,this.verbosity=u,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,n){m(_PDFWorker,w).set(n,this),this._initializeFromPort(n);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(o){this._port=o,this._messageHandler=new _message_handler.MessageHandler("main","worker",o),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:o}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,o)||(o=PDFWorkerUtil.createCDNWrapper(new URL(o,window.location).href));const n=new Worker(o),u=new _message_handler.MessageHandler("main","worker",n),T=()=>{n.removeEventListener("error",a),u.destroy(),n.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},a=()=>{this._webWorker||T()};n.addEventListener("error",a),u.on("test",$=>{if(n.removeEventListener("error",a),this.destroyed){T();return}$?(this._messageHandler=u,this._port=n,this._webWorker=n,this._readyCapability.resolve(),u.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),u.destroy(),n.terminate())}),u.on("ready",$=>{if(n.removeEventListener("error",a),this.destroyed){T();return}try{D()}catch{this._setupFakeWorker()}});const D=()=>{const $=new Uint8Array;u.send("test",$,[$.buffer])};D();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(o=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const n=new LoopbackPort;this._port=n;const u=`fake${PDFWorkerUtil.fakeWorkerId++}`,T=new _message_handler.MessageHandler(u+"_worker",u,n);o.setup(T,n);const a=new _message_handler.MessageHandler(u,u+"_worker",n);this._messageHandler=a,this._readyCapability.resolve(),a.send("configure",{verbosity:this.verbosity})}).catch(o=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${o.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),m(_PDFWorker,w).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(o){if(!(o!=null&&o.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return m(this,w).has(o.port)?m(this,w).get(o.port):new _PDFWorker(o)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var o;try{return((o=globalThis.pdfjsWorker)==null?void 0:o.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;w=new WeakMap,et(PDFWorker,w,new WeakMap),exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(n,u,T,a,D){et(this,g);et(this,y,new Map);et(this,A,new Map);et(this,d,new Map);this.messageHandler=n,this.loadingTask=u,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:a.ownerDocument,styleElement:a.styleElement}),this._params=a,this.canvasFactory=D.canvasFactory,this.filterFactory=D.filterFactory,this.cMapReaderFactory=D.cMapReaderFactory,this.standardFontDataFactory=D.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=T,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(n,u=_util.AnnotationMode.ENABLE,T=null,a=!1){let D=_util.RenderingIntentFlag.DISPLAY,$=null;switch(n){case"any":D=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":D=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${n}`)}switch(u){case _util.AnnotationMode.DISABLE:D+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:D+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:D+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,$=(D&_util.RenderingIntentFlag.PRINT&&T instanceof _annotation_storage.PrintAnnotationStorage?T:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${u}`)}return a&&(D+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:D,cacheKey:`${D}_${_annotation_storage.AnnotationStorage.getHash($)}`,annotationStorageMap:$}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const n=[];for(const T of m(this,A).values())n.push(T._destroy());m(this,A).clear(),m(this,d).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const u=this.messageHandler.sendWithPromise("Terminate",null);return n.push(u),Promise.all(n).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),m(this,y).clear(),this.filterFactory.destroy(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:n,loadingTask:u}=this;n.on("GetReader",(T,a)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=D=>{this._lastProgress={loaded:D.loaded,total:D.total}},a.onPull=()=>{this._fullReader.read().then(function({value:D,done:$}){if($){a.close();return}(0,_util.assert)(D instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(D),1,[D])}).catch(D=>{a.error(D)})},a.onCancel=D=>{this._fullReader.cancel(D),a.ready.catch($=>{if(!this.destroyed)throw $})}}),n.on("ReaderHeadersReady",T=>{const a=(0,_util.createPromiseCapability)(),D=this._fullReader;return D.headersReady.then(()=>{var $;(!D.isStreamingSupported||!D.isRangeSupported)&&(this._lastProgress&&(($=u.onProgress)==null||$.call(u,this._lastProgress)),D.onProgress=Y=>{var tt;(tt=u.onProgress)==null||tt.call(u,{loaded:Y.loaded,total:Y.total})}),a.resolve({isStreamingSupported:D.isStreamingSupported,isRangeSupported:D.isRangeSupported,contentLength:D.contentLength})},a.reject),a.promise}),n.on("GetRangeReader",(T,a)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const D=this._networkStream.getRangeReader(T.begin,T.end);if(!D){a.close();return}a.onPull=()=>{D.read().then(function({value:$,done:Y}){if(Y){a.close();return}(0,_util.assert)($ instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array($),1,[$])}).catch($=>{a.error($)})},a.onCancel=$=>{D.cancel($),a.ready.catch(Y=>{if(!this.destroyed)throw Y})}}),n.on("GetDoc",({pdfInfo:T})=>{this._numPages=T.numPages,this._htmlForXfa=T.htmlForXfa,delete T.htmlForXfa,u._capability.resolve(new PDFDocumentProxy(T,this))}),n.on("DocException",function(T){let a;switch(T.name){case"PasswordException":a=new _util.PasswordException(T.message,T.code);break;case"InvalidPDFException":a=new _util.InvalidPDFException(T.message);break;case"MissingPDFException":a=new _util.MissingPDFException(T.message);break;case"UnexpectedResponseException":a=new _util.UnexpectedResponseException(T.message,T.status);break;case"UnknownErrorException":a=new _util.UnknownErrorException(T.message,T.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}u._capability.reject(a)}),n.on("PasswordRequest",T=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),u.onPassword){const a=D=>{D instanceof Error?this._passwordCapability.reject(D):this._passwordCapability.resolve({password:D})};try{u.onPassword(a,T.code)}catch(D){this._passwordCapability.reject(D)}}else this._passwordCapability.reject(new _util.PasswordException(T.message,T.code));return this._passwordCapability.promise}),n.on("DataLoaded",T=>{var a;(a=u.onProgress)==null||a.call(u,{loaded:T.length,total:T.length}),this.downloadInfoCapability.resolve(T)}),n.on("StartRenderPage",T=>{if(this.destroyed)return;m(this,A).get(T.pageIndex)._startRenderPage(T.transparency,T.cacheKey)}),n.on("commonobj",([T,a,D])=>{var $;if(!this.destroyed&&!this.commonObjs.has(T))switch(a){case"Font":const Y=this._params;if("error"in D){const ut=D.error;(0,_util.warn)(`Error during font loading: ${ut}`),this.commonObjs.resolve(T,ut);break}const tt=Y.pdfBug&&(($=globalThis.FontInspector)!=null&&$.enabled)?(ut,lt)=>globalThis.FontInspector.fontAdded(ut,lt):null,it=new _font_loader.FontFaceObject(D,{isEvalSupported:Y.isEvalSupported,disableFontFace:Y.disableFontFace,ignoreErrors:Y.ignoreErrors,inspectFont:tt});this.fontLoader.bind(it).catch(ut=>n.sendWithPromise("FontFallback",{id:T})).finally(()=>{!Y.fontExtraProperties&&it.data&&(it.data=null),this.commonObjs.resolve(T,it)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(T,D);break;default:throw new Error(`Got unknown common object type ${a}`)}}),n.on("obj",([T,a,D,$])=>{var tt;if(this.destroyed)return;const Y=m(this,A).get(a);if(!Y.objs.has(T))switch(D){case"Image":if(Y.objs.resolve(T,$),$){let it;if($.bitmap){const{width:ut,height:lt}=$;it=ut*lt*4}else it=((tt=$.data)==null?void 0:tt.length)||0;it>_util.MAX_IMAGE_SIZE_TO_CACHE&&(Y._maybeCleanupAfterRender=!0)}break;case"Pattern":Y.objs.resolve(T,$);break;default:throw new Error(`Got unknown object type ${D}`)}}),n.on("DocProgress",T=>{var a;this.destroyed||(a=u.onProgress)==null||a.call(u,{loaded:T.loaded,total:T.total})}),n.on("FetchBuiltInCMap",T=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(T):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),n.on("FetchStandardFontData",T=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(T):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((n=this._fullReader)==null?void 0:n.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(n){if(!Number.isInteger(n)||n<=0||n>this._numPages)return Promise.reject(new Error("Invalid page request."));const u=n-1,T=m(this,d).get(u);if(T)return T;const a=this.messageHandler.sendWithPromise("GetPage",{pageIndex:u}).then(D=>{if(this.destroyed)throw new Error("Transport destroyed");const $=new PDFPageProxy(u,D,this,this._params.pdfBug);return m(this,A).set(u,$),$});return m(this,d).set(u,a),a}getPageIndex(n){return typeof n!="object"||n===null||!Number.isInteger(n.num)||n.num<0||!Number.isInteger(n.gen)||n.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:n.num,gen:n.gen})}getAnnotations(n,u){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:n,intent:u})}getFieldObjects(){return ot(this,g,de).call(this,"GetFieldObjects")}hasJSActions(){return ot(this,g,de).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(n){return typeof n!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:n})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(n){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:n})}getStructTree(n){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:n})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(n=>new _optional_content_config.OptionalContentConfig(n))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const n="GetMetadata",u=m(this,y).get(n);if(u)return u;const T=this.messageHandler.sendWithPromise(n,null).then(a=>{var D,$;return{info:a[0],metadata:a[1]?new _metadata.Metadata(a[1]):null,contentDispositionFilename:((D=this._fullReader)==null?void 0:D.filename)??null,contentLength:(($=this._fullReader)==null?void 0:$.contentLength)??null}});return m(this,y).set(n,T),T}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(n=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const u of m(this,A).values())if(!u.cleanup())throw new Error(`startCleanup: Page ${u.pageNumber} is currently rendering.`);this.commonObjs.clear(),n||this.fontLoader.clear(),m(this,y).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:n,enableXfa:u}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:n,enableXfa:u})}}y=new WeakMap,A=new WeakMap,d=new WeakMap,g=new WeakSet,de=function(n,u=null){const T=m(this,y).get(n);if(T)return T;const a=this.messageHandler.sendWithPromise(n,u);return m(this,y).set(n,a),a};class PDFObjects{constructor(){et(this,k);et(this,r,Object.create(null))}get(n,u=null){if(u){const a=ot(this,k,ue).call(this,n);return a.capability.promise.then(()=>u(a.data)),null}const T=m(this,r)[n];if(!(T!=null&&T.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${n}.`);return T.data}has(n){const u=m(this,r)[n];return(u==null?void 0:u.capability.settled)||!1}resolve(n,u=null){const T=ot(this,k,ue).call(this,n);T.data=u,T.capability.resolve()}clear(){var n;for(const u in m(this,r)){const{data:T}=m(this,r)[u];(n=T==null?void 0:T.bitmap)==null||n.close()}pt(this,r,Object.create(null))}}r=new WeakMap,k=new WeakSet,ue=function(n){const u=m(this,r)[n];return u||(m(this,r)[n]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(n){et(this,v,null);pt(this,v,n),this.onContinue=null}get promise(){return m(this,v).capability.promise}cancel(n=0){m(this,v).cancel(null,n)}get separateAnnots(){const{separateAnnots:n}=m(this,v).operatorList;if(!n)return!1;const{annotationCanvasMap:u}=m(this,v);return n.form||n.canvas&&(u==null?void 0:u.size)>0}}v=new WeakMap,exports.RenderTask=RenderTask;const c=class{constructor({callback:n,params:u,objs:T,commonObjs:a,annotationCanvasMap:D,operatorList:$,pageIndex:Y,canvasFactory:tt,filterFactory:it,useRequestAnimationFrame:ut=!1,pdfBug:lt=!1,pageColors:ft=null}){this.callback=n,this.params=u,this.objs=T,this.commonObjs=a,this.annotationCanvasMap=D,this.operatorListIdx=null,this.operatorList=$,this._pageIndex=Y,this.canvasFactory=tt,this.filterFactory=it,this._pdfBug=lt,this.pageColors=ft,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=ut===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=u.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:n=!1,optionalContentConfig:u}){var Y,tt;if(this.cancelled)return;if(this._canvas){if(m(c,t).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");m(c,t).add(this._canvas)}this._pdfBug&&((Y=globalThis.StepperManager)!=null&&Y.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:T,viewport:a,transform:D,background:$}=this.params;this.gfx=new _canvas.CanvasGraphics(T,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:u},this.annotationCanvasMap),this.gfx.beginDrawing({transform:D,viewport:a,transparency:n,background:$}),this.operatorListIdx=0,this.graphicsReady=!0,(tt=this.graphicsReadyCallback)==null||tt.call(this)}cancel(n=null,u=0){var T;this.running=!1,this.cancelled=!0,(T=this.gfx)==null||T.endDrawing(this.pageColors),this._canvas&&m(c,t).delete(this._canvas),this.callback(n||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas",u))}operatorListChanged(){var n;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(n=this.stepper)==null||n.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(this.pageColors),this._canvas&&m(c,t).delete(this._canvas),this.callback())))}};let InternalRenderTask=c;t=new WeakMap,et(InternalRenderTask,t,new WeakSet);const version="3.5.141";exports.version=version;const build="be0f6ee08";exports.build=build},(K,i,L)=>{var R,C,_,Me,y;Object.defineProperty(i,"__esModule",{value:!0}),i.PrintAnnotationStorage=i.AnnotationStorage=void 0;var l=L(1),S=L(4),W=L(8);class N{constructor(){et(this,_);et(this,R,!1);et(this,C,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(d,g){const s=m(this,C).get(d);return s===void 0?g:Object.assign(g,s)}getRawValue(d){return m(this,C).get(d)}remove(d){if(m(this,C).delete(d),m(this,C).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const g of m(this,C).values())if(g instanceof S.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(d,g){const s=m(this,C).get(d);let r=!1;if(s!==void 0)for(const[k,M]of Object.entries(g))s[k]!==M&&(r=!0,s[k]=M);else r=!0,m(this,C).set(d,g);r&&ot(this,_,Me).call(this),g instanceof S.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(g.constructor._type)}has(d){return m(this,C).has(d)}getAll(){return m(this,C).size>0?(0,l.objectFromMap)(m(this,C)):null}setAll(d){for(const[g,s]of Object.entries(d))this.setValue(g,s)}get size(){return m(this,C).size}resetModified(){m(this,R)&&(pt(this,R,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new J(this)}get serializable(){if(m(this,C).size===0)return null;const d=new Map;for(const[g,s]of m(this,C)){const r=s instanceof S.AnnotationEditor?s.serialize():s;r&&d.set(g,r)}return d}static getHash(d){if(!d)return"";const g=new W.MurmurHash3_64;for(const[s,r]of d)g.update(`${s}:${JSON.stringify(r)}`);return g.hexdigest()}}R=new WeakMap,C=new WeakMap,_=new WeakSet,Me=function(){m(this,R)||(pt(this,R,!0),typeof this.onSetModified=="function"&&this.onSetModified())},i.AnnotationStorage=N;class J extends N{constructor(g){super();et(this,y,null);pt(this,y,structuredClone(g.serializable))}get print(){(0,l.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return m(this,y)}}y=new WeakMap,i.PrintAnnotationStorage=J},(K,i,L)=>{var N,J,R,C,_,w;Object.defineProperty(i,"__esModule",{value:!0}),i.AnnotationEditor=void 0;var l=L(5),S=L(1);const y=class{constructor(d){et(this,N,this.focusin.bind(this));et(this,J,this.focusout.bind(this));et(this,R,!1);et(this,C,!1);et(this,_,!1);Dt(this,"_uiManager",null);et(this,w,y._zIndex++);this.constructor===y&&(0,S.unreachable)("Cannot initialize AnnotationEditor."),this.parent=d.parent,this.id=d.id,this.width=this.height=null,this.pageIndex=d.parent.pageIndex,this.name=d.name,this.div=null,this._uiManager=d.uiManager;const{rotation:g,rawDims:{pageWidth:s,pageHeight:r,pageX:k,pageY:M}}=this.parent.viewport;this.rotation=g,this.pageDimensions=[s,r],this.pageTranslation=[k,M];const[v,t]=this.parentDimensions;this.x=d.x/v,this.y=d.y/t,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,S.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}addCommands(d){this._uiManager.addCommands(d)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=m(this,w)}setParent(d){d!==null&&(this.pageIndex=d.pageIndex,this.pageDimensions=d.pageDimensions),this.parent=d}focusin(d){m(this,R)?pt(this,R,!1):this.parent.setSelected(this)}focusout(d){var s;if(!this.isAttachedToDOM)return;const g=d.relatedTarget;g!=null&&g.closest(`#${this.id}`)||(d.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(d){const g=this.parent.div.getBoundingClientRect();this.startX=d.clientX-g.x,this.startY=d.clientY-g.y,d.dataTransfer.setData("text/plain",this.id),d.dataTransfer.effectAllowed="move"}setAt(d,g,s,r){const[k,M]=this.parentDimensions;[s,r]=this.screenToPageTranslation(s,r),this.x=(d+s)/k,this.y=(g+r)/M,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(d,g){const[s,r]=this.parentDimensions;[d,g]=this.screenToPageTranslation(d,g),this.x+=d/s,this.y+=g/r,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(d,g){switch(this.parentRotation){case 90:return[g,-d];case 180:return[-d,-g];case 270:return[-g,d];default:return[d,g]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return this._uiManager.viewParameters.rotation}get parentDimensions(){const{realScale:d}=this._uiManager.viewParameters,[g,s]=this.pageDimensions;return[g*d,s*d]}setDims(d,g){const[s,r]=this.parentDimensions;this.div.style.width=`${100*d/s}%`,this.div.style.height=`${100*g/r}%`}fixDims(){const{style:d}=this.div,{height:g,width:s}=d,r=s.endsWith("%"),k=g.endsWith("%");if(r&&k)return;const[M,v]=this.parentDimensions;r||(d.width=`${100*parseFloat(s)/M}%`),k||(d.height=`${100*parseFloat(g)/v}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",m(this,N)),this.div.addEventListener("focusout",m(this,J));const[d,g]=this.getInitialTranslation();return this.translate(d,g),(0,l.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(d){const{isMac:g}=S.FeatureTest.platform;if(d.button!==0||d.ctrlKey&&g){d.preventDefault();return}d.ctrlKey&&!g||d.shiftKey||d.metaKey&&g?this.parent.toggleSelected(this):this.parent.setSelected(this),pt(this,R,!0)}getRect(d,g){const s=this.parentScale,[r,k]=this.pageDimensions,[M,v]=this.pageTranslation,t=d/s,c=g/s,o=this.x*r,n=this.y*k,u=this.width*r,T=this.height*k;switch(this.rotation){case 0:return[o+t+M,k-n-c-T+v,o+t+u+M,k-n-c+v];case 90:return[o+c+M,k-n+t+v,o+c+T+M,k-n+t+u+v];case 180:return[o-t-u+M,k-n+c+v,o-t+M,k-n+c+T+v];case 270:return[o-c-T+M,k-n-t-u+v,o-c+M,k-n-t+v];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(d,g){const[s,r,k,M]=d,v=k-s,t=M-r;switch(this.rotation){case 0:return[s,g-M,v,t];case 90:return[s,g-r,t,v];case 180:return[k,g-r,v,t];case 270:return[k,g-M,t,v];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){pt(this,_,!0)}disableEditMode(){pt(this,_,!1)}isInEditMode(){return m(this,_)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var d;(d=this.div)==null||d.addEventListener("focusin",m(this,N))}serialize(){(0,S.unreachable)("An editor must be serializable")}static deserialize(d,g,s){const r=new this.prototype.constructor({parent:g,id:g.getNextId(),uiManager:s});r.rotation=d.rotation;const[k,M]=r.pageDimensions,[v,t,c,o]=r.getRectInCurrentCoords(d.rect,M);return r.x=v/k,r.y=t/M,r.width=c/k,r.height=o/M,r}remove(){this.div.removeEventListener("focusin",m(this,N)),this.div.removeEventListener("focusout",m(this,J)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var d;(d=this.div)==null||d.classList.add("selectedEditor")}unselect(){var d;(d=this.div)==null||d.classList.remove("selectedEditor")}updateParams(d,g){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return m(this,C)}set isEditing(d){pt(this,C,d),d?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};let W=y;N=new WeakMap,J=new WeakMap,R=new WeakMap,C=new WeakMap,_=new WeakMap,w=new WeakMap,Dt(W,"_colorManager",new l.ColorManager),Dt(W,"_zIndex",1),i.AnnotationEditor=W},(K,i,L)=>{var y,A,d,g,s,r,De,v,t,c,o,n,u,T,a,D,$,Y,tt,it,ut,lt,ft,bt,yt,G,f,p,E,U,O,Oe,V,fe,z,Ie,F,Le,h,Wt,x,Jt,B,Ne,st,je,at,pe,ct,Qt,gt,ge;Object.defineProperty(i,"__esModule",{value:!0}),i.KeyboardManager=i.CommandManager=i.ColorManager=i.AnnotationEditorUIManager=void 0,i.bindEvents=W,i.opacityToHex=N;var l=L(1),S=L(6);function W(xt,P,H){for(const q of H)P.addEventListener(q,xt[q].bind(xt))}function N(xt){return Math.round(Math.min(255,Math.max(1,255*xt))).toString(16).padStart(2,"0")}class J{constructor(){et(this,y,0)}getId(){return`${l.AnnotationEditorPrefix}${ie(this,y)._++}`}}y=new WeakMap;class R{constructor(P=128){et(this,A,[]);et(this,d,!1);et(this,g,void 0);et(this,s,-1);pt(this,g,P)}add({cmd:P,undo:H,mustExec:q,type:_t=NaN,overwriteIfSameType:Ct=!1,keepUndo:Z=!1}){if(q&&P(),m(this,d))return;const ht={cmd:P,undo:H,type:_t};if(m(this,s)===-1){m(this,A).length>0&&(m(this,A).length=0),pt(this,s,0),m(this,A).push(ht);return}if(Ct&&m(this,A)[m(this,s)].type===_t){Z&&(ht.undo=m(this,A)[m(this,s)].undo),m(this,A)[m(this,s)]=ht;return}const vt=m(this,s)+1;vt===m(this,g)?m(this,A).splice(0,1):(pt(this,s,vt),vt<m(this,A).length&&m(this,A).splice(vt)),m(this,A).push(ht)}undo(){m(this,s)!==-1&&(pt(this,d,!0),m(this,A)[m(this,s)].undo(),pt(this,d,!1),pt(this,s,m(this,s)-1))}redo(){m(this,s)<m(this,A).length-1&&(pt(this,s,m(this,s)+1),pt(this,d,!0),m(this,A)[m(this,s)].cmd(),pt(this,d,!1))}hasSomethingToUndo(){return m(this,s)!==-1}hasSomethingToRedo(){return m(this,s)<m(this,A).length-1}destroy(){pt(this,A,null)}}A=new WeakMap,d=new WeakMap,g=new WeakMap,s=new WeakMap,i.CommandManager=R;class C{constructor(P){et(this,r);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:H}=l.FeatureTest.platform;for(const[q,_t]of P)for(const Ct of q){const Z=Ct.startsWith("mac+");H&&Z?(this.callbacks.set(Ct.slice(4),_t),this.allKeys.add(Ct.split("+").at(-1))):!H&&!Z&&(this.callbacks.set(Ct,_t),this.allKeys.add(Ct.split("+").at(-1)))}}exec(P,H){if(!this.allKeys.has(H.key))return;const q=this.callbacks.get(ot(this,r,De).call(this,H));q&&(q.bind(P)(),H.stopPropagation(),H.preventDefault())}}r=new WeakSet,De=function(P){P.altKey&&this.buffer.push("alt"),P.ctrlKey&&this.buffer.push("ctrl"),P.metaKey&&this.buffer.push("meta"),P.shiftKey&&this.buffer.push("shift"),this.buffer.push(P.key);const H=this.buffer.join("+");return this.buffer.length=0,H},i.KeyboardManager=C;const M=class{get _colors(){const P=new Map([["CanvasText",null],["Canvas",null]]);return(0,S.getColorValues)(P),(0,l.shadow)(this,"_colors",P)}convert(P){const H=(0,S.getRGB)(P);if(!window.matchMedia("(forced-colors: active)").matches)return H;for(const[q,_t]of this._colors)if(_t.every((Ct,Z)=>Ct===H[Z]))return M._colorsMapping.get(q);return H}getHexCode(P){const H=this._colors.get(P);return H?l.Util.makeHexColor(...H):P}};let _=M;Dt(_,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),i.ColorManager=_;const At=class{constructor(P,H,q){et(this,O);et(this,V);et(this,z);et(this,F);et(this,h);et(this,x);et(this,B);et(this,st);et(this,at);et(this,ct);et(this,gt);et(this,v,null);et(this,t,new Map);et(this,c,new Map);et(this,o,null);et(this,n,new R);et(this,u,0);et(this,T,null);et(this,a,new Set);et(this,D,null);et(this,$,new J);et(this,Y,!1);et(this,tt,l.AnnotationEditorType.NONE);et(this,it,new Set);et(this,ut,this.copy.bind(this));et(this,lt,this.cut.bind(this));et(this,ft,this.paste.bind(this));et(this,bt,this.keydown.bind(this));et(this,yt,this.onEditingAction.bind(this));et(this,G,this.onPageChanging.bind(this));et(this,f,this.onScaleChanging.bind(this));et(this,p,this.onRotationChanging.bind(this));et(this,E,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});et(this,U,null);pt(this,U,P),pt(this,D,H),m(this,D)._on("editingaction",m(this,yt)),m(this,D)._on("pagechanging",m(this,G)),m(this,D)._on("scalechanging",m(this,f)),m(this,D)._on("rotationchanging",m(this,p)),pt(this,o,q),this.viewParameters={realScale:S.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){ot(this,V,fe).call(this),m(this,D)._off("editingaction",m(this,yt)),m(this,D)._off("pagechanging",m(this,G)),m(this,D)._off("scalechanging",m(this,f)),m(this,D)._off("rotationchanging",m(this,p));for(const P of m(this,c).values())P.destroy();m(this,c).clear(),m(this,t).clear(),m(this,a).clear(),pt(this,v,null),m(this,it).clear(),m(this,n).destroy()}onPageChanging({pageNumber:P}){pt(this,u,P-1)}focusMainContainer(){m(this,U).focus()}addShouldRescale(P){m(this,a).add(P)}removeShouldRescale(P){m(this,a).delete(P)}onScaleChanging({scale:P}){this.commitOrRemove(),this.viewParameters.realScale=P*S.PixelsPerInch.PDF_TO_CSS_UNITS;for(const H of m(this,a))H.onScaleChanging()}onRotationChanging({pagesRotation:P}){this.commitOrRemove(),this.viewParameters.rotation=P}addToAnnotationStorage(P){!P.isEmpty()&&m(this,o)&&!m(this,o).has(P.id)&&m(this,o).setValue(P.id,P)}copy(P){if(P.preventDefault(),m(this,v)&&m(this,v).commitOrRemove(),!this.hasSelection)return;const H=[];for(const q of m(this,it))q.isEmpty()||H.push(q.serialize());H.length!==0&&P.clipboardData.setData("application/pdfjs",JSON.stringify(H))}cut(P){this.copy(P),this.delete()}paste(P){P.preventDefault();let H=P.clipboardData.getData("application/pdfjs");if(!H)return;try{H=JSON.parse(H)}catch(_t){(0,l.warn)(`paste: "${_t.message}".`);return}if(!Array.isArray(H))return;this.unselectAll();const q=m(this,c).get(m(this,u));try{const _t=[];for(const ht of H){const vt=q.deserialize(ht);if(!vt)return;_t.push(vt)}const Ct=()=>{for(const ht of _t)ot(this,at,pe).call(this,ht);ot(this,gt,ge).call(this,_t)},Z=()=>{for(const ht of _t)ht.remove()};this.addCommands({cmd:Ct,undo:Z,mustExec:!0})}catch(_t){(0,l.warn)(`paste: "${_t.message}".`)}}keydown(P){var H;(H=this.getActive())!=null&&H.shouldGetKeyboardEvents()||At._keyboardManager.exec(this,P)}onEditingAction(P){["undo","redo","delete","selectAll"].includes(P.name)&&this[P.name]()}setEditingState(P){P?(ot(this,O,Oe).call(this),ot(this,z,Ie).call(this),ot(this,h,Wt).call(this,{isEditing:m(this,tt)!==l.AnnotationEditorType.NONE,isEmpty:ot(this,ct,Qt).call(this),hasSomethingToUndo:m(this,n).hasSomethingToUndo(),hasSomethingToRedo:m(this,n).hasSomethingToRedo(),hasSelectedEditor:!1})):(ot(this,V,fe).call(this),ot(this,F,Le).call(this),ot(this,h,Wt).call(this,{isEditing:!1}))}registerEditorTypes(P){if(!m(this,T)){pt(this,T,P);for(const H of m(this,T))ot(this,x,Jt).call(this,H.defaultPropertiesToUpdate)}}getId(){return m(this,$).getId()}get currentLayer(){return m(this,c).get(m(this,u))}get currentPageIndex(){return m(this,u)}addLayer(P){m(this,c).set(P.pageIndex,P),m(this,Y)?P.enable():P.disable()}removeLayer(P){m(this,c).delete(P.pageIndex)}updateMode(P){if(pt(this,tt,P),P===l.AnnotationEditorType.NONE)this.setEditingState(!1),ot(this,st,je).call(this);else{this.setEditingState(!0),ot(this,B,Ne).call(this);for(const H of m(this,c).values())H.updateMode(P)}}updateToolbar(P){P!==m(this,tt)&&m(this,D).dispatch("switchannotationeditormode",{source:this,mode:P})}updateParams(P,H){if(m(this,T)){for(const q of m(this,it))q.updateParams(P,H);for(const q of m(this,T))q.updateDefaultParams(P,H)}}getEditors(P){const H=[];for(const q of m(this,t).values())q.pageIndex===P&&H.push(q);return H}getEditor(P){return m(this,t).get(P)}addEditor(P){m(this,t).set(P.id,P)}removeEditor(P){var H;m(this,t).delete(P.id),this.unselect(P),(H=m(this,o))==null||H.remove(P.id)}setActiveEditor(P){m(this,v)!==P&&(pt(this,v,P),P&&ot(this,x,Jt).call(this,P.propertiesToUpdate))}toggleSelected(P){if(m(this,it).has(P)){m(this,it).delete(P),P.unselect(),ot(this,h,Wt).call(this,{hasSelectedEditor:this.hasSelection});return}m(this,it).add(P),P.select(),ot(this,x,Jt).call(this,P.propertiesToUpdate),ot(this,h,Wt).call(this,{hasSelectedEditor:!0})}setSelected(P){for(const H of m(this,it))H!==P&&H.unselect();m(this,it).clear(),m(this,it).add(P),P.select(),ot(this,x,Jt).call(this,P.propertiesToUpdate),ot(this,h,Wt).call(this,{hasSelectedEditor:!0})}isSelected(P){return m(this,it).has(P)}unselect(P){P.unselect(),m(this,it).delete(P),ot(this,h,Wt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return m(this,it).size!==0}undo(){m(this,n).undo(),ot(this,h,Wt).call(this,{hasSomethingToUndo:m(this,n).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:ot(this,ct,Qt).call(this)})}redo(){m(this,n).redo(),ot(this,h,Wt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:m(this,n).hasSomethingToRedo(),isEmpty:ot(this,ct,Qt).call(this)})}addCommands(P){m(this,n).add(P),ot(this,h,Wt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:ot(this,ct,Qt).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const P=[...m(this,it)],H=()=>{for(const _t of P)_t.remove()},q=()=>{for(const _t of P)ot(this,at,pe).call(this,_t)};this.addCommands({cmd:H,undo:q,mustExec:!0})}commitOrRemove(){var P;(P=m(this,v))==null||P.commitOrRemove()}selectAll(){for(const P of m(this,it))P.commit();ot(this,gt,ge).call(this,m(this,t).values())}unselectAll(){if(m(this,v)){m(this,v).commitOrRemove();return}if(m(this,it).size!==0){for(const P of m(this,it))P.unselect();m(this,it).clear(),ot(this,h,Wt).call(this,{hasSelectedEditor:!1})}}isActive(P){return m(this,v)===P}getActive(){return m(this,v)}getMode(){return m(this,tt)}};let w=At;v=new WeakMap,t=new WeakMap,c=new WeakMap,o=new WeakMap,n=new WeakMap,u=new WeakMap,T=new WeakMap,a=new WeakMap,D=new WeakMap,$=new WeakMap,Y=new WeakMap,tt=new WeakMap,it=new WeakMap,ut=new WeakMap,lt=new WeakMap,ft=new WeakMap,bt=new WeakMap,yt=new WeakMap,G=new WeakMap,f=new WeakMap,p=new WeakMap,E=new WeakMap,U=new WeakMap,O=new WeakSet,Oe=function(){m(this,U).addEventListener("keydown",m(this,bt))},V=new WeakSet,fe=function(){m(this,U).removeEventListener("keydown",m(this,bt))},z=new WeakSet,Ie=function(){document.addEventListener("copy",m(this,ut)),document.addEventListener("cut",m(this,lt)),document.addEventListener("paste",m(this,ft))},F=new WeakSet,Le=function(){document.removeEventListener("copy",m(this,ut)),document.removeEventListener("cut",m(this,lt)),document.removeEventListener("paste",m(this,ft))},h=new WeakSet,Wt=function(P){Object.entries(P).some(([q,_t])=>m(this,E)[q]!==_t)&&m(this,D).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(m(this,E),P)})},x=new WeakSet,Jt=function(P){m(this,D).dispatch("annotationeditorparamschanged",{source:this,details:P})},B=new WeakSet,Ne=function(){if(!m(this,Y)){pt(this,Y,!0);for(const P of m(this,c).values())P.enable()}},st=new WeakSet,je=function(){if(this.unselectAll(),m(this,Y)){pt(this,Y,!1);for(const P of m(this,c).values())P.disable()}},at=new WeakSet,pe=function(P){const H=m(this,c).get(P.pageIndex);H?H.addOrRebuild(P):this.addEditor(P)},ct=new WeakSet,Qt=function(){if(m(this,t).size===0)return!0;if(m(this,t).size===1)for(const P of m(this,t).values())return P.isEmpty();return!1},gt=new WeakSet,ge=function(P){m(this,it).clear();for(const H of P)H.isEmpty()||(m(this,it).add(H),H.select());ot(this,h,Wt).call(this,{hasSelectedEditor:!0})},Dt(w,"_keyboardManager",new C([[["ctrl+a","mac+meta+a"],At.prototype.selectAll],[["ctrl+z","mac+meta+z"],At.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],At.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],At.prototype.delete],[["Escape","mac+Escape"],At.prototype.unselectAll]])),i.AnnotationEditorUIManager=w},(K,i,L)=>{var ut,lt,ft,bt,yt,G,f,p,E,zt,O,Vt,V,qt;Object.defineProperty(i,"__esModule",{value:!0}),i.StatTimer=i.RenderingCancelledException=i.PixelsPerInch=i.PageViewport=i.PDFDateString=i.DOMStandardFontDataFactory=i.DOMSVGFactory=i.DOMFilterFactory=i.DOMCanvasFactory=i.DOMCMapReaderFactory=i.AnnotationPrefix=void 0,i.deprecated=o,i.getColorValues=D,i.getCurrentTransform=$,i.getCurrentTransformInverse=Y,i.getFilenameFromUrl=k,i.getPdfFilenameFromUrl=M,i.getRGB=a,i.getXfaPageViewport=T,i.isDataScheme=s,i.isPdfFile=r,i.isValidFetchUrl=t,i.loadScript=c,i.setLayerDimensions=tt;var l=L(7),S=L(1);const W="http://www.w3.org/2000/svg",N="pdfjs_internal_id_";i.AnnotationPrefix=N;const it=class{};let J=it;Dt(J,"CSS",96),Dt(J,"PDF",72),Dt(J,"PDF_TO_CSS_UNITS",it.CSS/it.PDF),i.PixelsPerInch=J;class R extends l.BaseFilterFactory{constructor({docId:F,ownerDocument:e=globalThis.document}={}){super();et(this,E);et(this,O);et(this,V);et(this,ut,void 0);et(this,lt,void 0);et(this,ft,void 0);et(this,bt,void 0);et(this,yt,void 0);et(this,G,void 0);et(this,f,void 0);et(this,p,0);pt(this,ft,F),pt(this,bt,e)}addFilter(F){if(!F)return"none";let e=m(this,E,zt).get(F);if(e)return e;let h,b,x,I;if(F.length===1){const at=F[0],dt=new Array(256);for(let ct=0;ct<256;ct++)dt[ct]=at[ct]/255;I=h=b=x=dt.join(",")}else{const[at,dt,ct]=F,mt=new Array(256),gt=new Array(256),Et=new Array(256);for(let At=0;At<256;At++)mt[At]=at[At]/255,gt[At]=dt[At]/255,Et[At]=ct[At]/255;h=mt.join(","),b=gt.join(","),x=Et.join(","),I=`${h}${b}${x}`}if(e=m(this,E,zt).get(I),e)return m(this,E,zt).set(F,e),e;const B=`g_${m(this,ft)}_transfer_map_${ie(this,p)._++}`,nt=`url(#${B})`;m(this,E,zt).set(F,nt),m(this,E,zt).set(I,nt);const st=m(this,bt).createElementNS(W,"filter",W);st.setAttribute("id",B),st.setAttribute("color-interpolation-filters","sRGB");const rt=m(this,bt).createElementNS(W,"feComponentTransfer");return st.append(rt),ot(this,V,qt).call(this,rt,"feFuncR",h),ot(this,V,qt).call(this,rt,"feFuncG",b),ot(this,V,qt).call(this,rt,"feFuncB",x),m(this,O,Vt).append(st),nt}addHCMFilter(F,e){var ct;const h=`${F}-${e}`;if(m(this,G)===h)return m(this,f);if(pt(this,G,h),pt(this,f,"none"),(ct=m(this,yt))==null||ct.remove(),!F||!e)return m(this,f);m(this,O,Vt).style.color=F,F=getComputedStyle(m(this,O,Vt)).getPropertyValue("color");const b=a(F);F=S.Util.makeHexColor(...b),m(this,O,Vt).style.color=e,e=getComputedStyle(m(this,O,Vt)).getPropertyValue("color");const x=a(e);if(e=S.Util.makeHexColor(...x),m(this,O,Vt).style.color="",F==="#000000"&&e==="#ffffff"||F===e)return m(this,f);const I=new Array(256);for(let mt=0;mt<=255;mt++){const gt=mt/255;I[mt]=gt<=.03928?gt/12.92:((gt+.055)/1.055)**2.4}const B=I.join(","),nt=`g_${m(this,ft)}_hcm_filter`,st=pt(this,yt,m(this,bt).createElementNS(W,"filter",W));st.setAttribute("id",nt),st.setAttribute("color-interpolation-filters","sRGB");let rt=m(this,bt).createElementNS(W,"feComponentTransfer");st.append(rt),ot(this,V,qt).call(this,rt,"feFuncR",B),ot(this,V,qt).call(this,rt,"feFuncG",B),ot(this,V,qt).call(this,rt,"feFuncB",B);const at=m(this,bt).createElementNS(W,"feColorMatrix");at.setAttribute("type","matrix"),at.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),st.append(at),rt=m(this,bt).createElementNS(W,"feComponentTransfer"),st.append(rt);const dt=(mt,gt)=>{const Et=b[mt]/255,At=x[mt]/255,xt=new Array(gt+1);for(let P=0;P<=gt;P++)xt[P]=Et+P/gt*(At-Et);return xt.join(",")};return ot(this,V,qt).call(this,rt,"feFuncR",dt(0,5)),ot(this,V,qt).call(this,rt,"feFuncG",dt(1,5)),ot(this,V,qt).call(this,rt,"feFuncB",dt(2,5)),m(this,O,Vt).append(st),pt(this,f,`url(#${nt})`),m(this,f)}destroy(F=!1){F&&m(this,f)||(m(this,lt)&&(m(this,lt).parentNode.parentNode.remove(),pt(this,lt,null)),m(this,ut)&&(m(this,ut).clear(),pt(this,ut,null)),pt(this,p,0))}}ut=new WeakMap,lt=new WeakMap,ft=new WeakMap,bt=new WeakMap,yt=new WeakMap,G=new WeakMap,f=new WeakMap,p=new WeakMap,E=new WeakSet,zt=function(){return m(this,ut)||pt(this,ut,new Map)},O=new WeakSet,Vt=function(){if(!m(this,lt)){const F=m(this,bt).createElement("div"),{style:e}=F;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const h=m(this,bt).createElementNS(W,"svg");h.setAttribute("width",0),h.setAttribute("height",0),pt(this,lt,m(this,bt).createElementNS(W,"defs")),F.append(h),h.append(m(this,lt)),m(this,bt).body.append(F)}return m(this,lt)},V=new WeakSet,qt=function(F,e,h){const b=m(this,bt).createElementNS(W,e);b.setAttribute("type","discrete"),b.setAttribute("tableValues",h),F.append(b)},i.DOMFilterFactory=R;class C extends l.BaseCanvasFactory{constructor({ownerDocument:j=globalThis.document}={}){super(),this._document=j}_createCanvas(j,F){const e=this._document.createElement("canvas");return e.width=j,e.height=F,e}}i.DOMCanvasFactory=C;async function _(z,j=!1){if(t(z,document.baseURI)){const F=await fetch(z);if(!F.ok)throw new Error(F.statusText);return j?new Uint8Array(await F.arrayBuffer()):(0,S.stringToBytes)(await F.text())}return new Promise((F,e)=>{const h=new XMLHttpRequest;h.open("GET",z,!0),j&&(h.responseType="arraybuffer"),h.onreadystatechange=()=>{if(h.readyState===XMLHttpRequest.DONE){if(h.status===200||h.status===0){let b;if(j&&h.response?b=new Uint8Array(h.response):!j&&h.responseText&&(b=(0,S.stringToBytes)(h.responseText)),b){F(b);return}}e(new Error(h.statusText))}},h.send(null)})}class w extends l.BaseCMapReaderFactory{_fetchData(j,F){return _(j,this.isCompressed).then(e=>({cMapData:e,compressionType:F}))}}i.DOMCMapReaderFactory=w;class y extends l.BaseStandardFontDataFactory{_fetchData(j){return _(j,!0)}}i.DOMStandardFontDataFactory=y;class A extends l.BaseSVGFactory{_createSVG(j){return document.createElementNS(W,j)}}i.DOMSVGFactory=A;class d{constructor({viewBox:j,scale:F,rotation:e,offsetX:h=0,offsetY:b=0,dontFlip:x=!1}){this.viewBox=j,this.scale=F,this.rotation=e,this.offsetX=h,this.offsetY=b;const I=(j[2]+j[0])/2,B=(j[3]+j[1])/2;let nt,st,rt,at;switch(e%=360,e<0&&(e+=360),e){case 180:nt=-1,st=0,rt=0,at=1;break;case 90:nt=0,st=1,rt=1,at=0;break;case 270:nt=0,st=-1,rt=-1,at=0;break;case 0:nt=1,st=0,rt=0,at=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}x&&(rt=-rt,at=-at);let dt,ct,mt,gt;nt===0?(dt=Math.abs(B-j[1])*F+h,ct=Math.abs(I-j[0])*F+b,mt=(j[3]-j[1])*F,gt=(j[2]-j[0])*F):(dt=Math.abs(I-j[0])*F+h,ct=Math.abs(B-j[1])*F+b,mt=(j[2]-j[0])*F,gt=(j[3]-j[1])*F),this.transform=[nt*F,st*F,rt*F,at*F,dt-nt*F*I-rt*F*B,ct-st*F*I-at*F*B],this.width=mt,this.height=gt}get rawDims(){const{viewBox:j}=this;return(0,S.shadow)(this,"rawDims",{pageWidth:j[2]-j[0],pageHeight:j[3]-j[1],pageX:j[0],pageY:j[1]})}clone({scale:j=this.scale,rotation:F=this.rotation,offsetX:e=this.offsetX,offsetY:h=this.offsetY,dontFlip:b=!1}={}){return new d({viewBox:this.viewBox.slice(),scale:j,rotation:F,offsetX:e,offsetY:h,dontFlip:b})}convertToViewportPoint(j,F){return S.Util.applyTransform([j,F],this.transform)}convertToViewportRectangle(j){const F=S.Util.applyTransform([j[0],j[1]],this.transform),e=S.Util.applyTransform([j[2],j[3]],this.transform);return[F[0],F[1],e[0],e[1]]}convertToPdfPoint(j,F){return S.Util.applyInverseTransform([j,F],this.transform)}}i.PageViewport=d;class g extends S.BaseException{constructor(j,F,e=0){super(j,"RenderingCancelledException"),this.type=F,this.extraDelay=e}}i.RenderingCancelledException=g;function s(z){const j=z.length;let F=0;for(;F<j&&z[F].trim()==="";)F++;return z.substring(F,F+5).toLowerCase()==="data:"}function r(z){return typeof z=="string"&&/\.pdf$/i.test(z)}function k(z,j=!1){return j||([z]=z.split(/[#?]/,1)),z.substring(z.lastIndexOf("/")+1)}function M(z,j="document.pdf"){if(typeof z!="string")return j;if(s(z))return(0,S.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),j;const F=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,e=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,h=F.exec(z);let b=e.exec(h[1])||e.exec(h[2])||e.exec(h[3]);if(b&&(b=b[0],b.includes("%")))try{b=e.exec(decodeURIComponent(b))[0]}catch{}return b||j}class v{constructor(){Dt(this,"started",Object.create(null));Dt(this,"times",[])}time(j){j in this.started&&(0,S.warn)(`Timer is already running for ${j}`),this.started[j]=Date.now()}timeEnd(j){j in this.started||(0,S.warn)(`Timer has not been started for ${j}`),this.times.push({name:j,start:this.started[j],end:Date.now()}),delete this.started[j]}toString(){const j=[];let F=0;for(const{name:e}of this.times)F=Math.max(e.length,F);for(const{name:e,start:h,end:b}of this.times)j.push(`${e.padEnd(F)} ${b-h}ms
`);return j.join("")}}i.StatTimer=v;function t(z,j){try{const{protocol:F}=j?new URL(z,j):new URL(z);return F==="http:"||F==="https:"}catch{return!1}}function c(z,j=!1){return new Promise((F,e)=>{const h=document.createElement("script");h.src=z,h.onload=function(b){j&&h.remove(),F(b)},h.onerror=function(){e(new Error(`Cannot load script at: ${h.src}`))},(document.head||document.documentElement).append(h)})}function o(z){console.log("Deprecated API usage: "+z)}let n;class u{static toDateObject(j){if(!j||typeof j!="string")return null;n||(n=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const F=n.exec(j);if(!F)return null;const e=parseInt(F[1],10);let h=parseInt(F[2],10);h=h>=1&&h<=12?h-1:0;let b=parseInt(F[3],10);b=b>=1&&b<=31?b:1;let x=parseInt(F[4],10);x=x>=0&&x<=23?x:0;let I=parseInt(F[5],10);I=I>=0&&I<=59?I:0;let B=parseInt(F[6],10);B=B>=0&&B<=59?B:0;const nt=F[7]||"Z";let st=parseInt(F[8],10);st=st>=0&&st<=23?st:0;let rt=parseInt(F[9],10)||0;return rt=rt>=0&&rt<=59?rt:0,nt==="-"?(x+=st,I+=rt):nt==="+"&&(x-=st,I-=rt),new Date(Date.UTC(e,h,b,x,I,B))}}i.PDFDateString=u;function T(z,{scale:j=1,rotation:F=0}){const{width:e,height:h}=z.attributes.style,b=[0,0,parseInt(e),parseInt(h)];return new d({viewBox:b,scale:j,rotation:F})}function a(z){if(z.startsWith("#")){const j=parseInt(z.slice(1),16);return[(j&16711680)>>16,(j&65280)>>8,j&255]}return z.startsWith("rgb(")?z.slice(4,-1).split(",").map(j=>parseInt(j)):z.startsWith("rgba(")?z.slice(5,-1).split(",").map(j=>parseInt(j)).slice(0,3):((0,S.warn)(`Not a valid color format: "${z}"`),[0,0,0])}function D(z){const j=document.createElement("span");j.style.visibility="hidden",document.body.append(j);for(const F of z.keys()){j.style.color=F;const e=window.getComputedStyle(j).color;z.set(F,a(e))}j.remove()}function $(z){const{a:j,b:F,c:e,d:h,e:b,f:x}=z.getTransform();return[j,F,e,h,b,x]}function Y(z){const{a:j,b:F,c:e,d:h,e:b,f:x}=z.getTransform().invertSelf();return[j,F,e,h,b,x]}function tt(z,j,F=!1,e=!0){if(j instanceof d){const{pageWidth:h,pageHeight:b}=j.rawDims,{style:x}=z,I=`calc(var(--scale-factor) * ${h}px)`,B=`calc(var(--scale-factor) * ${b}px)`;!F||j.rotation%180===0?(x.width=I,x.height=B):(x.width=B,x.height=I)}e&&z.setAttribute("data-main-rotation",j.rotation)}},(K,i,L)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BaseStandardFontDataFactory=i.BaseSVGFactory=i.BaseFilterFactory=i.BaseCanvasFactory=i.BaseCMapReaderFactory=void 0;var l=L(1);class S{constructor(){this.constructor===S&&(0,l.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(_){return"none"}addHCMFilter(_,w){return"none"}destroy(_=!1){}}i.BaseFilterFactory=S;class W{constructor(){this.constructor===W&&(0,l.unreachable)("Cannot initialize BaseCanvasFactory.")}create(_,w){if(_<=0||w<=0)throw new Error("Invalid canvas size");const y=this._createCanvas(_,w);return{canvas:y,context:y.getContext("2d")}}reset(_,w,y){if(!_.canvas)throw new Error("Canvas is not specified");if(w<=0||y<=0)throw new Error("Invalid canvas size");_.canvas.width=w,_.canvas.height=y}destroy(_){if(!_.canvas)throw new Error("Canvas is not specified");_.canvas.width=0,_.canvas.height=0,_.canvas=null,_.context=null}_createCanvas(_,w){(0,l.unreachable)("Abstract method `_createCanvas` called.")}}i.BaseCanvasFactory=W;class N{constructor({baseUrl:_=null,isCompressed:w=!0}){this.constructor===N&&(0,l.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=_,this.isCompressed=w}async fetch({name:_}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!_)throw new Error("CMap name must be specified.");const w=this.baseUrl+_+(this.isCompressed?".bcmap":""),y=this.isCompressed?l.CMapCompressionType.BINARY:l.CMapCompressionType.NONE;return this._fetchData(w,y).catch(A=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${w}`)})}_fetchData(_,w){(0,l.unreachable)("Abstract method `_fetchData` called.")}}i.BaseCMapReaderFactory=N;class J{constructor({baseUrl:_=null}){this.constructor===J&&(0,l.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=_}async fetch({filename:_}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!_)throw new Error("Font filename must be specified.");const w=`${this.baseUrl}${_}`;return this._fetchData(w).catch(y=>{throw new Error(`Unable to load font data at: ${w}`)})}_fetchData(_){(0,l.unreachable)("Abstract method `_fetchData` called.")}}i.BaseStandardFontDataFactory=J;class R{constructor(){this.constructor===R&&(0,l.unreachable)("Cannot initialize BaseSVGFactory.")}create(_,w,y=!1){if(_<=0||w<=0)throw new Error("Invalid SVG dimensions");const A=this._createSVG("svg:svg");return A.setAttribute("version","1.1"),y||(A.setAttribute("width",`${_}px`),A.setAttribute("height",`${w}px`)),A.setAttribute("preserveAspectRatio","none"),A.setAttribute("viewBox",`0 0 ${_} ${w}`),A}createElement(_){if(typeof _!="string")throw new Error("Invalid SVG element type");return this._createSVG(_)}_createSVG(_){(0,l.unreachable)("Abstract method `_createSVG` called.")}}i.BaseSVGFactory=R},(K,i,L)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.MurmurHash3_64=void 0;var l=L(1);const S=3285377520,W=4294901760,N=65535;class J{constructor(C){this.h1=C?C&4294967295:S,this.h2=C?C&4294967295:S}update(C){let _,w;if(typeof C=="string"){_=new Uint8Array(C.length*2),w=0;for(let o=0,n=C.length;o<n;o++){const u=C.charCodeAt(o);u<=255?_[w++]=u:(_[w++]=u>>>8,_[w++]=u&255)}}else if((0,l.isArrayBuffer)(C))_=C.slice(),w=_.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const y=w>>2,A=w-y*4,d=new Uint32Array(_.buffer,0,y);let g=0,s=0,r=this.h1,k=this.h2;const M=3432918353,v=461845907,t=M&N,c=v&N;for(let o=0;o<y;o++)o&1?(g=d[o],g=g*M&W|g*t&N,g=g<<15|g>>>17,g=g*v&W|g*c&N,r^=g,r=r<<13|r>>>19,r=r*5+3864292196):(s=d[o],s=s*M&W|s*t&N,s=s<<15|s>>>17,s=s*v&W|s*c&N,k^=s,k=k<<13|k>>>19,k=k*5+3864292196);switch(g=0,A){case 3:g^=_[y*4+2]<<16;case 2:g^=_[y*4+1]<<8;case 1:g^=_[y*4],g=g*M&W|g*t&N,g=g<<15|g>>>17,g=g*v&W|g*c&N,y&1?r^=g:k^=g}this.h1=r,this.h2=k}hexdigest(){let C=this.h1,_=this.h2;return C^=_>>>1,C=C*3981806797&W|C*36045&N,_=_*4283543511&W|((_<<16|C>>>16)*2950163797&W)>>>16,C^=_>>>1,C=C*444984403&W|C*60499&N,_=_*3301882366&W|((_<<16|C>>>16)*3120437893&W)>>>16,C^=_>>>1,(C>>>0).toString(16).padStart(8,"0")+(_>>>0).toString(16).padStart(8,"0")}}i.MurmurHash3_64=J},(K,i,L)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.FontLoader=i.FontFaceObject=void 0;var l=L(1),S=L(10);class W{constructor({ownerDocument:R=globalThis.document,styleElement:C=null}){this._document=R,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(R){this.nativeFontFaces.push(R),this._document.fonts.add(R)}insertRule(R){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const C=this.styleElement.sheet;C.insertRule(R,C.cssRules.length)}clear(){for(const R of this.nativeFontFaces)this._document.fonts.delete(R);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(R){if(R.attached||R.missingFile)return;if(R.attached=!0,this.isFontLoadingAPISupported){const _=R.createNativeFontFace();if(_){this.addNativeFontFace(_);try{await _.loaded}catch(w){throw(0,l.warn)(`Failed to load font '${_.family}': '${w}'.`),R.disableFontFace=!0,w}}return}const C=R.createFontFaceRule();if(C){if(this.insertRule(C),this.isSyncFontLoadingSupported)return;await new Promise(_=>{const w=this._queueLoadingCallback(_);this._prepareFontLoadEvent(R,w)})}}get isFontLoadingAPISupported(){var C;const R=!!((C=this._document)!=null&&C.fonts);return(0,l.shadow)(this,"isFontLoadingAPISupported",R)}get isSyncFontLoadingSupported(){let R=!1;return(S.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(R=!0),(0,l.shadow)(this,"isSyncFontLoadingSupported",R)}_queueLoadingCallback(R){function C(){for((0,l.assert)(!w.done,"completeRequest() cannot be called twice."),w.done=!0;_.length>0&&_[0].done;){const y=_.shift();setTimeout(y.callback,0)}}const{loadingRequests:_}=this,w={done:!1,complete:C,callback:R};return _.push(w),w}get _loadTestFont(){const R=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,l.shadow)(this,"_loadTestFont",R)}_prepareFontLoadEvent(R,C){function _(a,D){return a.charCodeAt(D)<<24|a.charCodeAt(D+1)<<16|a.charCodeAt(D+2)<<8|a.charCodeAt(D+3)&255}function w(a,D,$,Y){const tt=a.substring(0,D),it=a.substring(D+$);return tt+Y+it}let y,A;const d=this._document.createElement("canvas");d.width=1,d.height=1;const g=d.getContext("2d");let s=0;function r(a,D){if(++s>30){(0,l.warn)("Load test font never loaded."),D();return}if(g.font="30px "+a,g.fillText(".",0,20),g.getImageData(0,0,1,1).data[3]>0){D();return}setTimeout(r.bind(null,a,D))}const k=`lt${Date.now()}${this.loadTestFontId++}`;let M=this._loadTestFont;M=w(M,976,k.length,k);const t=16,c=1482184792;let o=_(M,t);for(y=0,A=k.length-3;y<A;y+=4)o=o-c+_(k,y)|0;y<k.length&&(o=o-c+_(k+"XXX",y)|0),M=w(M,t,4,(0,l.string32)(o));const n=`url(data:font/opentype;base64,${btoa(M)});`,u=`@font-face {font-family:"${k}";src:${n}}`;this.insertRule(u);const T=this._document.createElement("div");T.style.visibility="hidden",T.style.width=T.style.height="10px",T.style.position="absolute",T.style.top=T.style.left="0px";for(const a of[R.loadedName,k]){const D=this._document.createElement("span");D.textContent="Hi",D.style.fontFamily=a,T.append(D)}this._document.body.append(T),r(k,()=>{T.remove(),C.complete()})}}i.FontLoader=W;class N{constructor(R,{isEvalSupported:C=!0,disableFontFace:_=!1,ignoreErrors:w=!1,inspectFont:y=null}){this.compiledGlyphs=Object.create(null);for(const A in R)this[A]=R[A];this.isEvalSupported=C!==!1,this.disableFontFace=_===!0,this.ignoreErrors=w===!0,this._inspectFont=y}createNativeFontFace(){var C;if(!this.data||this.disableFontFace)return null;let R;if(!this.cssFontInfo)R=new FontFace(this.loadedName,this.data,{});else{const _={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(_.style=`oblique ${this.cssFontInfo.italicAngle}deg`),R=new FontFace(this.cssFontInfo.fontFamily,this.data,_)}return(C=this._inspectFont)==null||C.call(this,this),R}createFontFaceRule(){var w;if(!this.data||this.disableFontFace)return null;const R=(0,l.bytesToString)(this.data),C=`url(data:${this.mimetype};base64,${btoa(R)});`;let _;if(!this.cssFontInfo)_=`@font-face {font-family:"${this.loadedName}";src:${C}}`;else{let y=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(y+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),_=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${y}src:${C}}`}return(w=this._inspectFont)==null||w.call(this,this,C),_}getPathGenerator(R,C){if(this.compiledGlyphs[C]!==void 0)return this.compiledGlyphs[C];let _;try{_=R.get(this.loadedName+"_path_"+C)}catch(w){if(!this.ignoreErrors)throw w;return(0,l.warn)(`getPathGenerator - ignoring character: "${w}".`),this.compiledGlyphs[C]=function(y,A){}}if(this.isEvalSupported&&l.FeatureTest.isEvalSupported){const w=[];for(const y of _){const A=y.args!==void 0?y.args.join(","):"";w.push("c.",y.cmd,"(",A,`);
`)}return this.compiledGlyphs[C]=new Function("c","size",w.join(""))}return this.compiledGlyphs[C]=function(w,y){for(const A of _)A.cmd==="scale"&&(A.args=[y,-y]),w[A.cmd].apply(w,A.args)}}}i.FontFaceObject=N},(K,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.isNodeJS=void 0;const L=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");i.isNodeJS=L},(K,i,L)=>{var ft,me;Object.defineProperty(i,"__esModule",{value:!0}),i.CanvasGraphics=void 0;var l=L(1),S=L(6),W=L(12),N=L(13),J=L(10);const R=16,C=100,_=4096,w=15,y=10,A=1e3,d=16;function g(G,f){if(G._removeMirroring)throw new Error("Context is already forwarding operations.");G.__originalSave=G.save,G.__originalRestore=G.restore,G.__originalRotate=G.rotate,G.__originalScale=G.scale,G.__originalTranslate=G.translate,G.__originalTransform=G.transform,G.__originalSetTransform=G.setTransform,G.__originalResetTransform=G.resetTransform,G.__originalClip=G.clip,G.__originalMoveTo=G.moveTo,G.__originalLineTo=G.lineTo,G.__originalBezierCurveTo=G.bezierCurveTo,G.__originalRect=G.rect,G.__originalClosePath=G.closePath,G.__originalBeginPath=G.beginPath,G._removeMirroring=()=>{G.save=G.__originalSave,G.restore=G.__originalRestore,G.rotate=G.__originalRotate,G.scale=G.__originalScale,G.translate=G.__originalTranslate,G.transform=G.__originalTransform,G.setTransform=G.__originalSetTransform,G.resetTransform=G.__originalResetTransform,G.clip=G.__originalClip,G.moveTo=G.__originalMoveTo,G.lineTo=G.__originalLineTo,G.bezierCurveTo=G.__originalBezierCurveTo,G.rect=G.__originalRect,G.closePath=G.__originalClosePath,G.beginPath=G.__originalBeginPath,delete G._removeMirroring},G.save=function(){f.save(),this.__originalSave()},G.restore=function(){f.restore(),this.__originalRestore()},G.translate=function(E,U){f.translate(E,U),this.__originalTranslate(E,U)},G.scale=function(E,U){f.scale(E,U),this.__originalScale(E,U)},G.transform=function(E,U,O,X,V,Q){f.transform(E,U,O,X,V,Q),this.__originalTransform(E,U,O,X,V,Q)},G.setTransform=function(E,U,O,X,V,Q){f.setTransform(E,U,O,X,V,Q),this.__originalSetTransform(E,U,O,X,V,Q)},G.resetTransform=function(){f.resetTransform(),this.__originalResetTransform()},G.rotate=function(E){f.rotate(E),this.__originalRotate(E)},G.clip=function(E){f.clip(E),this.__originalClip(E)},G.moveTo=function(p,E){f.moveTo(p,E),this.__originalMoveTo(p,E)},G.lineTo=function(p,E){f.lineTo(p,E),this.__originalLineTo(p,E)},G.bezierCurveTo=function(p,E,U,O,X,V){f.bezierCurveTo(p,E,U,O,X,V),this.__originalBezierCurveTo(p,E,U,O,X,V)},G.rect=function(p,E,U,O){f.rect(p,E,U,O),this.__originalRect(p,E,U,O)},G.closePath=function(){f.closePath(),this.__originalClosePath()},G.beginPath=function(){f.beginPath(),this.__originalBeginPath()}}class s{constructor(f){this.canvasFactory=f,this.cache=Object.create(null)}getCanvas(f,p,E){let U;return this.cache[f]!==void 0?(U=this.cache[f],this.canvasFactory.reset(U,p,E)):(U=this.canvasFactory.create(p,E),this.cache[f]=U),U}delete(f){delete this.cache[f]}clear(){for(const f in this.cache){const p=this.cache[f];this.canvasFactory.destroy(p),delete this.cache[f]}}}function r(G,f,p,E,U,O,X,V,Q,z){const[j,F,e,h,b,x]=(0,S.getCurrentTransform)(G);if(F===0&&e===0){const nt=X*j+b,st=Math.round(nt),rt=V*h+x,at=Math.round(rt),dt=(X+Q)*j+b,ct=Math.abs(Math.round(dt)-st)||1,mt=(V+z)*h+x,gt=Math.abs(Math.round(mt)-at)||1;return G.setTransform(Math.sign(j),0,0,Math.sign(h),st,at),G.drawImage(f,p,E,U,O,0,0,ct,gt),G.setTransform(j,F,e,h,b,x),[ct,gt]}if(j===0&&h===0){const nt=V*e+b,st=Math.round(nt),rt=X*F+x,at=Math.round(rt),dt=(V+z)*e+b,ct=Math.abs(Math.round(dt)-st)||1,mt=(X+Q)*F+x,gt=Math.abs(Math.round(mt)-at)||1;return G.setTransform(0,Math.sign(F),Math.sign(e),0,st,at),G.drawImage(f,p,E,U,O,0,0,gt,ct),G.setTransform(j,F,e,h,b,x),[gt,ct]}G.drawImage(f,p,E,U,O,X,V,Q,z);const I=Math.hypot(j,F),B=Math.hypot(e,h);return[I*Q,B*z]}function k(G){const{width:f,height:p}=G;if(f>A||p>A)return null;const E=1e3,U=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),O=f+1;let X=new Uint8Array(O*(p+1)),V,Q,z;const j=f+7&-8;let F=new Uint8Array(j*p),e=0;for(const B of G.data){let nt=128;for(;nt>0;)F[e++]=B&nt?0:255,nt>>=1}let h=0;for(e=0,F[e]!==0&&(X[0]=1,++h),Q=1;Q<f;Q++)F[e]!==F[e+1]&&(X[Q]=F[e]?2:1,++h),e++;for(F[e]!==0&&(X[Q]=2,++h),V=1;V<p;V++){e=V*j,z=V*O,F[e-j]!==F[e]&&(X[z]=F[e]?1:8,++h);let B=(F[e]?4:0)+(F[e-j]?8:0);for(Q=1;Q<f;Q++)B=(B>>2)+(F[e+1]?4:0)+(F[e-j+1]?8:0),U[B]&&(X[z+Q]=U[B],++h),e++;if(F[e-j]!==F[e]&&(X[z+Q]=F[e]?2:4,++h),h>E)return null}for(e=j*(p-1),z=V*O,F[e]!==0&&(X[z]=8,++h),Q=1;Q<f;Q++)F[e]!==F[e+1]&&(X[z+Q]=F[e]?4:8,++h),e++;if(F[e]!==0&&(X[z+Q]=4,++h),h>E)return null;const b=new Int32Array([0,O,-1,0,-O,0,0,0,1]),x=new Path2D;for(V=0;h&&V<=p;V++){let B=V*O;const nt=B+f;for(;B<nt&&!X[B];)B++;if(B===nt)continue;x.moveTo(B%O,V);const st=B;let rt=X[B];do{const at=b[rt];do B+=at;while(!X[B]);const dt=X[B];dt!==5&&dt!==10?(rt=dt,X[B]=0):(rt=dt&51*rt>>4,X[B]&=rt>>2|rt<<2),x.lineTo(B%O,B/O|0),X[B]||--h}while(st!==B);--V}return F=null,X=null,function(B){B.save(),B.scale(1/f,-1/p),B.translate(0,-p),B.fill(x),B.beginPath(),B.restore()}}class M{constructor(f,p){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=l.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=l.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=l.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,f,p])}clone(){const f=Object.create(this);return f.clipBox=this.clipBox.slice(),f}setCurrentPoint(f,p){this.x=f,this.y=p}updatePathMinMax(f,p,E){[p,E]=l.Util.applyTransform([p,E],f),this.minX=Math.min(this.minX,p),this.minY=Math.min(this.minY,E),this.maxX=Math.max(this.maxX,p),this.maxY=Math.max(this.maxY,E)}updateRectMinMax(f,p){const E=l.Util.applyTransform(p,f),U=l.Util.applyTransform(p.slice(2),f);this.minX=Math.min(this.minX,E[0],U[0]),this.minY=Math.min(this.minY,E[1],U[1]),this.maxX=Math.max(this.maxX,E[0],U[0]),this.maxY=Math.max(this.maxY,E[1],U[1])}updateScalingPathMinMax(f,p){l.Util.scaleMinMax(f,p),this.minX=Math.min(this.minX,p[0]),this.maxX=Math.max(this.maxX,p[1]),this.minY=Math.min(this.minY,p[2]),this.maxY=Math.max(this.maxY,p[3])}updateCurvePathMinMax(f,p,E,U,O,X,V,Q,z,j){const F=l.Util.bezierBoundingBox(p,E,U,O,X,V,Q,z);if(j){j[0]=Math.min(j[0],F[0],F[2]),j[1]=Math.max(j[1],F[0],F[2]),j[2]=Math.min(j[2],F[1],F[3]),j[3]=Math.max(j[3],F[1],F[3]);return}this.updateRectMinMax(f,F)}getPathBoundingBox(f=W.PathType.FILL,p=null){const E=[this.minX,this.minY,this.maxX,this.maxY];if(f===W.PathType.STROKE){p||(0,l.unreachable)("Stroke bounding box must include transform.");const U=l.Util.singularValueDecompose2dScale(p),O=U[0]*this.lineWidth/2,X=U[1]*this.lineWidth/2;E[0]-=O,E[1]-=X,E[2]+=O,E[3]+=X}return E}updateClipFromPath(){const f=l.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(f||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(f){this.clipBox=f,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(f=W.PathType.FILL,p=null){return l.Util.intersect(this.clipBox,this.getPathBoundingBox(f,p))}}function v(G,f){if(typeof ImageData<"u"&&f instanceof ImageData){G.putImageData(f,0,0);return}const p=f.height,E=f.width,U=p%d,O=(p-U)/d,X=U===0?O:O+1,V=G.createImageData(E,d);let Q=0,z;const j=f.data,F=V.data;let e,h,b,x;if(f.kind===l.ImageKind.GRAYSCALE_1BPP){const I=j.byteLength,B=new Uint32Array(F.buffer,0,F.byteLength>>2),nt=B.length,st=E+7>>3,rt=4294967295,at=l.FeatureTest.isLittleEndian?4278190080:255;for(e=0;e<X;e++){for(b=e<O?d:U,z=0,h=0;h<b;h++){const dt=I-Q;let ct=0;const mt=dt>st?E:dt*8-7,gt=mt&-8;let Et=0,At=0;for(;ct<gt;ct+=8)At=j[Q++],B[z++]=At&128?rt:at,B[z++]=At&64?rt:at,B[z++]=At&32?rt:at,B[z++]=At&16?rt:at,B[z++]=At&8?rt:at,B[z++]=At&4?rt:at,B[z++]=At&2?rt:at,B[z++]=At&1?rt:at;for(;ct<mt;ct++)Et===0&&(At=j[Q++],Et=128),B[z++]=At&Et?rt:at,Et>>=1}for(;z<nt;)B[z++]=0;G.putImageData(V,0,e*d)}}else if(f.kind===l.ImageKind.RGBA_32BPP){for(h=0,x=E*d*4,e=0;e<O;e++)F.set(j.subarray(Q,Q+x)),Q+=x,G.putImageData(V,0,h),h+=d;e<X&&(x=E*U*4,F.set(j.subarray(Q,Q+x)),G.putImageData(V,0,h))}else if(f.kind===l.ImageKind.RGB_24BPP)for(b=d,x=E*b,e=0;e<X;e++){for(e>=O&&(b=U,x=E*b),z=0,h=x;h--;)F[z++]=j[Q++],F[z++]=j[Q++],F[z++]=j[Q++],F[z++]=255;G.putImageData(V,0,e*d)}else throw new Error(`bad image kind: ${f.kind}`)}function t(G,f){if(f.bitmap){G.drawImage(f.bitmap,0,0);return}const p=f.height,E=f.width,U=p%d,O=(p-U)/d,X=U===0?O:O+1,V=G.createImageData(E,d);let Q=0;const z=f.data,j=V.data;for(let F=0;F<X;F++){const e=F<O?d:U;({srcPos:Q}=(0,N.convertBlackAndWhiteToRGBA)({src:z,srcPos:Q,dest:j,width:E,height:e,nonBlackColor:0})),G.putImageData(V,0,F*d)}}function c(G,f){const p=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const E of p)G[E]!==void 0&&(f[E]=G[E]);G.setLineDash!==void 0&&(f.setLineDash(G.getLineDash()),f.lineDashOffset=G.lineDashOffset)}function o(G){G.strokeStyle=G.fillStyle="#000000",G.fillRule="nonzero",G.globalAlpha=1,G.lineWidth=1,G.lineCap="butt",G.lineJoin="miter",G.miterLimit=10,G.globalCompositeOperation="source-over",G.font="10px sans-serif",G.setLineDash!==void 0&&(G.setLineDash([]),G.lineDashOffset=0),J.isNodeJS||(G.filter="none")}function n(G,f,p,E){const U=G.length;for(let O=3;O<U;O+=4){const X=G[O];if(X===0)G[O-3]=f,G[O-2]=p,G[O-1]=E;else if(X<255){const V=255-X;G[O-3]=G[O-3]*X+f*V>>8,G[O-2]=G[O-2]*X+p*V>>8,G[O-1]=G[O-1]*X+E*V>>8}}}function u(G,f,p){const E=G.length,U=1/255;for(let O=3;O<E;O+=4){const X=p?p[G[O]]:G[O];f[O]=f[O]*X*U|0}}function T(G,f,p){const E=G.length;for(let U=3;U<E;U+=4){const O=G[U-3]*77+G[U-2]*152+G[U-1]*28;f[U]=p?f[U]*p[O>>8]>>8:f[U]*O>>16}}function a(G,f,p,E,U,O,X,V,Q,z,j){const F=!!O,e=F?O[0]:0,h=F?O[1]:0,b=F?O[2]:0;let x;U==="Luminosity"?x=T:x=u;const B=Math.min(E,Math.ceil(1048576/p));for(let nt=0;nt<E;nt+=B){const st=Math.min(B,E-nt),rt=G.getImageData(V-z,nt+(Q-j),p,st),at=f.getImageData(V,nt+Q,p,st);F&&n(rt.data,e,h,b),x(rt.data,at.data,X),f.putImageData(at,V,nt+Q)}}function D(G,f,p,E){const U=E[0],O=E[1],X=E[2]-U,V=E[3]-O;X===0||V===0||(a(f.context,p,X,V,f.subtype,f.backdrop,f.transferMap,U,O,f.offsetX,f.offsetY),G.save(),G.globalAlpha=1,G.globalCompositeOperation="source-over",G.setTransform(1,0,0,1,0,0),G.drawImage(p.canvas,0,0),G.restore())}function $(G,f){const p=l.Util.singularValueDecompose2dScale(G);p[0]=Math.fround(p[0]),p[1]=Math.fround(p[1]);const E=Math.fround((globalThis.devicePixelRatio||1)*S.PixelsPerInch.PDF_TO_CSS_UNITS);return f!==void 0?f:p[0]<=E||p[1]<=E}const Y=["butt","round","square"],tt=["miter","round","bevel"],it={},ut={},yt=class{constructor(f,p,E,U,O,{optionalContentConfig:X,markedContentStack:V=null},Q){et(this,ft);this.ctx=f,this.current=new M(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=p,this.objs=E,this.canvasFactory=U,this.filterFactory=O,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=V||[],this.optionalContentConfig=X,this.cachedCanvases=new s(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=Q,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(f,p=null){return typeof f=="string"?f.startsWith("g_")?this.commonObjs.get(f):this.objs.get(f):p}beginDrawing({transform:f,viewport:p,transparency:E=!1,background:U=null}){const O=this.ctx.canvas.width,X=this.ctx.canvas.height,V=this.ctx.fillStyle;if(this.ctx.fillStyle=U||"#ffffff",this.ctx.fillRect(0,0,O,X),this.ctx.fillStyle=V,E){const Q=this.cachedCanvases.getCanvas("transparent",O,X);this.compositeCtx=this.ctx,this.transparentCanvas=Q.canvas,this.ctx=Q.context,this.ctx.save(),this.ctx.transform(...(0,S.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),o(this.ctx),f&&(this.ctx.transform(...f),this.outputScaleX=f[0],this.outputScaleY=f[0]),this.ctx.transform(...p.transform),this.viewportScale=p.scale,this.baseTransform=(0,S.getCurrentTransform)(this.ctx)}executeOperatorList(f,p,E,U){const O=f.argsArray,X=f.fnArray;let V=p||0;const Q=O.length;if(Q===V)return V;const z=Q-V>y&&typeof E=="function",j=z?Date.now()+w:0;let F=0;const e=this.commonObjs,h=this.objs;let b;for(;;){if(U!==void 0&&V===U.nextBreakPoint)return U.breakIt(V,E),V;if(b=X[V],b!==l.OPS.dependency)this[b].apply(this,O[V]);else for(const x of O[V]){const I=x.startsWith("g_")?e:h;if(!I.has(x))return I.get(x,E),V}if(V++,V===Q)return V;if(z&&++F>y){if(Date.now()>j)return E(),V;F=0}}}endDrawing(f=null){ot(this,ft,me).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const p of this._cachedBitmapsMap.values()){for(const E of p.values())typeof HTMLCanvasElement<"u"&&E instanceof HTMLCanvasElement&&(E.width=E.height=0);p.clear()}if(this._cachedBitmapsMap.clear(),f){const p=this.filterFactory.addHCMFilter(f.foreground,f.background);if(p!=="none"){const E=this.ctx.filter;this.ctx.filter=p,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=E}}}_scaleImage(f,p){const E=f.width,U=f.height;let O=Math.max(Math.hypot(p[0],p[1]),1),X=Math.max(Math.hypot(p[2],p[3]),1),V=E,Q=U,z="prescale1",j,F;for(;O>2&&V>1||X>2&&Q>1;){let e=V,h=Q;O>2&&V>1&&(e=V>=16384?Math.floor(V/2)-1||1:Math.ceil(V/2),O/=V/e),X>2&&Q>1&&(h=Q>=16384?Math.floor(Q/2)-1||1:Math.ceil(Q)/2,X/=Q/h),j=this.cachedCanvases.getCanvas(z,e,h),F=j.context,F.clearRect(0,0,e,h),F.drawImage(f,0,0,V,Q,0,0,e,h),f=j.canvas,V=e,Q=h,z=z==="prescale1"?"prescale2":"prescale1"}return{img:f,paintWidth:V,paintHeight:Q}}_createMaskCanvas(f){const p=this.ctx,{width:E,height:U}=f,O=this.current.fillColor,X=this.current.patternFill,V=(0,S.getCurrentTransform)(p);let Q,z,j,F;if((f.bitmap||f.data)&&f.count>1){const ct=f.bitmap||f.data.buffer;z=JSON.stringify(X?V:[V.slice(0,4),O]),Q=this._cachedBitmapsMap.get(ct),Q||(Q=new Map,this._cachedBitmapsMap.set(ct,Q));const mt=Q.get(z);if(mt&&!X){const gt=Math.round(Math.min(V[0],V[2])+V[4]),Et=Math.round(Math.min(V[1],V[3])+V[5]);return{canvas:mt,offsetX:gt,offsetY:Et}}j=mt}j||(F=this.cachedCanvases.getCanvas("maskCanvas",E,U),t(F.context,f));let e=l.Util.transform(V,[1/E,0,0,-1/U,0,0]);e=l.Util.transform(e,[1,0,0,1,0,-U]);const h=l.Util.applyTransform([0,0],e),b=l.Util.applyTransform([E,U],e),x=l.Util.normalizeRect([h[0],h[1],b[0],b[1]]),I=Math.round(x[2]-x[0])||1,B=Math.round(x[3]-x[1])||1,nt=this.cachedCanvases.getCanvas("fillCanvas",I,B),st=nt.context,rt=Math.min(h[0],b[0]),at=Math.min(h[1],b[1]);st.translate(-rt,-at),st.transform(...e),j||(j=this._scaleImage(F.canvas,(0,S.getCurrentTransformInverse)(st)),j=j.img,Q&&X&&Q.set(z,j)),st.imageSmoothingEnabled=$((0,S.getCurrentTransform)(st),f.interpolate),r(st,j,0,0,j.width,j.height,0,0,E,U),st.globalCompositeOperation="source-in";const dt=l.Util.transform((0,S.getCurrentTransformInverse)(st),[1,0,0,1,-rt,-at]);return st.fillStyle=X?O.getPattern(p,this,dt,W.PathType.FILL):O,st.fillRect(0,0,E,U),Q&&!X&&(this.cachedCanvases.delete("fillCanvas"),Q.set(z,nt.canvas)),{canvas:nt.canvas,offsetX:Math.round(rt),offsetY:Math.round(at)}}setLineWidth(f){f!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=f,this.ctx.lineWidth=f}setLineCap(f){this.ctx.lineCap=Y[f]}setLineJoin(f){this.ctx.lineJoin=tt[f]}setMiterLimit(f){this.ctx.miterLimit=f}setDash(f,p){const E=this.ctx;E.setLineDash!==void 0&&(E.setLineDash(f),E.lineDashOffset=p)}setRenderingIntent(f){}setFlatness(f){}setGState(f){for(const[p,E]of f)switch(p){case"LW":this.setLineWidth(E);break;case"LC":this.setLineCap(E);break;case"LJ":this.setLineJoin(E);break;case"ML":this.setMiterLimit(E);break;case"D":this.setDash(E[0],E[1]);break;case"RI":this.setRenderingIntent(E);break;case"FL":this.setFlatness(E);break;case"Font":this.setFont(E[0],E[1]);break;case"CA":this.current.strokeAlpha=E;break;case"ca":this.current.fillAlpha=E,this.ctx.globalAlpha=E;break;case"BM":this.ctx.globalCompositeOperation=E;break;case"SMask":this.current.activeSMask=E?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(E);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const f=this.inSMaskMode;this.current.activeSMask&&!f?this.beginSMaskMode():!this.current.activeSMask&&f&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const f=this.ctx.canvas.width,p=this.ctx.canvas.height,E="smaskGroupAt"+this.groupLevel,U=this.cachedCanvases.getCanvas(E,f,p);this.suspendedCtx=this.ctx,this.ctx=U.context;const O=this.ctx;O.setTransform(...(0,S.getCurrentTransform)(this.suspendedCtx)),c(this.suspendedCtx,O),g(O,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),c(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(f){if(!this.current.activeSMask)return;f?(f[0]=Math.floor(f[0]),f[1]=Math.floor(f[1]),f[2]=Math.ceil(f[2]),f[3]=Math.ceil(f[3])):f=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const p=this.current.activeSMask,E=this.suspendedCtx;D(E,p,this.ctx,f),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(c(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const f=this.current;this.stateStack.push(f),this.current=f.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),c(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(f,p,E,U,O,X){this.ctx.transform(f,p,E,U,O,X),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(f,p,E){const U=this.ctx,O=this.current;let X=O.x,V=O.y,Q,z;const j=(0,S.getCurrentTransform)(U),F=j[0]===0&&j[3]===0||j[1]===0&&j[2]===0,e=F?E.slice(0):null;for(let h=0,b=0,x=f.length;h<x;h++)switch(f[h]|0){case l.OPS.rectangle:X=p[b++],V=p[b++];const I=p[b++],B=p[b++],nt=X+I,st=V+B;U.moveTo(X,V),I===0||B===0?U.lineTo(nt,st):(U.lineTo(nt,V),U.lineTo(nt,st),U.lineTo(X,st)),F||O.updateRectMinMax(j,[X,V,nt,st]),U.closePath();break;case l.OPS.moveTo:X=p[b++],V=p[b++],U.moveTo(X,V),F||O.updatePathMinMax(j,X,V);break;case l.OPS.lineTo:X=p[b++],V=p[b++],U.lineTo(X,V),F||O.updatePathMinMax(j,X,V);break;case l.OPS.curveTo:Q=X,z=V,X=p[b+4],V=p[b+5],U.bezierCurveTo(p[b],p[b+1],p[b+2],p[b+3],X,V),O.updateCurvePathMinMax(j,Q,z,p[b],p[b+1],p[b+2],p[b+3],X,V,e),b+=6;break;case l.OPS.curveTo2:Q=X,z=V,U.bezierCurveTo(X,V,p[b],p[b+1],p[b+2],p[b+3]),O.updateCurvePathMinMax(j,Q,z,X,V,p[b],p[b+1],p[b+2],p[b+3],e),X=p[b+2],V=p[b+3],b+=4;break;case l.OPS.curveTo3:Q=X,z=V,X=p[b+2],V=p[b+3],U.bezierCurveTo(p[b],p[b+1],X,V,X,V),O.updateCurvePathMinMax(j,Q,z,p[b],p[b+1],X,V,X,V,e),b+=4;break;case l.OPS.closePath:U.closePath();break}F&&O.updateScalingPathMinMax(j,e),O.setCurrentPoint(X,V)}closePath(){this.ctx.closePath()}stroke(f=!0){const p=this.ctx,E=this.current.strokeColor;p.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof E=="object"&&(E!=null&&E.getPattern)?(p.save(),p.strokeStyle=E.getPattern(p,this,(0,S.getCurrentTransformInverse)(p),W.PathType.STROKE),this.rescaleAndStroke(!1),p.restore()):this.rescaleAndStroke(!0)),f&&this.consumePath(this.current.getClippedPathBoundingBox()),p.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(f=!0){const p=this.ctx,E=this.current.fillColor,U=this.current.patternFill;let O=!1;U&&(p.save(),p.fillStyle=E.getPattern(p,this,(0,S.getCurrentTransformInverse)(p),W.PathType.FILL),O=!0);const X=this.current.getClippedPathBoundingBox();this.contentVisible&&X!==null&&(this.pendingEOFill?(p.fill("evenodd"),this.pendingEOFill=!1):p.fill()),O&&p.restore(),f&&this.consumePath(X)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=it}eoClip(){this.pendingClip=ut}beginText(){this.current.textMatrix=l.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const f=this.pendingTextPaths,p=this.ctx;if(f===void 0){p.beginPath();return}p.save(),p.beginPath();for(const E of f)p.setTransform(...E.transform),p.translate(E.x,E.y),E.addToPath(p,E.fontSize);p.restore(),p.clip(),p.beginPath(),delete this.pendingTextPaths}setCharSpacing(f){this.current.charSpacing=f}setWordSpacing(f){this.current.wordSpacing=f}setHScale(f){this.current.textHScale=f/100}setLeading(f){this.current.leading=-f}setFont(f,p){const E=this.commonObjs.get(f),U=this.current;if(!E)throw new Error(`Can't find font for ${f}`);if(U.fontMatrix=E.fontMatrix||l.FONT_IDENTITY_MATRIX,(U.fontMatrix[0]===0||U.fontMatrix[3]===0)&&(0,l.warn)("Invalid font matrix for font "+f),p<0?(p=-p,U.fontDirection=-1):U.fontDirection=1,this.current.font=E,this.current.fontSize=p,E.isType3Font)return;const O=E.loadedName||"sans-serif";let X="normal";E.black?X="900":E.bold&&(X="bold");const V=E.italic?"italic":"normal",Q=`"${O}", ${E.fallbackName}`;let z=p;p<R?z=R:p>C&&(z=C),this.current.fontSizeScale=p/z,this.ctx.font=`${V} ${X} ${z}px ${Q}`}setTextRenderingMode(f){this.current.textRenderingMode=f}setTextRise(f){this.current.textRise=f}moveText(f,p){this.current.x=this.current.lineX+=f,this.current.y=this.current.lineY+=p}setLeadingMoveText(f,p){this.setLeading(-p),this.moveText(f,p)}setTextMatrix(f,p,E,U,O,X){this.current.textMatrix=[f,p,E,U,O,X],this.current.textMatrixScale=Math.hypot(f,p),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(f,p,E,U){const O=this.ctx,X=this.current,V=X.font,Q=X.textRenderingMode,z=X.fontSize/X.fontSizeScale,j=Q&l.TextRenderingMode.FILL_STROKE_MASK,F=!!(Q&l.TextRenderingMode.ADD_TO_PATH_FLAG),e=X.patternFill&&!V.missingFile;let h;(V.disableFontFace||F||e)&&(h=V.getPathGenerator(this.commonObjs,f)),V.disableFontFace||e?(O.save(),O.translate(p,E),O.beginPath(),h(O,z),U&&O.setTransform(...U),(j===l.TextRenderingMode.FILL||j===l.TextRenderingMode.FILL_STROKE)&&O.fill(),(j===l.TextRenderingMode.STROKE||j===l.TextRenderingMode.FILL_STROKE)&&O.stroke(),O.restore()):((j===l.TextRenderingMode.FILL||j===l.TextRenderingMode.FILL_STROKE)&&O.fillText(f,p,E),(j===l.TextRenderingMode.STROKE||j===l.TextRenderingMode.FILL_STROKE)&&O.strokeText(f,p,E)),F&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,S.getCurrentTransform)(O),x:p,y:E,fontSize:z,addToPath:h})}get isFontSubpixelAAEnabled(){const{context:f}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);f.scale(1.5,1),f.fillText("I",0,10);const p=f.getImageData(0,0,10,10).data;let E=!1;for(let U=3;U<p.length;U+=4)if(p[U]>0&&p[U]<255){E=!0;break}return(0,l.shadow)(this,"isFontSubpixelAAEnabled",E)}showText(f){const p=this.current,E=p.font;if(E.isType3Font)return this.showType3Text(f);const U=p.fontSize;if(U===0)return;const O=this.ctx,X=p.fontSizeScale,V=p.charSpacing,Q=p.wordSpacing,z=p.fontDirection,j=p.textHScale*z,F=f.length,e=E.vertical,h=e?1:-1,b=E.defaultVMetrics,x=U*p.fontMatrix[0],I=p.textRenderingMode===l.TextRenderingMode.FILL&&!E.disableFontFace&&!p.patternFill;O.save(),O.transform(...p.textMatrix),O.translate(p.x,p.y+p.textRise),z>0?O.scale(j,-1):O.scale(j,1);let B;if(p.patternFill){O.save();const dt=p.fillColor.getPattern(O,this,(0,S.getCurrentTransformInverse)(O),W.PathType.FILL);B=(0,S.getCurrentTransform)(O),O.restore(),O.fillStyle=dt}let nt=p.lineWidth;const st=p.textMatrixScale;if(st===0||nt===0){const dt=p.textRenderingMode&l.TextRenderingMode.FILL_STROKE_MASK;(dt===l.TextRenderingMode.STROKE||dt===l.TextRenderingMode.FILL_STROKE)&&(nt=this.getSinglePixelWidth())}else nt/=st;if(X!==1&&(O.scale(X,X),nt/=X),O.lineWidth=nt,E.isInvalidPDFjsFont){const dt=[];let ct=0;for(const mt of f)dt.push(mt.unicode),ct+=mt.width;O.fillText(dt.join(""),0,0),p.x+=ct*x*j,O.restore(),this.compose();return}let rt=0,at;for(at=0;at<F;++at){const dt=f[at];if(typeof dt=="number"){rt+=h*dt*U/1e3;continue}let ct=!1;const mt=(dt.isSpace?Q:0)+V,gt=dt.fontChar,Et=dt.accent;let At,xt,P=dt.width;if(e){const q=dt.vmetric||b,_t=-(dt.vmetric?q[1]:P*.5)*x,Ct=q[2]*x;P=q?-q[0]:P,At=_t/X,xt=(rt+Ct)/X}else At=rt/X,xt=0;if(E.remeasure&&P>0){const q=O.measureText(gt).width*1e3/U*X;if(P<q&&this.isFontSubpixelAAEnabled){const _t=P/q;ct=!0,O.save(),O.scale(_t,1),At/=_t}else P!==q&&(At+=(P-q)/2e3*U/X)}if(this.contentVisible&&(dt.isInFont||E.missingFile)){if(I&&!Et)O.fillText(gt,At,xt);else if(this.paintChar(gt,At,xt,B),Et){const q=At+U*Et.offset.x/X,_t=xt-U*Et.offset.y/X;this.paintChar(Et.fontChar,q,_t,B)}}let H;e?H=P*x-mt*z:H=P*x+mt*z,rt+=H,ct&&O.restore()}e?p.y-=rt:p.x+=rt*j,O.restore(),this.compose()}showType3Text(f){const p=this.ctx,E=this.current,U=E.font,O=E.fontSize,X=E.fontDirection,V=U.vertical?1:-1,Q=E.charSpacing,z=E.wordSpacing,j=E.textHScale*X,F=E.fontMatrix||l.FONT_IDENTITY_MATRIX,e=f.length,h=E.textRenderingMode===l.TextRenderingMode.INVISIBLE;let b,x,I,B;if(!(h||O===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,p.save(),p.transform(...E.textMatrix),p.translate(E.x,E.y),p.scale(j,X),b=0;b<e;++b){if(x=f[b],typeof x=="number"){B=V*x*O/1e3,this.ctx.translate(B,0),E.x+=B*j;continue}const nt=(x.isSpace?z:0)+Q,st=U.charProcOperatorList[x.operatorListId];if(!st){(0,l.warn)(`Type3 character "${x.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=x,this.save(),p.scale(O,O),p.transform(...F),this.executeOperatorList(st),this.restore()),I=l.Util.applyTransform([x.width,0],F)[0]*O+nt,p.translate(I,0),E.x+=I*j}p.restore(),this.processingType3=null}}setCharWidth(f,p){}setCharWidthAndBounds(f,p,E,U,O,X){this.ctx.rect(E,U,O-E,X-U),this.ctx.clip(),this.endPath()}getColorN_Pattern(f){let p;if(f[0]==="TilingPattern"){const E=f[1],U=this.baseTransform||(0,S.getCurrentTransform)(this.ctx),O={createCanvasGraphics:X=>new yt(X,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};p=new W.TilingPattern(f,E,this.ctx,O,U)}else p=this._getPattern(f[1],f[2]);return p}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(f,p,E){const U=l.Util.makeHexColor(f,p,E);this.ctx.strokeStyle=U,this.current.strokeColor=U}setFillRGBColor(f,p,E){const U=l.Util.makeHexColor(f,p,E);this.ctx.fillStyle=U,this.current.fillColor=U,this.current.patternFill=!1}_getPattern(f,p=null){let E;return this.cachedPatterns.has(f)?E=this.cachedPatterns.get(f):(E=(0,W.getShadingPattern)(this.getObject(f)),this.cachedPatterns.set(f,E)),p&&(E.matrix=p),E}shadingFill(f){if(!this.contentVisible)return;const p=this.ctx;this.save();const E=this._getPattern(f);p.fillStyle=E.getPattern(p,this,(0,S.getCurrentTransformInverse)(p),W.PathType.SHADING);const U=(0,S.getCurrentTransformInverse)(p);if(U){const O=p.canvas,X=O.width,V=O.height,Q=l.Util.applyTransform([0,0],U),z=l.Util.applyTransform([0,V],U),j=l.Util.applyTransform([X,0],U),F=l.Util.applyTransform([X,V],U),e=Math.min(Q[0],z[0],j[0],F[0]),h=Math.min(Q[1],z[1],j[1],F[1]),b=Math.max(Q[0],z[0],j[0],F[0]),x=Math.max(Q[1],z[1],j[1],F[1]);this.ctx.fillRect(e,h,b-e,x-h)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,l.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,l.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(f,p){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(f)&&f.length===6&&this.transform(...f),this.baseTransform=(0,S.getCurrentTransform)(this.ctx),p)){const E=p[2]-p[0],U=p[3]-p[1];this.ctx.rect(p[0],p[1],E,U),this.current.updateRectMinMax((0,S.getCurrentTransform)(this.ctx),p),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(f){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const p=this.ctx;f.isolated||(0,l.info)("TODO: Support non-isolated groups."),f.knockout&&(0,l.warn)("Knockout groups not supported.");const E=(0,S.getCurrentTransform)(p);if(f.matrix&&p.transform(...f.matrix),!f.bbox)throw new Error("Bounding box is required.");let U=l.Util.getAxialAlignedBoundingBox(f.bbox,(0,S.getCurrentTransform)(p));const O=[0,0,p.canvas.width,p.canvas.height];U=l.Util.intersect(U,O)||[0,0,0,0];const X=Math.floor(U[0]),V=Math.floor(U[1]);let Q=Math.max(Math.ceil(U[2])-X,1),z=Math.max(Math.ceil(U[3])-V,1),j=1,F=1;Q>_&&(j=Q/_,Q=_),z>_&&(F=z/_,z=_),this.current.startNewPathAndClipBox([0,0,Q,z]);let e="groupAt"+this.groupLevel;f.smask&&(e+="_smask_"+this.smaskCounter++%2);const h=this.cachedCanvases.getCanvas(e,Q,z),b=h.context;b.scale(1/j,1/F),b.translate(-X,-V),b.transform(...E),f.smask?this.smaskStack.push({canvas:h.canvas,context:b,offsetX:X,offsetY:V,scaleX:j,scaleY:F,subtype:f.smask.subtype,backdrop:f.smask.backdrop,transferMap:f.smask.transferMap||null,startTransformInverse:null}):(p.setTransform(1,0,0,1,0,0),p.translate(X,V),p.scale(j,F),p.save()),c(p,b),this.ctx=b,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(p),this.groupLevel++}endGroup(f){if(!this.contentVisible)return;this.groupLevel--;const p=this.ctx,E=this.groupStack.pop();if(this.ctx=E,this.ctx.imageSmoothingEnabled=!1,f.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const U=(0,S.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...U);const O=l.Util.getAxialAlignedBoundingBox([0,0,p.canvas.width,p.canvas.height],U);this.ctx.drawImage(p.canvas,0,0),this.ctx.restore(),this.compose(O)}}beginAnnotation(f,p,E,U,O){if(ot(this,ft,me).call(this),o(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(p)&&p.length===4){const X=p[2]-p[0],V=p[3]-p[1];if(O&&this.annotationCanvasMap){E=E.slice(),E[4]-=p[0],E[5]-=p[1],p=p.slice(),p[0]=p[1]=0,p[2]=X,p[3]=V;const[Q,z]=l.Util.singularValueDecompose2dScale((0,S.getCurrentTransform)(this.ctx)),{viewportScale:j}=this,F=Math.ceil(X*this.outputScaleX*j),e=Math.ceil(V*this.outputScaleY*j);this.annotationCanvas=this.canvasFactory.create(F,e);const{canvas:h,context:b}=this.annotationCanvas;this.annotationCanvasMap.set(f,h),this.annotationCanvas.savedCtx=this.ctx,this.ctx=b,this.ctx.setTransform(Q,0,0,-z,0,V*z),o(this.ctx)}else o(this.ctx),this.ctx.rect(p[0],p[1],X,V),this.ctx.clip(),this.endPath()}this.current=new M(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...E),this.transform(...U)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(f){if(!this.contentVisible)return;const p=f.count;f=this.getObject(f.data,f),f.count=p;const E=this.ctx,U=this.processingType3;if(U&&(U.compiled===void 0&&(U.compiled=k(f)),U.compiled)){U.compiled(E);return}const O=this._createMaskCanvas(f),X=O.canvas;E.save(),E.setTransform(1,0,0,1,0,0),E.drawImage(X,O.offsetX,O.offsetY),E.restore(),this.compose()}paintImageMaskXObjectRepeat(f,p,E=0,U=0,O,X){if(!this.contentVisible)return;f=this.getObject(f.data,f);const V=this.ctx;V.save();const Q=(0,S.getCurrentTransform)(V);V.transform(p,E,U,O,0,0);const z=this._createMaskCanvas(f);V.setTransform(1,0,0,1,z.offsetX-Q[4],z.offsetY-Q[5]);for(let j=0,F=X.length;j<F;j+=2){const e=l.Util.transform(Q,[p,E,U,O,X[j],X[j+1]]),[h,b]=l.Util.applyTransform([0,0],e);V.drawImage(z.canvas,h,b)}V.restore(),this.compose()}paintImageMaskXObjectGroup(f){if(!this.contentVisible)return;const p=this.ctx,E=this.current.fillColor,U=this.current.patternFill;for(const O of f){const{data:X,width:V,height:Q,transform:z}=O,j=this.cachedCanvases.getCanvas("maskCanvas",V,Q),F=j.context;F.save();const e=this.getObject(X,O);t(F,e),F.globalCompositeOperation="source-in",F.fillStyle=U?E.getPattern(F,this,(0,S.getCurrentTransformInverse)(p),W.PathType.FILL):E,F.fillRect(0,0,V,Q),F.restore(),p.save(),p.transform(...z),p.scale(1,-1),r(p,j.canvas,0,0,V,Q,0,-1,1,1),p.restore()}this.compose()}paintImageXObject(f){if(!this.contentVisible)return;const p=this.getObject(f);if(!p){(0,l.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(p)}paintImageXObjectRepeat(f,p,E,U){if(!this.contentVisible)return;const O=this.getObject(f);if(!O){(0,l.warn)("Dependent image isn't ready yet");return}const X=O.width,V=O.height,Q=[];for(let z=0,j=U.length;z<j;z+=2)Q.push({transform:[p,0,0,E,U[z],U[z+1]],x:0,y:0,w:X,h:V});this.paintInlineImageXObjectGroup(O,Q)}applyTransferMapsToCanvas(f){return this.current.transferMaps!=="none"&&(f.filter=this.current.transferMaps,f.drawImage(f.canvas,0,0),f.filter="none"),f.canvas}applyTransferMapsToBitmap(f){if(this.current.transferMaps==="none")return f.bitmap;const{bitmap:p,width:E,height:U}=f,O=this.cachedCanvases.getCanvas("inlineImage",E,U),X=O.context;return X.filter=this.current.transferMaps,X.drawImage(p,0,0),X.filter="none",O.canvas}paintInlineImageXObject(f){if(!this.contentVisible)return;const p=f.width,E=f.height,U=this.ctx;this.save(),J.isNodeJS||(U.filter="none"),U.scale(1/p,-1/E);let O;if(f.bitmap)O=this.applyTransferMapsToBitmap(f);else if(typeof HTMLElement=="function"&&f instanceof HTMLElement||!f.data)O=f;else{const Q=this.cachedCanvases.getCanvas("inlineImage",p,E).context;v(Q,f),O=this.applyTransferMapsToCanvas(Q)}const X=this._scaleImage(O,(0,S.getCurrentTransformInverse)(U));U.imageSmoothingEnabled=$((0,S.getCurrentTransform)(U),f.interpolate),r(U,X.img,0,0,X.paintWidth,X.paintHeight,0,-E,p,E),this.compose(),this.restore()}paintInlineImageXObjectGroup(f,p){if(!this.contentVisible)return;const E=this.ctx;let U;if(f.bitmap)U=f.bitmap;else{const O=f.width,X=f.height,Q=this.cachedCanvases.getCanvas("inlineImage",O,X).context;v(Q,f),U=this.applyTransferMapsToCanvas(Q)}for(const O of p)E.save(),E.transform(...O.transform),E.scale(1,-1),r(E,U,O.x,O.y,O.w,O.h,0,-1,1,1),E.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(f){}markPointProps(f,p){}beginMarkedContent(f){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(f,p){f==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(p)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(f){const p=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(f);const E=this.ctx;this.pendingClip&&(p||(this.pendingClip===ut?E.clip("evenodd"):E.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),E.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const f=(0,S.getCurrentTransform)(this.ctx);if(f[1]===0&&f[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(f[0]),Math.abs(f[3]));else{const p=Math.abs(f[0]*f[3]-f[2]*f[1]),E=Math.hypot(f[0],f[2]),U=Math.hypot(f[1],f[3]);this._cachedGetSinglePixelWidth=Math.max(E,U)/p}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:f}=this.current,p=(0,S.getCurrentTransform)(this.ctx);let E,U;if(p[1]===0&&p[2]===0){const O=Math.abs(p[0]),X=Math.abs(p[3]);if(f===0)E=1/O,U=1/X;else{const V=O*f,Q=X*f;E=V<1?1/V:1,U=Q<1?1/Q:1}}else{const O=Math.abs(p[0]*p[3]-p[2]*p[1]),X=Math.hypot(p[0],p[1]),V=Math.hypot(p[2],p[3]);if(f===0)E=V/O,U=X/O;else{const Q=f*O;E=V>Q?V/Q:1,U=X>Q?X/Q:1}}this._cachedScaleForStroking=[E,U]}return this._cachedScaleForStroking}rescaleAndStroke(f){const{ctx:p}=this,{lineWidth:E}=this.current,[U,O]=this.getScaleForStroking();if(p.lineWidth=E||1,U===1&&O===1){p.stroke();return}let X,V,Q;f&&(X=(0,S.getCurrentTransform)(p),V=p.getLineDash().slice(),Q=p.lineDashOffset),p.scale(U,O);const z=Math.max(U,O);p.setLineDash(p.getLineDash().map(j=>j/z)),p.lineDashOffset/=z,p.stroke(),f&&(p.setTransform(...X),p.setLineDash(V),p.lineDashOffset=Q)}isContentVisible(){for(let f=this.markedContentStack.length-1;f>=0;f--)if(!this.markedContentStack[f].visible)return!1;return!0}};let lt=yt;ft=new WeakSet,me=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},i.CanvasGraphics=lt;for(const G in l.OPS)lt.prototype[G]!==void 0&&(lt.prototype[l.OPS[G]]=lt.prototype[G])},(K,i,L)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TilingPattern=i.PathType=void 0,i.getShadingPattern=A;var l=L(1),S=L(6);const W={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};i.PathType=W;function N(s,r){if(!r)return;const k=r[2]-r[0],M=r[3]-r[1],v=new Path2D;v.rect(r[0],r[1],k,M),s.clip(v)}class J{constructor(){this.constructor===J&&(0,l.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,l.unreachable)("Abstract method `getPattern` called.")}}class R extends J{constructor(r){super(),this._type=r[1],this._bbox=r[2],this._colorStops=r[3],this._p0=r[4],this._p1=r[5],this._r0=r[6],this._r1=r[7],this.matrix=null}_createGradient(r){let k;this._type==="axial"?k=r.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(k=r.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const M of this._colorStops)k.addColorStop(M[0],M[1]);return k}getPattern(r,k,M,v){let t;if(v===W.STROKE||v===W.FILL){const c=k.current.getClippedPathBoundingBox(v,(0,S.getCurrentTransform)(r))||[0,0,0,0],o=Math.ceil(c[2]-c[0])||1,n=Math.ceil(c[3]-c[1])||1,u=k.cachedCanvases.getCanvas("pattern",o,n,!0),T=u.context;T.clearRect(0,0,T.canvas.width,T.canvas.height),T.beginPath(),T.rect(0,0,T.canvas.width,T.canvas.height),T.translate(-c[0],-c[1]),M=l.Util.transform(M,[1,0,0,1,c[0],c[1]]),T.transform(...k.baseTransform),this.matrix&&T.transform(...this.matrix),N(T,this._bbox),T.fillStyle=this._createGradient(T),T.fill(),t=r.createPattern(u.canvas,"no-repeat");const a=new DOMMatrix(M);t.setTransform(a)}else N(r,this._bbox),t=this._createGradient(r);return t}}function C(s,r,k,M,v,t,c,o){const n=r.coords,u=r.colors,T=s.data,a=s.width*4;let D;n[k+1]>n[M+1]&&(D=k,k=M,M=D,D=t,t=c,c=D),n[M+1]>n[v+1]&&(D=M,M=v,v=D,D=c,c=o,o=D),n[k+1]>n[M+1]&&(D=k,k=M,M=D,D=t,t=c,c=D);const $=(n[k]+r.offsetX)*r.scaleX,Y=(n[k+1]+r.offsetY)*r.scaleY,tt=(n[M]+r.offsetX)*r.scaleX,it=(n[M+1]+r.offsetY)*r.scaleY,ut=(n[v]+r.offsetX)*r.scaleX,lt=(n[v+1]+r.offsetY)*r.scaleY;if(Y>=lt)return;const ft=u[t],bt=u[t+1],yt=u[t+2],G=u[c],f=u[c+1],p=u[c+2],E=u[o],U=u[o+1],O=u[o+2],X=Math.round(Y),V=Math.round(lt);let Q,z,j,F,e,h,b,x;for(let I=X;I<=V;I++){if(I<it){let at;I<Y?at=0:at=(Y-I)/(Y-it),Q=$-($-tt)*at,z=ft-(ft-G)*at,j=bt-(bt-f)*at,F=yt-(yt-p)*at}else{let at;I>lt?at=1:it===lt?at=0:at=(it-I)/(it-lt),Q=tt-(tt-ut)*at,z=G-(G-E)*at,j=f-(f-U)*at,F=p-(p-O)*at}let B;I<Y?B=0:I>lt?B=1:B=(Y-I)/(Y-lt),e=$-($-ut)*B,h=ft-(ft-E)*B,b=bt-(bt-U)*B,x=yt-(yt-O)*B;const nt=Math.round(Math.min(Q,e)),st=Math.round(Math.max(Q,e));let rt=a*I+nt*4;for(let at=nt;at<=st;at++)B=(Q-at)/(Q-e),B<0?B=0:B>1&&(B=1),T[rt++]=z-(z-h)*B|0,T[rt++]=j-(j-b)*B|0,T[rt++]=F-(F-x)*B|0,T[rt++]=255}}function _(s,r,k){const M=r.coords,v=r.colors;let t,c;switch(r.type){case"lattice":const o=r.verticesPerRow,n=Math.floor(M.length/o)-1,u=o-1;for(t=0;t<n;t++){let T=t*o;for(let a=0;a<u;a++,T++)C(s,k,M[T],M[T+1],M[T+o],v[T],v[T+1],v[T+o]),C(s,k,M[T+o+1],M[T+1],M[T+o],v[T+o+1],v[T+1],v[T+o])}break;case"triangles":for(t=0,c=M.length;t<c;t+=3)C(s,k,M[t],M[t+1],M[t+2],v[t],v[t+1],v[t+2]);break;default:throw new Error("illegal figure")}}class w extends J{constructor(r){super(),this._coords=r[2],this._colors=r[3],this._figures=r[4],this._bounds=r[5],this._bbox=r[7],this._background=r[8],this.matrix=null}_createMeshCanvas(r,k,M){const o=Math.floor(this._bounds[0]),n=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-o,T=Math.ceil(this._bounds[3])-n,a=Math.min(Math.ceil(Math.abs(u*r[0]*1.1)),3e3),D=Math.min(Math.ceil(Math.abs(T*r[1]*1.1)),3e3),$=u/a,Y=T/D,tt={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-n,scaleX:1/$,scaleY:1/Y},it=a+2*2,ut=D+2*2,lt=M.getCanvas("mesh",it,ut,!1),ft=lt.context,bt=ft.createImageData(a,D);if(k){const G=bt.data;for(let f=0,p=G.length;f<p;f+=4)G[f]=k[0],G[f+1]=k[1],G[f+2]=k[2],G[f+3]=255}for(const G of this._figures)_(bt,G,tt);return ft.putImageData(bt,2,2),{canvas:lt.canvas,offsetX:o-2*$,offsetY:n-2*Y,scaleX:$,scaleY:Y}}getPattern(r,k,M,v){N(r,this._bbox);let t;if(v===W.SHADING)t=l.Util.singularValueDecompose2dScale((0,S.getCurrentTransform)(r));else if(t=l.Util.singularValueDecompose2dScale(k.baseTransform),this.matrix){const o=l.Util.singularValueDecompose2dScale(this.matrix);t=[t[0]*o[0],t[1]*o[1]]}const c=this._createMeshCanvas(t,v===W.SHADING?null:this._background,k.cachedCanvases);return v!==W.SHADING&&(r.setTransform(...k.baseTransform),this.matrix&&r.transform(...this.matrix)),r.translate(c.offsetX,c.offsetY),r.scale(c.scaleX,c.scaleY),r.createPattern(c.canvas,"no-repeat")}}class y extends J{getPattern(){return"hotpink"}}function A(s){switch(s[0]){case"RadialAxial":return new R(s);case"Mesh":return new w(s);case"Dummy":return new y}throw new Error(`Unknown IR type: ${s[0]}`)}const d={COLORED:1,UNCOLORED:2};class g{static get MAX_PATTERN_SIZE(){return(0,l.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(r,k,M,v,t){this.operatorList=r[2],this.matrix=r[3]||[1,0,0,1,0,0],this.bbox=r[4],this.xstep=r[5],this.ystep=r[6],this.paintType=r[7],this.tilingType=r[8],this.color=k,this.ctx=M,this.canvasGraphicsFactory=v,this.baseTransform=t}createPatternCanvas(r){const k=this.operatorList,M=this.bbox,v=this.xstep,t=this.ystep,c=this.paintType,o=this.tilingType,n=this.color,u=this.canvasGraphicsFactory;(0,l.info)("TilingType: "+o);const T=M[0],a=M[1],D=M[2],$=M[3],Y=l.Util.singularValueDecompose2dScale(this.matrix),tt=l.Util.singularValueDecompose2dScale(this.baseTransform),it=[Y[0]*tt[0],Y[1]*tt[1]],ut=this.getSizeAndScale(v,this.ctx.canvas.width,it[0]),lt=this.getSizeAndScale(t,this.ctx.canvas.height,it[1]),ft=r.cachedCanvases.getCanvas("pattern",ut.size,lt.size,!0),bt=ft.context,yt=u.createCanvasGraphics(bt);yt.groupLevel=r.groupLevel,this.setFillAndStrokeStyleToContext(yt,c,n);let G=T,f=a,p=D,E=$;return T<0&&(G=0,p+=Math.abs(T)),a<0&&(f=0,E+=Math.abs(a)),bt.translate(-(ut.scale*G),-(lt.scale*f)),yt.transform(ut.scale,0,0,lt.scale,0,0),bt.save(),this.clipBbox(yt,G,f,p,E),yt.baseTransform=(0,S.getCurrentTransform)(yt.ctx),yt.executeOperatorList(k),yt.endDrawing(),{canvas:ft.canvas,scaleX:ut.scale,scaleY:lt.scale,offsetX:G,offsetY:f}}getSizeAndScale(r,k,M){r=Math.abs(r);const v=Math.max(g.MAX_PATTERN_SIZE,k);let t=Math.ceil(r*M);return t>=v?t=v:M=t/r,{scale:M,size:t}}clipBbox(r,k,M,v,t){const c=v-k,o=t-M;r.ctx.rect(k,M,c,o),r.current.updateRectMinMax((0,S.getCurrentTransform)(r.ctx),[k,M,v,t]),r.clip(),r.endPath()}setFillAndStrokeStyleToContext(r,k,M){const v=r.ctx,t=r.current;switch(k){case d.COLORED:const c=this.ctx;v.fillStyle=c.fillStyle,v.strokeStyle=c.strokeStyle,t.fillColor=c.fillStyle,t.strokeColor=c.strokeStyle;break;case d.UNCOLORED:const o=l.Util.makeHexColor(M[0],M[1],M[2]);v.fillStyle=o,v.strokeStyle=o,t.fillColor=o,t.strokeColor=o;break;default:throw new l.FormatError(`Unsupported paint type: ${k}`)}}getPattern(r,k,M,v){let t=M;v!==W.SHADING&&(t=l.Util.transform(t,k.baseTransform),this.matrix&&(t=l.Util.transform(t,this.matrix)));const c=this.createPatternCanvas(k);let o=new DOMMatrix(t);o=o.translate(c.offsetX,c.offsetY),o=o.scale(1/c.scaleX,1/c.scaleY);const n=r.createPattern(c.canvas,"repeat");return n.setTransform(o),n}}i.TilingPattern=g},(K,i,L)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.convertBlackAndWhiteToRGBA=W,i.convertToRGBA=S,i.grayToRGBA=J;var l=L(1);function S(R){switch(R.kind){case l.ImageKind.GRAYSCALE_1BPP:return W(R);case l.ImageKind.RGB_24BPP:return N(R)}return null}function W({src:R,srcPos:C=0,dest:_,width:w,height:y,nonBlackColor:A=4294967295,inverseDecode:d=!1}){const g=l.FeatureTest.isLittleEndian?4278190080:255,[s,r]=d?[A,g]:[g,A],k=w>>3,M=w&7,v=R.length;_=new Uint32Array(_.buffer);let t=0;for(let c=0;c<y;c++){for(const n=C+k;C<n;C++){const u=C<v?R[C]:255;_[t++]=u&128?r:s,_[t++]=u&64?r:s,_[t++]=u&32?r:s,_[t++]=u&16?r:s,_[t++]=u&8?r:s,_[t++]=u&4?r:s,_[t++]=u&2?r:s,_[t++]=u&1?r:s}if(M===0)continue;const o=C<v?R[C++]:255;for(let n=0;n<M;n++)_[t++]=o&1<<7-n?r:s}return{srcPos:C,destPos:t}}function N({src:R,srcPos:C=0,dest:_,destPos:w=0,width:y,height:A}){let d=0;const g=R.length>>2,s=new Uint32Array(R.buffer,C,g);if(l.FeatureTest.isLittleEndian){for(;d<g-2;d+=3,w+=4){const r=s[d],k=s[d+1],M=s[d+2];_[w]=r|4278190080,_[w+1]=r>>>24|k<<8|4278190080,_[w+2]=k>>>16|M<<16|4278190080,_[w+3]=M>>>8|4278190080}for(let r=d*4,k=R.length;r<k;r+=3)_[w++]=R[r]|R[r+1]<<8|R[r+2]<<16|4278190080}else{for(;d<g-2;d+=3,w+=4){const r=s[d],k=s[d+1],M=s[d+2];_[w]=r|255,_[w+1]=r<<24|k>>>8|255,_[w+2]=k<<16|M>>>16|255,_[w+3]=M<<8|255}for(let r=d*4,k=R.length;r<k;r+=3)_[w++]=R[r]<<24|R[r+1]<<16|R[r+2]<<8|255}return{srcPos:C,destPos:w}}function J(R,C){if(l.FeatureTest.isLittleEndian)for(let _=0,w=R.length;_<w;_++)C[_]=R[_]*65793|4278190080;else for(let _=0,w=R.length;_<w;_++)C[_]=R[_]*16843008|255}},(K,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.GlobalWorkerOptions=void 0;const L=Object.create(null);i.GlobalWorkerOptions=L,L.workerPort=null,L.workerSrc=""},(K,i,L)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.MessageHandler=void 0;var l=L(1);const S={UNKNOWN:0,DATA:1,ERROR:2},W={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function N(R){switch(R instanceof Error||typeof R=="object"&&R!==null||(0,l.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),R.name){case"AbortException":return new l.AbortException(R.message);case"MissingPDFException":return new l.MissingPDFException(R.message);case"PasswordException":return new l.PasswordException(R.message,R.code);case"UnexpectedResponseException":return new l.UnexpectedResponseException(R.message,R.status);case"UnknownErrorException":return new l.UnknownErrorException(R.message,R.details);default:return new l.UnknownErrorException(R.message,R.toString())}}class J{constructor(C,_,w){this.sourceName=C,this.targetName=_,this.comObj=w,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=y=>{const A=y.data;if(A.targetName!==this.sourceName)return;if(A.stream){this._processStreamMessage(A);return}if(A.callback){const g=A.callbackId,s=this.callbackCapabilities[g];if(!s)throw new Error(`Cannot resolve callback ${g}`);if(delete this.callbackCapabilities[g],A.callback===S.DATA)s.resolve(A.data);else if(A.callback===S.ERROR)s.reject(N(A.reason));else throw new Error("Unexpected callback case");return}const d=this.actionHandler[A.action];if(!d)throw new Error(`Unknown action from worker: ${A.action}`);if(A.callbackId){const g=this.sourceName,s=A.sourceName;new Promise(function(r){r(d(A.data))}).then(function(r){w.postMessage({sourceName:g,targetName:s,callback:S.DATA,callbackId:A.callbackId,data:r})},function(r){w.postMessage({sourceName:g,targetName:s,callback:S.ERROR,callbackId:A.callbackId,reason:N(r)})});return}if(A.streamId){this._createStreamSink(A);return}d(A.data)},w.addEventListener("message",this._onComObjOnMessage)}on(C,_){const w=this.actionHandler;if(w[C])throw new Error(`There is already an actionName called "${C}"`);w[C]=_}send(C,_,w){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:C,data:_},w)}sendWithPromise(C,_,w){const y=this.callbackId++,A=(0,l.createPromiseCapability)();this.callbackCapabilities[y]=A;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:C,callbackId:y,data:_},w)}catch(d){A.reject(d)}return A.promise}sendWithStream(C,_,w,y){const A=this.streamId++,d=this.sourceName,g=this.targetName,s=this.comObj;return new ReadableStream({start:r=>{const k=(0,l.createPromiseCapability)();return this.streamControllers[A]={controller:r,startCall:k,pullCall:null,cancelCall:null,isClosed:!1},s.postMessage({sourceName:d,targetName:g,action:C,streamId:A,data:_,desiredSize:r.desiredSize},y),k.promise},pull:r=>{const k=(0,l.createPromiseCapability)();return this.streamControllers[A].pullCall=k,s.postMessage({sourceName:d,targetName:g,stream:W.PULL,streamId:A,desiredSize:r.desiredSize}),k.promise},cancel:r=>{(0,l.assert)(r instanceof Error,"cancel must have a valid reason");const k=(0,l.createPromiseCapability)();return this.streamControllers[A].cancelCall=k,this.streamControllers[A].isClosed=!0,s.postMessage({sourceName:d,targetName:g,stream:W.CANCEL,streamId:A,reason:N(r)}),k.promise}},w)}_createStreamSink(C){const _=C.streamId,w=this.sourceName,y=C.sourceName,A=this.comObj,d=this,g=this.actionHandler[C.action],s={enqueue(r,k=1,M){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=k,v>0&&this.desiredSize<=0&&(this.sinkCapability=(0,l.createPromiseCapability)(),this.ready=this.sinkCapability.promise),A.postMessage({sourceName:w,targetName:y,stream:W.ENQUEUE,streamId:_,chunk:r},M)},close(){this.isCancelled||(this.isCancelled=!0,A.postMessage({sourceName:w,targetName:y,stream:W.CLOSE,streamId:_}),delete d.streamSinks[_])},error(r){(0,l.assert)(r instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,A.postMessage({sourceName:w,targetName:y,stream:W.ERROR,streamId:_,reason:N(r)}))},sinkCapability:(0,l.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:C.desiredSize,ready:null};s.sinkCapability.resolve(),s.ready=s.sinkCapability.promise,this.streamSinks[_]=s,new Promise(function(r){r(g(C.data,s))}).then(function(){A.postMessage({sourceName:w,targetName:y,stream:W.START_COMPLETE,streamId:_,success:!0})},function(r){A.postMessage({sourceName:w,targetName:y,stream:W.START_COMPLETE,streamId:_,reason:N(r)})})}_processStreamMessage(C){const _=C.streamId,w=this.sourceName,y=C.sourceName,A=this.comObj,d=this.streamControllers[_],g=this.streamSinks[_];switch(C.stream){case W.START_COMPLETE:C.success?d.startCall.resolve():d.startCall.reject(N(C.reason));break;case W.PULL_COMPLETE:C.success?d.pullCall.resolve():d.pullCall.reject(N(C.reason));break;case W.PULL:if(!g){A.postMessage({sourceName:w,targetName:y,stream:W.PULL_COMPLETE,streamId:_,success:!0});break}g.desiredSize<=0&&C.desiredSize>0&&g.sinkCapability.resolve(),g.desiredSize=C.desiredSize,new Promise(function(s){s(g.onPull&&g.onPull())}).then(function(){A.postMessage({sourceName:w,targetName:y,stream:W.PULL_COMPLETE,streamId:_,success:!0})},function(s){A.postMessage({sourceName:w,targetName:y,stream:W.PULL_COMPLETE,streamId:_,reason:N(s)})});break;case W.ENQUEUE:if((0,l.assert)(d,"enqueue should have stream controller"),d.isClosed)break;d.controller.enqueue(C.chunk);break;case W.CLOSE:if((0,l.assert)(d,"close should have stream controller"),d.isClosed)break;d.isClosed=!0,d.controller.close(),this._deleteStreamController(d,_);break;case W.ERROR:(0,l.assert)(d,"error should have stream controller"),d.controller.error(N(C.reason)),this._deleteStreamController(d,_);break;case W.CANCEL_COMPLETE:C.success?d.cancelCall.resolve():d.cancelCall.reject(N(C.reason)),this._deleteStreamController(d,_);break;case W.CANCEL:if(!g)break;new Promise(function(s){s(g.onCancel&&g.onCancel(N(C.reason)))}).then(function(){A.postMessage({sourceName:w,targetName:y,stream:W.CANCEL_COMPLETE,streamId:_,success:!0})},function(s){A.postMessage({sourceName:w,targetName:y,stream:W.CANCEL_COMPLETE,streamId:_,reason:N(s)})}),g.sinkCapability.reject(N(C.reason)),g.isCancelled=!0,delete this.streamSinks[_];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(C,_){await Promise.allSettled([C.startCall&&C.startCall.promise,C.pullCall&&C.pullCall.promise,C.cancelCall&&C.cancelCall.promise]),delete this.streamControllers[_]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}i.MessageHandler=J},(K,i,L)=>{var W,N;Object.defineProperty(i,"__esModule",{value:!0}),i.Metadata=void 0;var l=L(1);class S{constructor({parsedData:R,rawData:C}){et(this,W,void 0);et(this,N,void 0);pt(this,W,R),pt(this,N,C)}getRaw(){return m(this,N)}get(R){return m(this,W).get(R)??null}getAll(){return(0,l.objectFromMap)(m(this,W))}has(R){return m(this,W).has(R)}}W=new WeakMap,N=new WeakMap,i.Metadata=S},(K,i,L)=>{var R,C,_,w,y,A,_e;Object.defineProperty(i,"__esModule",{value:!0}),i.OptionalContentConfig=void 0;var l=L(1),S=L(8);const W=Symbol("INTERNAL");class N{constructor(s,r){et(this,R,!0);this.name=s,this.intent=r}get visible(){return m(this,R)}_setVisible(s,r){s!==W&&(0,l.unreachable)("Internal method `_setVisible` called."),pt(this,R,r)}}R=new WeakMap;class J{constructor(s){et(this,A);et(this,C,null);et(this,_,new Map);et(this,w,null);et(this,y,null);if(this.name=null,this.creator=null,s!==null){this.name=s.name,this.creator=s.creator,pt(this,y,s.order);for(const r of s.groups)m(this,_).set(r.id,new N(r.name,r.intent));if(s.baseState==="OFF")for(const r of m(this,_).values())r._setVisible(W,!1);for(const r of s.on)m(this,_).get(r)._setVisible(W,!0);for(const r of s.off)m(this,_).get(r)._setVisible(W,!1);pt(this,w,this.getHash())}}isVisible(s){if(m(this,_).size===0)return!0;if(!s)return(0,l.warn)("Optional content group not defined."),!0;if(s.type==="OCG")return m(this,_).has(s.id)?m(this,_).get(s.id).visible:((0,l.warn)(`Optional content group not found: ${s.id}`),!0);if(s.type==="OCMD"){if(s.expression)return ot(this,A,_e).call(this,s.expression);if(!s.policy||s.policy==="AnyOn"){for(const r of s.ids){if(!m(this,_).has(r))return(0,l.warn)(`Optional content group not found: ${r}`),!0;if(m(this,_).get(r).visible)return!0}return!1}else if(s.policy==="AllOn"){for(const r of s.ids){if(!m(this,_).has(r))return(0,l.warn)(`Optional content group not found: ${r}`),!0;if(!m(this,_).get(r).visible)return!1}return!0}else if(s.policy==="AnyOff"){for(const r of s.ids){if(!m(this,_).has(r))return(0,l.warn)(`Optional content group not found: ${r}`),!0;if(!m(this,_).get(r).visible)return!0}return!1}else if(s.policy==="AllOff"){for(const r of s.ids){if(!m(this,_).has(r))return(0,l.warn)(`Optional content group not found: ${r}`),!0;if(m(this,_).get(r).visible)return!1}return!0}return(0,l.warn)(`Unknown optional content policy ${s.policy}.`),!0}return(0,l.warn)(`Unknown group type ${s.type}.`),!0}setVisibility(s,r=!0){if(!m(this,_).has(s)){(0,l.warn)(`Optional content group not found: ${s}`);return}m(this,_).get(s)._setVisible(W,!!r),pt(this,C,null)}get hasInitialVisibility(){return this.getHash()===m(this,w)}getOrder(){return m(this,_).size?m(this,y)?m(this,y).slice():[...m(this,_).keys()]:null}getGroups(){return m(this,_).size>0?(0,l.objectFromMap)(m(this,_)):null}getGroup(s){return m(this,_).get(s)||null}getHash(){if(m(this,C)!==null)return m(this,C);const s=new S.MurmurHash3_64;for(const[r,k]of m(this,_))s.update(`${r}:${k.visible}`);return pt(this,C,s.hexdigest())}}C=new WeakMap,_=new WeakMap,w=new WeakMap,y=new WeakMap,A=new WeakSet,_e=function(s){const r=s.length;if(r<2)return!0;const k=s[0];for(let M=1;M<r;M++){const v=s[M];let t;if(Array.isArray(v))t=ot(this,A,_e).call(this,v);else if(m(this,_).has(v))t=m(this,_).get(v).visible;else return(0,l.warn)(`Optional content group not found: ${v}`),!0;switch(k){case"And":if(!t)return!1;break;case"Or":if(t)return!0;break;case"Not":return!t;default:return!0}}return k==="And"},i.OptionalContentConfig=J},(K,i,L)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFDataTransportStream=void 0;var l=L(1),S=L(6);class W{constructor({length:C,initialData:_,progressiveDone:w=!1,contentDispositionFilename:y=null,disableRange:A=!1,disableStream:d=!1},g){if((0,l.assert)(g,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=w,this._contentDispositionFilename=y,(_==null?void 0:_.length)>0){const s=_ instanceof Uint8Array&&_.byteLength===_.buffer.byteLength?_.buffer:new Uint8Array(_).buffer;this._queuedChunks.push(s)}this._pdfDataRangeTransport=g,this._isStreamingSupported=!d,this._isRangeSupported=!A,this._contentLength=C,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((s,r)=>{this._onReceiveData({begin:s,chunk:r})}),this._pdfDataRangeTransport.addProgressListener((s,r)=>{this._onProgress({loaded:s,total:r})}),this._pdfDataRangeTransport.addProgressiveReadListener(s=>{this._onReceiveData({chunk:s})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:C,chunk:_}){const w=_ instanceof Uint8Array&&_.byteLength===_.buffer.byteLength?_.buffer:new Uint8Array(_).buffer;if(C===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(w):this._queuedChunks.push(w);else{const y=this._rangeReaders.some(function(A){return A._begin!==C?!1:(A._enqueue(w),!0)});(0,l.assert)(y,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var C;return((C=this._fullRequestReader)==null?void 0:C._loaded)??0}_onProgress(C){var _,w,y,A;C.total===void 0?(w=(_=this._rangeReaders[0])==null?void 0:_.onProgress)==null||w.call(_,{loaded:C.loaded}):(A=(y=this._fullRequestReader)==null?void 0:y.onProgress)==null||A.call(y,{loaded:C.loaded,total:C.total})}_onProgressiveDone(){var C;(C=this._fullRequestReader)==null||C.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(C){const _=this._rangeReaders.indexOf(C);_>=0&&this._rangeReaders.splice(_,1)}getFullReader(){(0,l.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const C=this._queuedChunks;return this._queuedChunks=null,new N(this,C,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(C,_){if(_<=this._progressiveDataLength)return null;const w=new J(this,C,_);return this._pdfDataRangeTransport.requestDataRange(C,_),this._rangeReaders.push(w),w}cancelAllRequests(C){var _;(_=this._fullRequestReader)==null||_.cancel(C);for(const w of this._rangeReaders.slice(0))w.cancel(C);this._pdfDataRangeTransport.abort()}}i.PDFDataTransportStream=W;class N{constructor(C,_,w=!1,y=null){this._stream=C,this._done=w||!1,this._filename=(0,S.isPdfFile)(y)?y:null,this._queuedChunks=_||[],this._loaded=0;for(const A of this._queuedChunks)this._loaded+=A.byteLength;this._requests=[],this._headersReady=Promise.resolve(),C._fullRequestReader=this,this.onProgress=null}_enqueue(C){this._done||(this._requests.length>0?this._requests.shift().resolve({value:C,done:!1}):this._queuedChunks.push(C),this._loaded+=C.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const C=(0,l.createPromiseCapability)();return this._requests.push(C),C.promise}cancel(C){this._done=!0;for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class J{constructor(C,_,w){this._stream=C,this._begin=_,this._end=w,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(C){if(!this._done){if(this._requests.length===0)this._queuedChunk=C;else{this._requests.shift().resolve({value:C,done:!1});for(const w of this._requests)w.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const _=this._queuedChunk;return this._queuedChunk=null,{value:_,done:!1}}if(this._done)return{value:void 0,done:!0};const C=(0,l.createPromiseCapability)();return this._requests.push(C),C.promise}cancel(C){this._done=!0;for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(K,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.XfaText=void 0;class L{static textContent(S){const W=[],N={items:W,styles:Object.create(null)};function J(R){var w;if(!R)return;let C=null;const _=R.name;if(_==="#text")C=R.value;else if(L.shouldBuildText(_))(w=R==null?void 0:R.attributes)!=null&&w.textContent?C=R.attributes.textContent:R.value&&(C=R.value);else return;if(C!==null&&W.push({str:C}),!!R.children)for(const y of R.children)J(y)}return J(S),N}static shouldBuildText(S){return!(S==="textarea"||S==="input"||S==="option"||S==="select")}}i.XfaText=L},(K,i,L)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.NodeStandardFontDataFactory=i.NodeFilterFactory=i.NodeCanvasFactory=i.NodeCMapReaderFactory=void 0;var l=L(7);const S=function(C){return new Promise((_,w)=>{require$$5.readFile(C,(A,d)=>{if(A||!d){w(new Error(A));return}_(new Uint8Array(d))})})};class W extends l.BaseFilterFactory{}i.NodeFilterFactory=W;class N extends l.BaseCanvasFactory{_createCanvas(_,w){return require$$5.createCanvas(_,w)}}i.NodeCanvasFactory=N;class J extends l.BaseCMapReaderFactory{_fetchData(_,w){return S(_).then(y=>({cMapData:y,compressionType:w}))}}i.NodeCMapReaderFactory=J;class R extends l.BaseStandardFontDataFactory{_fetchData(_){return S(_)}}i.NodeStandardFontDataFactory=R},(K,i,L)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFNodeStream=void 0;var l=L(1),S=L(22);const W=require$$5,N=require$$5,J=require$$5,R=require$$5,C=/^file:\/\/\/[a-zA-Z]:\//;function _(M){const v=R.parse(M);return v.protocol==="file:"||v.host?v:/^[a-z]:[/\\]/i.test(M)?R.parse(`file:///${M}`):(v.host||(v.protocol="file:"),v)}class w{constructor(v){this.source=v,this.url=_(v.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&v.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var v;return((v=this._fullRequestReader)==null?void 0:v._loaded)??0}getFullReader(){return(0,l.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new r(this):new g(this),this._fullRequestReader}getRangeReader(v,t){if(t<=this._progressiveDataLength)return null;const c=this.isFsUrl?new k(this,v,t):new s(this,v,t);return this._rangeRequestReaders.push(c),c}cancelAllRequests(v){var t;(t=this._fullRequestReader)==null||t.cancel(v);for(const c of this._rangeRequestReaders.slice(0))c.cancel(v)}}i.PDFNodeStream=w;class y{constructor(v){this._url=v.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=v.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=(0,l.createPromiseCapability)(),this._headersCapability=(0,l.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var c;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const v=this._readableStream.read();return v===null?(this._readCapability=(0,l.createPromiseCapability)(),this.read()):(this._loaded+=v.length,(c=this.onProgress)==null||c.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(v).buffer,done:!1})}cancel(v){if(!this._readableStream){this._error(v);return}this._readableStream.destroy(v)}_error(v){this._storedError=v,this._readCapability.resolve()}_setReadableStream(v){this._readableStream=v,v.on("readable",()=>{this._readCapability.resolve()}),v.on("end",()=>{v.destroy(),this._done=!0,this._readCapability.resolve()}),v.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new l.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class A{constructor(v){this._url=v.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,l.createPromiseCapability)();const t=v.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var c;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const v=this._readableStream.read();return v===null?(this._readCapability=(0,l.createPromiseCapability)(),this.read()):(this._loaded+=v.length,(c=this.onProgress)==null||c.call(this,{loaded:this._loaded}),{value:new Uint8Array(v).buffer,done:!1})}cancel(v){if(!this._readableStream){this._error(v);return}this._readableStream.destroy(v)}_error(v){this._storedError=v,this._readCapability.resolve()}_setReadableStream(v){this._readableStream=v,v.on("readable",()=>{this._readCapability.resolve()}),v.on("end",()=>{v.destroy(),this._done=!0,this._readCapability.resolve()}),v.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function d(M,v){return{protocol:M.protocol,auth:M.auth,host:M.hostname,port:M.port,path:M.path,method:"GET",headers:v}}class g extends y{constructor(v){super(v);const t=c=>{if(c.statusCode===404){const T=new l.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=T,this._headersCapability.reject(T);return}this._headersCapability.resolve(),this._setReadableStream(c);const o=T=>this._readableStream.headers[T.toLowerCase()],{allowRangeRequests:n,suggestedLength:u}=(0,S.validateRangeRequestCapabilities)({getResponseHeader:o,isHttp:v.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=n,this._contentLength=u||this._contentLength,this._filename=(0,S.extractFilenameFromHeader)(o)};this._request=null,this._url.protocol==="http:"?this._request=N.request(d(this._url,v.httpHeaders),t):this._request=J.request(d(this._url,v.httpHeaders),t),this._request.on("error",c=>{this._storedError=c,this._headersCapability.reject(c)}),this._request.end()}}class s extends A{constructor(v,t,c){super(v),this._httpHeaders={};for(const n in v.httpHeaders){const u=v.httpHeaders[n];u!==void 0&&(this._httpHeaders[n]=u)}this._httpHeaders.Range=`bytes=${t}-${c-1}`;const o=n=>{if(n.statusCode===404){const u=new l.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=u;return}this._setReadableStream(n)};this._request=null,this._url.protocol==="http:"?this._request=N.request(d(this._url,this._httpHeaders),o):this._request=J.request(d(this._url,this._httpHeaders),o),this._request.on("error",n=>{this._storedError=n}),this._request.end()}}class r extends y{constructor(v){super(v);let t=decodeURIComponent(this._url.path);C.test(this._url.href)&&(t=t.replace(/^\//,"")),W.lstat(t,(c,o)=>{if(c){c.code==="ENOENT"&&(c=new l.MissingPDFException(`Missing PDF "${t}".`)),this._storedError=c,this._headersCapability.reject(c);return}this._contentLength=o.size,this._setReadableStream(W.createReadStream(t)),this._headersCapability.resolve()})}}class k extends A{constructor(v,t,c){super(v);let o=decodeURIComponent(this._url.path);C.test(this._url.href)&&(o=o.replace(/^\//,"")),this._setReadableStream(W.createReadStream(o,{start:t,end:c-1}))}}},(K,i,L)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.createResponseStatusError=R,i.extractFilenameFromHeader=J,i.validateRangeRequestCapabilities=N,i.validateResponseStatus=C;var l=L(1),S=L(23),W=L(6);function N({getResponseHeader:_,isHttp:w,rangeChunkSize:y,disableRange:A}){const d={allowRangeRequests:!1,suggestedLength:void 0},g=parseInt(_("Content-Length"),10);return!Number.isInteger(g)||(d.suggestedLength=g,g<=2*y)||A||!w||_("Accept-Ranges")!=="bytes"||(_("Content-Encoding")||"identity")!=="identity"||(d.allowRangeRequests=!0),d}function J(_){const w=_("Content-Disposition");if(w){let y=(0,S.getFilenameFromContentDispositionHeader)(w);if(y.includes("%"))try{y=decodeURIComponent(y)}catch{}if((0,W.isPdfFile)(y))return y}return null}function R(_,w){return _===404||_===0&&w.startsWith("file:")?new l.MissingPDFException('Missing PDF "'+w+'".'):new l.UnexpectedResponseException(`Unexpected server response (${_}) while retrieving PDF "${w}".`,_)}function C(_){return _===200||_===206}},(K,i,L)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.getFilenameFromContentDispositionHeader=S;var l=L(1);function S(W){let N=!0,J=R("filename\\*","i").exec(W);if(J){J=J[1];let g=y(J);return g=unescape(g),g=A(g),g=d(g),_(g)}if(J=w(W),J){const g=d(J);return _(g)}if(J=R("filename","i").exec(W),J){J=J[1];let g=y(J);return g=d(g),_(g)}function R(g,s){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',s)}function C(g,s){if(g){if(!/^[\x00-\xFF]+$/.test(s))return s;try{const r=new TextDecoder(g,{fatal:!0}),k=(0,l.stringToBytes)(s);s=r.decode(k),N=!1}catch{}}return s}function _(g){return N&&/[\x80-\xff]/.test(g)&&(g=C("utf-8",g),N&&(g=C("iso-8859-1",g))),g}function w(g){const s=[];let r;const k=R("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(r=k.exec(g))!==null;){let[,v,t,c]=r;if(v=parseInt(v,10),v in s){if(v===0)break;continue}s[v]=[t,c]}const M=[];for(let v=0;v<s.length&&v in s;++v){let[t,c]=s[v];c=y(c),t&&(c=unescape(c),v===0&&(c=A(c))),M.push(c)}return M.join("")}function y(g){if(g.startsWith('"')){const s=g.slice(1).split('\\"');for(let r=0;r<s.length;++r){const k=s[r].indexOf('"');k!==-1&&(s[r]=s[r].slice(0,k),s.length=r+1),s[r]=s[r].replaceAll(/\\(.)/g,"$1")}g=s.join('"')}return g}function A(g){const s=g.indexOf("'");if(s===-1)return g;const r=g.slice(0,s),M=g.slice(s+1).replace(/^[^']*'/,"");return C(r,M)}function d(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(s,r,k,M){if(k==="q"||k==="Q")return M=M.replaceAll("_"," "),M=M.replaceAll(/=([0-9a-fA-F]{2})/g,function(v,t){return String.fromCharCode(parseInt(t,16))}),C(r,M);try{M=atob(M)}catch{}return C(r,M)})}return""}},(K,i,L)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFNetworkStream=void 0;var l=L(1),S=L(22);const W=200,N=206;function J(y){const A=y.response;return typeof A!="string"?A:(0,l.stringToBytes)(A).buffer}class R{constructor(A,d={}){this.url=A,this.isHttp=/^https?:/i.test(A),this.httpHeaders=this.isHttp&&d.httpHeaders||Object.create(null),this.withCredentials=d.withCredentials||!1,this.getXhr=d.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(A,d,g){const s={begin:A,end:d};for(const r in g)s[r]=g[r];return this.request(s)}requestFull(A){return this.request(A)}request(A){const d=this.getXhr(),g=this.currXhrId++,s=this.pendingRequests[g]={xhr:d};d.open("GET",this.url),d.withCredentials=this.withCredentials;for(const r in this.httpHeaders){const k=this.httpHeaders[r];k!==void 0&&d.setRequestHeader(r,k)}return this.isHttp&&"begin"in A&&"end"in A?(d.setRequestHeader("Range",`bytes=${A.begin}-${A.end-1}`),s.expectedStatus=N):s.expectedStatus=W,d.responseType="arraybuffer",A.onError&&(d.onerror=function(r){A.onError(d.status)}),d.onreadystatechange=this.onStateChange.bind(this,g),d.onprogress=this.onProgress.bind(this,g),s.onHeadersReceived=A.onHeadersReceived,s.onDone=A.onDone,s.onError=A.onError,s.onProgress=A.onProgress,d.send(null),g}onProgress(A,d){var s;const g=this.pendingRequests[A];g&&((s=g.onProgress)==null||s.call(g,d))}onStateChange(A,d){var v,t,c;const g=this.pendingRequests[A];if(!g)return;const s=g.xhr;if(s.readyState>=2&&g.onHeadersReceived&&(g.onHeadersReceived(),delete g.onHeadersReceived),s.readyState!==4||!(A in this.pendingRequests))return;if(delete this.pendingRequests[A],s.status===0&&this.isHttp){(v=g.onError)==null||v.call(g,s.status);return}const r=s.status||W;if(!(r===W&&g.expectedStatus===N)&&r!==g.expectedStatus){(t=g.onError)==null||t.call(g,s.status);return}const M=J(s);if(r===N){const o=s.getResponseHeader("Content-Range"),n=/bytes (\d+)-(\d+)\/(\d+)/.exec(o);g.onDone({begin:parseInt(n[1],10),chunk:M})}else M?g.onDone({begin:0,chunk:M}):(c=g.onError)==null||c.call(g,s.status)}getRequestXhr(A){return this.pendingRequests[A].xhr}isPendingRequest(A){return A in this.pendingRequests}abortRequest(A){const d=this.pendingRequests[A].xhr;delete this.pendingRequests[A],d.abort()}}class C{constructor(A){this._source=A,this._manager=new R(A.url,{httpHeaders:A.httpHeaders,withCredentials:A.withCredentials}),this._rangeChunkSize=A.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(A){const d=this._rangeRequestReaders.indexOf(A);d>=0&&this._rangeRequestReaders.splice(d,1)}getFullReader(){return(0,l.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new _(this._manager,this._source),this._fullRequestReader}getRangeReader(A,d){const g=new w(this._manager,A,d);return g.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(g),g}cancelAllRequests(A){var d;(d=this._fullRequestReader)==null||d.cancel(A);for(const g of this._rangeRequestReaders.slice(0))g.cancel(A)}}i.PDFNetworkStream=C;class _{constructor(A,d){this._manager=A;const g={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=d.url,this._fullRequestId=A.requestFull(g),this._headersReceivedCapability=(0,l.createPromiseCapability)(),this._disableRange=d.disableRange||!1,this._contentLength=d.length,this._rangeChunkSize=d.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const A=this._fullRequestId,d=this._manager.getRequestXhr(A),g=k=>d.getResponseHeader(k),{allowRangeRequests:s,suggestedLength:r}=(0,S.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=r||this._contentLength,this._filename=(0,S.extractFilenameFromHeader)(g),this._isRangeSupported&&this._manager.abortRequest(A),this._headersReceivedCapability.resolve()}_onDone(A){if(A&&(this._requests.length>0?this._requests.shift().resolve({value:A.chunk,done:!1}):this._cachedChunks.push(A.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(A){this._storedError=(0,S.createResponseStatusError)(A,this._url),this._headersReceivedCapability.reject(this._storedError);for(const d of this._requests)d.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(A){var d;(d=this.onProgress)==null||d.call(this,{loaded:A.loaded,total:A.lengthComputable?A.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const A=(0,l.createPromiseCapability)();return this._requests.push(A),A.promise}cancel(A){this._done=!0,this._headersReceivedCapability.reject(A);for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class w{constructor(A,d,g){this._manager=A;const s={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=A.url,this._requestId=A.requestRange(d,g,s),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var A;(A=this.onClosed)==null||A.call(this,this)}_onDone(A){const d=A.chunk;this._requests.length>0?this._requests.shift().resolve({value:d,done:!1}):this._queuedChunk=d,this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(A){this._storedError=(0,S.createResponseStatusError)(A,this._url);for(const d of this._requests)d.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(A){var d;this.isStreamingSupported||(d=this.onProgress)==null||d.call(this,{loaded:A.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const d=this._queuedChunk;return this._queuedChunk=null,{value:d,done:!1}}if(this._done)return{value:void 0,done:!0};const A=(0,l.createPromiseCapability)();return this._requests.push(A),A.promise}cancel(A){this._done=!0;for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(K,i,L)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.PDFFetchStream=void 0;var l=L(1),S=L(22);function W(w,y,A){return{method:"GET",headers:w,signal:A.signal,mode:"cors",credentials:y?"include":"same-origin",redirect:"follow"}}function N(w){const y=new Headers;for(const A in w){const d=w[A];d!==void 0&&y.append(A,d)}return y}function J(w){return w instanceof Uint8Array?w.buffer:w instanceof ArrayBuffer?w:((0,l.warn)(`getArrayBuffer - unexpected data format: ${w}`),new Uint8Array(w).buffer)}class R{constructor(y){this.source=y,this.isHttp=/^https?:/i.test(y.url),this.httpHeaders=this.isHttp&&y.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var y;return((y=this._fullRequestReader)==null?void 0:y._loaded)??0}getFullReader(){return(0,l.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new C(this),this._fullRequestReader}getRangeReader(y,A){if(A<=this._progressiveDataLength)return null;const d=new _(this,y,A);return this._rangeRequestReaders.push(d),d}cancelAllRequests(y){var A;(A=this._fullRequestReader)==null||A.cancel(y);for(const d of this._rangeRequestReaders.slice(0))d.cancel(y)}}i.PDFFetchStream=R;class C{constructor(y){this._stream=y,this._reader=null,this._loaded=0,this._filename=null;const A=y.source;this._withCredentials=A.withCredentials||!1,this._contentLength=A.length,this._headersCapability=(0,l.createPromiseCapability)(),this._disableRange=A.disableRange||!1,this._rangeChunkSize=A.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!A.disableStream,this._isRangeSupported=!A.disableRange,this._headers=N(this._stream.httpHeaders);const d=A.url;fetch(d,W(this._headers,this._withCredentials,this._abortController)).then(g=>{if(!(0,S.validateResponseStatus)(g.status))throw(0,S.createResponseStatusError)(g.status,d);this._reader=g.body.getReader(),this._headersCapability.resolve();const s=M=>g.headers.get(M),{allowRangeRequests:r,suggestedLength:k}=(0,S.validateRangeRequestCapabilities)({getResponseHeader:s,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=r,this._contentLength=k||this._contentLength,this._filename=(0,S.extractFilenameFromHeader)(s),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new l.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var d;await this._headersCapability.promise;const{value:y,done:A}=await this._reader.read();return A?{value:y,done:A}:(this._loaded+=y.byteLength,(d=this.onProgress)==null||d.call(this,{loaded:this._loaded,total:this._contentLength}),{value:J(y),done:!1})}cancel(y){var A;(A=this._reader)==null||A.cancel(y),this._abortController.abort()}}class _{constructor(y,A,d){this._stream=y,this._reader=null,this._loaded=0;const g=y.source;this._withCredentials=g.withCredentials||!1,this._readCapability=(0,l.createPromiseCapability)(),this._isStreamingSupported=!g.disableStream,this._abortController=new AbortController,this._headers=N(this._stream.httpHeaders),this._headers.append("Range",`bytes=${A}-${d-1}`);const s=g.url;fetch(s,W(this._headers,this._withCredentials,this._abortController)).then(r=>{if(!(0,S.validateResponseStatus)(r.status))throw(0,S.createResponseStatusError)(r.status,s);this._readCapability.resolve(),this._reader=r.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var d;await this._readCapability.promise;const{value:y,done:A}=await this._reader.read();return A?{value:y,done:A}:(this._loaded+=y.byteLength,(d=this.onProgress)==null||d.call(this,{loaded:this._loaded}),{value:J(y),done:!1})}cancel(y){var A;(A=this._reader)==null||A.cancel(y),this._abortController.abort()}}},(K,i,L)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TextLayerRenderTask=void 0,i.renderTextLayer=g,i.updateTextLayer=s;var l=L(1),S=L(6);const W=1e5,N=30,J=.8,R=new Map;function C(r,k){let M;if(k&&l.FeatureTest.isOffscreenCanvasSupported)M=new OffscreenCanvas(r,r).getContext("2d",{alpha:!1});else{const v=document.createElement("canvas");v.width=v.height=r,M=v.getContext("2d",{alpha:!1})}return M}function _(r,k){const M=R.get(r);if(M)return M;const v=C(N,k);v.font=`${N}px ${r}`;const t=v.measureText("");let c=t.fontBoundingBoxAscent,o=Math.abs(t.fontBoundingBoxDescent);if(c){const u=c/(c+o);return R.set(r,u),v.canvas.width=v.canvas.height=0,u}v.strokeStyle="red",v.clearRect(0,0,N,N),v.strokeText("g",0,0);let n=v.getImageData(0,0,N,N).data;o=0;for(let u=n.length-1-3;u>=0;u-=4)if(n[u]>0){o=Math.ceil(u/4/N);break}v.clearRect(0,0,N,N),v.strokeText("A",0,N),n=v.getImageData(0,0,N,N).data,c=0;for(let u=0,T=n.length;u<T;u+=4)if(n[u]>0){c=N-Math.floor(u/4/N);break}if(v.canvas.width=v.canvas.height=0,c){const u=c/(c+o);return R.set(r,u),u}return R.set(r,J),J}function w(r,k,M){const v=document.createElement("span"),t={angle:0,canvasWidth:0,hasText:k.str!=="",hasEOL:k.hasEOL,fontSize:0};r._textDivs.push(v);const c=l.Util.transform(r._transform,k.transform);let o=Math.atan2(c[1],c[0]);const n=M[k.fontName];n.vertical&&(o+=Math.PI/2);const u=Math.hypot(c[2],c[3]),T=u*_(n.fontFamily,r._isOffscreenCanvasSupported);let a,D;o===0?(a=c[4],D=c[5]-T):(a=c[4]+T*Math.sin(o),D=c[5]-T*Math.cos(o));const $="calc(var(--scale-factor)*",Y=v.style;r._container===r._rootContainer?(Y.left=`${(100*a/r._pageWidth).toFixed(2)}%`,Y.top=`${(100*D/r._pageHeight).toFixed(2)}%`):(Y.left=`${$}${a.toFixed(2)}px)`,Y.top=`${$}${D.toFixed(2)}px)`),Y.fontSize=`${$}${u.toFixed(2)}px)`,Y.fontFamily=n.fontFamily,t.fontSize=u,v.setAttribute("role","presentation"),v.textContent=k.str,v.dir=k.dir,r._fontInspectorEnabled&&(v.dataset.fontName=k.fontName),o!==0&&(t.angle=o*(180/Math.PI));let tt=!1;if(k.str.length>1)tt=!0;else if(k.str!==" "&&k.transform[0]!==k.transform[3]){const it=Math.abs(k.transform[0]),ut=Math.abs(k.transform[3]);it!==ut&&Math.max(it,ut)/Math.min(it,ut)>1.5&&(tt=!0)}tt&&(t.canvasWidth=n.vertical?k.height:k.width),r._textDivProperties.set(v,t),r._isReadableStream&&r._layoutText(v)}function y(r){const{div:k,scale:M,properties:v,ctx:t,prevFontSize:c,prevFontFamily:o}=r,{style:n}=k;let u="";if(v.canvasWidth!==0&&v.hasText){const{fontFamily:T}=n,{canvasWidth:a,fontSize:D}=v;(c!==D||o!==T)&&(t.font=`${D*M}px ${T}`,r.prevFontSize=D,r.prevFontFamily=T);const{width:$}=t.measureText(k.textContent);$>0&&(u=`scaleX(${a*M/$})`)}v.angle!==0&&(u=`rotate(${v.angle}deg) ${u}`),u.length>0&&(n.transform=u)}function A(r){if(r._canceled)return;const k=r._textDivs,M=r._capability;if(k.length>W){M.resolve();return}if(!r._isReadableStream)for(const t of k)r._layoutText(t);M.resolve()}class d{constructor({textContentSource:k,container:M,viewport:v,textDivs:t,textDivProperties:c,textContentItemsStr:o,isOffscreenCanvasSupported:n}){var $;this._textContentSource=k,this._isReadableStream=k instanceof ReadableStream,this._container=this._rootContainer=M,this._textDivs=t||[],this._textContentItemsStr=o||[],this._isOffscreenCanvasSupported=n,this._fontInspectorEnabled=!!(($=globalThis.FontInspector)!=null&&$.enabled),this._reader=null,this._textDivProperties=c||new WeakMap,this._canceled=!1,this._capability=(0,l.createPromiseCapability)(),this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:v.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:C(0,n)};const{pageWidth:u,pageHeight:T,pageX:a,pageY:D}=v.rawDims;this._transform=[1,0,0,-1,-a,D+T],this._pageWidth=u,this._pageHeight=T,(0,S.setLayerDimensions)(M,v),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new l.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new l.AbortException("TextLayer task cancelled."))}_processItems(k,M){for(const v of k){if(v.str===void 0){if(v.type==="beginMarkedContentProps"||v.type==="beginMarkedContent"){const t=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),v.id!==null&&this._container.setAttribute("id",`${v.id}`),t.append(this._container)}else v.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(v.str),w(this,v,M)}}_layoutText(k){const M=this._layoutTextParams.properties=this._textDivProperties.get(k);if(this._layoutTextParams.div=k,y(this._layoutTextParams),M.hasText&&this._container.append(k),M.hasEOL){const v=document.createElement("br");v.setAttribute("role","presentation"),this._container.append(v)}}_render(){const k=(0,l.createPromiseCapability)();let M=Object.create(null);if(this._isReadableStream){const v=()=>{this._reader.read().then(({value:t,done:c})=>{if(c){k.resolve();return}Object.assign(M,t.styles),this._processItems(t.items,M),v()},k.reject)};this._reader=this._textContentSource.getReader(),v()}else if(this._textContentSource){const{items:v,styles:t}=this._textContentSource;this._processItems(v,t),k.resolve()}else throw new Error('No "textContentSource" parameter specified.');k.promise.then(()=>{M=null,A(this)},this._capability.reject)}}i.TextLayerRenderTask=d;function g(r){!r.textContentSource&&(r.textContent||r.textContentStream)&&((0,S.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),r.textContentSource=r.textContent||r.textContentStream);const{container:k,viewport:M}=r,v=getComputedStyle(k),t=v.getPropertyValue("visibility"),c=parseFloat(v.getPropertyValue("--scale-factor"));t==="visible"&&(!c||Math.abs(c-M.scale)>1e-15)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const o=new d(r);return o._render(),o}function s({container:r,viewport:k,textDivs:M,textDivProperties:v,isOffscreenCanvasSupported:t,mustRotate:c=!0,mustRescale:o=!0}){if(c&&(0,S.setLayerDimensions)(r,{rotation:k.rotation}),o){const n=C(0,t),T={prevFontSize:null,prevFontFamily:null,div:null,scale:k.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:n};for(const a of M)T.properties=v.get(a),T.div=a,y(T)}}},(K,i,L)=>{var C,_,w,y,A,d,g,s,r,be,M,Be,t,Ae,o,ye;Object.defineProperty(i,"__esModule",{value:!0}),i.AnnotationEditorLayer=void 0;var l=L(1),S=L(5),W=L(28),N=L(29),J=L(6);const u=class{constructor(a){et(this,r);et(this,M);et(this,t);et(this,o);et(this,C,void 0);et(this,_,!1);et(this,w,this.pointerup.bind(this));et(this,y,this.pointerdown.bind(this));et(this,A,new Map);et(this,d,!1);et(this,g,!1);et(this,s,void 0);u._initialized||(u._initialized=!0,W.FreeTextEditor.initialize(a.l10n),N.InkEditor.initialize(a.l10n)),a.uiManager.registerEditorTypes([W.FreeTextEditor,N.InkEditor]),pt(this,s,a.uiManager),this.pageIndex=a.pageIndex,this.div=a.div,pt(this,C,a.accessibilityManager),m(this,s).addLayer(this)}get isEmpty(){return m(this,A).size===0}updateToolbar(a){m(this,s).updateToolbar(a)}updateMode(a=m(this,s).getMode()){ot(this,o,ye).call(this),a===l.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),m(this,s).unselectAll(),a!==l.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",a===l.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",a===l.AnnotationEditorType.INK),this.div.hidden=!1)}addInkEditorIfNeeded(a){if(!a&&m(this,s).getMode()!==l.AnnotationEditorType.INK)return;if(!a){for(const $ of m(this,A).values())if($.isEmpty()){$.setInBackground();return}}ot(this,t,Ae).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(a){m(this,s).setEditingState(a)}addCommands(a){m(this,s).addCommands(a)}enable(){this.div.style.pointerEvents="auto";for(const a of m(this,A).values())a.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const a of m(this,A).values())a.disableEditing();ot(this,o,ye).call(this),this.isEmpty&&(this.div.hidden=!0)}setActiveEditor(a){m(this,s).getActive()!==a&&m(this,s).setActiveEditor(a)}enableClick(){this.div.addEventListener("pointerdown",m(this,y)),this.div.addEventListener("pointerup",m(this,w))}disableClick(){this.div.removeEventListener("pointerdown",m(this,y)),this.div.removeEventListener("pointerup",m(this,w))}attach(a){m(this,A).set(a.id,a)}detach(a){var D;m(this,A).delete(a.id),(D=m(this,C))==null||D.removePointerInTextLayer(a.contentDiv)}remove(a){m(this,s).removeEditor(a),this.detach(a),a.div.style.display="none",setTimeout(()=>{a.div.style.display="",a.div.remove(),a.isAttachedToDOM=!1,document.activeElement===document.body&&m(this,s).focusMainContainer()},0),m(this,g)||this.addInkEditorIfNeeded(!1)}add(a){if(ot(this,r,be).call(this,a),m(this,s).addEditor(a),this.attach(a),!a.isAttachedToDOM){const D=a.render();this.div.append(D),a.isAttachedToDOM=!0}this.moveEditorInDOM(a),a.onceAdded(),m(this,s).addToAnnotationStorage(a)}moveEditorInDOM(a){var D;(D=m(this,C))==null||D.moveElementInDOM(this.div,a.div,a.contentDiv,!0)}addOrRebuild(a){a.needsToBeRebuilt()?a.rebuild():this.add(a)}addANewEditor(a){const D=()=>{this.addOrRebuild(a)},$=()=>{a.remove()};this.addCommands({cmd:D,undo:$,mustExec:!0})}addUndoableEditor(a){const D=()=>{this.addOrRebuild(a)},$=()=>{a.remove()};this.addCommands({cmd:D,undo:$,mustExec:!1})}getNextId(){return m(this,s).getId()}deserialize(a){switch(a.annotationType){case l.AnnotationEditorType.FREETEXT:return W.FreeTextEditor.deserialize(a,this,m(this,s));case l.AnnotationEditorType.INK:return N.InkEditor.deserialize(a,this,m(this,s))}return null}setSelected(a){m(this,s).setSelected(a)}toggleSelected(a){m(this,s).toggleSelected(a)}isSelected(a){return m(this,s).isSelected(a)}unselect(a){m(this,s).unselect(a)}pointerup(a){const{isMac:D}=l.FeatureTest.platform;if(!(a.button!==0||a.ctrlKey&&D)&&a.target===this.div&&m(this,d)){if(pt(this,d,!1),!m(this,_)){pt(this,_,!0);return}ot(this,t,Ae).call(this,a)}}pointerdown(a){const{isMac:D}=l.FeatureTest.platform;if(a.button!==0||a.ctrlKey&&D||a.target!==this.div)return;pt(this,d,!0);const $=m(this,s).getActive();pt(this,_,!$||$.isEmpty())}drop(a){const D=a.dataTransfer.getData("text/plain"),$=m(this,s).getEditor(D);if(!$)return;a.preventDefault(),a.dataTransfer.dropEffect="move",ot(this,r,be).call(this,$);const Y=this.div.getBoundingClientRect(),tt=a.clientX-Y.x,it=a.clientY-Y.y;$.translate(tt-$.startX,it-$.startY),this.moveEditorInDOM($),$.div.focus()}dragover(a){a.preventDefault()}destroy(){var a,D;((a=m(this,s).getActive())==null?void 0:a.parent)===this&&m(this,s).setActiveEditor(null);for(const $ of m(this,A).values())(D=m(this,C))==null||D.removePointerInTextLayer($.contentDiv),$.setParent(null),$.isAttachedToDOM=!1,$.div.remove();this.div=null,m(this,A).clear(),m(this,s).removeLayer(this)}render({viewport:a}){this.viewport=a,(0,J.setLayerDimensions)(this.div,a),(0,S.bindEvents)(this,this.div,["dragover","drop"]);for(const D of m(this,s).getEditors(this.pageIndex))this.add(D);this.updateMode()}update({viewport:a}){m(this,s).commitOrRemove(),this.viewport=a,(0,J.setLayerDimensions)(this.div,{rotation:a.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:a,pageHeight:D}=this.viewport.rawDims;return[a,D]}};let R=u;C=new WeakMap,_=new WeakMap,w=new WeakMap,y=new WeakMap,A=new WeakMap,d=new WeakMap,g=new WeakMap,s=new WeakMap,r=new WeakSet,be=function(a){var D;a.parent!==this&&(this.attach(a),(D=a.parent)==null||D.detach(a),a.setParent(this),a.div&&a.isAttachedToDOM&&(a.div.remove(),this.div.append(a.div)))},M=new WeakSet,Be=function(a){switch(m(this,s).getMode()){case l.AnnotationEditorType.FREETEXT:return new W.FreeTextEditor(a);case l.AnnotationEditorType.INK:return new N.InkEditor(a)}return null},t=new WeakSet,Ae=function(a){const D=this.getNextId(),$=ot(this,M,Be).call(this,{parent:this,id:D,x:a.offsetX,y:a.offsetY,uiManager:m(this,s)});return $&&this.add($),$},o=new WeakSet,ye=function(){pt(this,g,!0);for(const a of m(this,A).values())a.isEmpty()&&a.remove();pt(this,g,!1)},Dt(R,"_initialized",!1),i.AnnotationEditorLayer=R},(K,i,L)=>{var J,R,C,_,w,y,A,d,g,s,Ue,k,We,v,He,c,ve;Object.defineProperty(i,"__esModule",{value:!0}),i.FreeTextEditor=void 0;var l=L(1),S=L(5),W=L(4);const n=class extends W.AnnotationEditor{constructor(a){super({...a,name:"freeTextEditor"});et(this,s);et(this,k);et(this,v);et(this,c);et(this,J,this.editorDivBlur.bind(this));et(this,R,this.editorDivFocus.bind(this));et(this,C,this.editorDivInput.bind(this));et(this,_,this.editorDivKeydown.bind(this));et(this,w,void 0);et(this,y,"");et(this,A,`${this.id}-editor`);et(this,d,!1);et(this,g,void 0);pt(this,w,a.color||n._defaultColor||W.AnnotationEditor._defaultLineColor),pt(this,g,a.fontSize||n._defaultFontSize)}static initialize(a){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map($=>[$,a.get($)]));const D=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(D.getPropertyValue("--freetext-padding"))}static updateDefaultParams(a,D){switch(a){case l.AnnotationEditorParamsType.FREETEXT_SIZE:n._defaultFontSize=D;break;case l.AnnotationEditorParamsType.FREETEXT_COLOR:n._defaultColor=D;break}}updateParams(a,D){switch(a){case l.AnnotationEditorParamsType.FREETEXT_SIZE:ot(this,s,Ue).call(this,D);break;case l.AnnotationEditorParamsType.FREETEXT_COLOR:ot(this,k,We).call(this,D);break}}static get defaultPropertiesToUpdate(){return[[l.AnnotationEditorParamsType.FREETEXT_SIZE,n._defaultFontSize],[l.AnnotationEditorParamsType.FREETEXT_COLOR,n._defaultColor||W.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[l.AnnotationEditorParamsType.FREETEXT_SIZE,m(this,g)],[l.AnnotationEditorParamsType.FREETEXT_COLOR,m(this,w)]]}getInitialTranslation(){const a=this.parentScale;return[-n._internalPadding*a,-(n._internalPadding+m(this,g))*a]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(l.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",m(this,_)),this.editorDiv.addEventListener("focus",m(this,R)),this.editorDiv.addEventListener("blur",m(this,J)),this.editorDiv.addEventListener("input",m(this,C)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",m(this,A)),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",m(this,_)),this.editorDiv.removeEventListener("focus",m(this,R)),this.editorDiv.removeEventListener("blur",m(this,J)),this.editorDiv.removeEventListener("input",m(this,C)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(a){super.focusin(a),a.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}commit(){this.isInEditMode()&&(super.commit(),m(this,d)||(pt(this,d,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),pt(this,y,ot(this,v,He).call(this).trimEnd()),ot(this,c,ve).call(this))}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(a){this.enableEditMode(),this.editorDiv.focus()}keydown(a){a.target===this.div&&a.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(a){n._keyboardManager.exec(this,a)}editorDivFocus(a){this.isEditing=!0}editorDivBlur(a){this.isEditing=!1}editorDivInput(a){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let a,D;this.width&&(a=this.x,D=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",m(this,A)),this.enableEditing(),n._l10nPromise.get("editor_free_text2_aria_label").then(Y=>{var tt;return(tt=this.editorDiv)==null?void 0:tt.setAttribute("aria-label",Y)}),n._l10nPromise.get("free_text2_default_content").then(Y=>{var tt;return(tt=this.editorDiv)==null?void 0:tt.setAttribute("default-content",Y)}),this.editorDiv.contentEditable=!0;const{style:$}=this.editorDiv;if($.fontSize=`calc(${m(this,g)}px * var(--scale-factor))`,$.color=m(this,w),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,S.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Y,tt]=this.parentDimensions;this.setAt(a*Y,D*tt,this.width*Y,this.height*tt);for(const it of m(this,y).split(`
`)){const ut=document.createElement("div");ut.append(it?document.createTextNode(it):document.createElement("br")),this.editorDiv.append(ut)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(a,D,$){const Y=super.deserialize(a,D,$);return pt(Y,g,a.fontSize),pt(Y,w,l.Util.makeHexColor(...a.color)),pt(Y,y,a.value),Y}serialize(){if(this.isEmpty())return null;const a=n._internalPadding*this.parentScale,D=this.getRect(a,a),$=W.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:m(this,w));return{annotationType:l.AnnotationEditorType.FREETEXT,color:$,fontSize:m(this,g),value:m(this,y),pageIndex:this.pageIndex,rect:D,rotation:this.rotation}}};let N=n;J=new WeakMap,R=new WeakMap,C=new WeakMap,_=new WeakMap,w=new WeakMap,y=new WeakMap,A=new WeakMap,d=new WeakMap,g=new WeakMap,s=new WeakSet,Ue=function(a){const D=Y=>{this.editorDiv.style.fontSize=`calc(${Y}px * var(--scale-factor))`,this.translate(0,-(Y-m(this,g))*this.parentScale),pt(this,g,Y),ot(this,c,ve).call(this)},$=m(this,g);this.addCommands({cmd:()=>{D(a)},undo:()=>{D($)},mustExec:!0,type:l.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},k=new WeakSet,We=function(a){const D=m(this,w);this.addCommands({cmd:()=>{pt(this,w,this.editorDiv.style.color=a)},undo:()=>{pt(this,w,this.editorDiv.style.color=D)},mustExec:!0,type:l.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},v=new WeakSet,He=function(){const a=this.editorDiv.getElementsByTagName("div");if(a.length===0)return this.editorDiv.innerText;const D=[];for(const $ of a)D.push($.innerText.replace(/\r\n?|\n/,""));return D.join(`
`)},c=new WeakSet,ve=function(){const[a,D]=this.parentDimensions;let $;if(this.isAttachedToDOM)$=this.div.getBoundingClientRect();else{const{currentLayer:Y,div:tt}=this,it=tt.style.display;tt.style.display="hidden",Y.div.append(this.div),$=tt.getBoundingClientRect(),tt.remove(),tt.style.display=it}this.width=$.width/a,this.height=$.height/D},Dt(N,"_freeTextDefaultContent",""),Dt(N,"_l10nPromise"),Dt(N,"_internalPadding",0),Dt(N,"_defaultColor",null),Dt(N,"_defaultFontSize",10),Dt(N,"_keyboardManager",new S.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],n.prototype.commitOrRemove]])),Dt(N,"_type","freetext"),i.FreeTextEditor=N},(K,i,L)=>{var C,_,w,y,A,d,g,s,r,k,M,v,t,c,o,qe,u,Ge,a,Ve,$,Xe,tt,Se,ut,$e,ft,ze,yt,Ye,f,Gt,E,Ee,O,ae,V,oe,z,Yt,F,Ce,h,le,x,Te,B,Ke,st,Je,at,Qe,ct,we,gt,ce,At,Kt,P,xe;Object.defineProperty(i,"__esModule",{value:!0}),i.InkEditor=void 0,Object.defineProperty(i,"fitCurve",{enumerable:!0,get:function(){return W.fitCurve}});var l=L(1),S=L(4),W=L(30),N=L(5);const J=16,q=class extends S.AnnotationEditor{constructor(Z){super({...Z,name:"inkEditor"});et(this,o);et(this,u);et(this,a);et(this,$);et(this,tt);et(this,ut);et(this,ft);et(this,yt);et(this,f);et(this,E);et(this,O);et(this,V);et(this,z);et(this,F);et(this,h);et(this,B);et(this,st);et(this,at);et(this,ct);et(this,gt);et(this,At);et(this,P);et(this,C,0);et(this,_,0);et(this,w,0);et(this,y,this.canvasPointermove.bind(this));et(this,A,this.canvasPointerleave.bind(this));et(this,d,this.canvasPointerup.bind(this));et(this,g,this.canvasPointerdown.bind(this));et(this,s,!1);et(this,r,!1);et(this,k,null);et(this,M,null);et(this,v,0);et(this,t,0);et(this,c,null);this.color=Z.color||null,this.thickness=Z.thickness||null,this.opacity=Z.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(Z){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(ht=>[ht,Z.get(ht)]))}static updateDefaultParams(Z,ht){switch(Z){case l.AnnotationEditorParamsType.INK_THICKNESS:q._defaultThickness=ht;break;case l.AnnotationEditorParamsType.INK_COLOR:q._defaultColor=ht;break;case l.AnnotationEditorParamsType.INK_OPACITY:q._defaultOpacity=ht/100;break}}updateParams(Z,ht){switch(Z){case l.AnnotationEditorParamsType.INK_THICKNESS:ot(this,o,qe).call(this,ht);break;case l.AnnotationEditorParamsType.INK_COLOR:ot(this,u,Ge).call(this,ht);break;case l.AnnotationEditorParamsType.INK_OPACITY:ot(this,a,Ve).call(this,ht);break}}static get defaultPropertiesToUpdate(){return[[l.AnnotationEditorParamsType.INK_THICKNESS,q._defaultThickness],[l.AnnotationEditorParamsType.INK_COLOR,q._defaultColor||S.AnnotationEditor._defaultLineColor],[l.AnnotationEditorParamsType.INK_OPACITY,Math.round(q._defaultOpacity*100)]]}get propertiesToUpdate(){return[[l.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||q._defaultThickness],[l.AnnotationEditorParamsType.INK_COLOR,this.color||q._defaultColor||S.AnnotationEditor._defaultLineColor],[l.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??q._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(ot(this,O,ae).call(this),ot(this,V,oe).call(this)),this.isAttachedToDOM||(this.parent.add(this),ot(this,z,Yt).call(this)),ot(this,At,Kt).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,m(this,M).disconnect(),pt(this,M,null),super.remove())}setParent(Z){!this.parent&&Z?this._uiManager.removeShouldRescale(this):this.parent&&Z===null&&this._uiManager.addShouldRescale(this),super.setParent(Z)}onScaleChanging(){const[Z,ht]=this.parentDimensions,vt=this.width*Z,St=this.height*ht;this.setDimensions(vt,St)}enableEditMode(){m(this,s)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",m(this,g)),this.canvas.addEventListener("pointerup",m(this,d)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",m(this,g)),this.canvas.removeEventListener("pointerup",m(this,d)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){m(this,s)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),pt(this,s,!0),this.div.classList.add("disabled"),ot(this,At,Kt).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(Z){super.focusin(Z),this.enableEditMode()}canvasPointerdown(Z){Z.button!==0||!this.isInEditMode()||m(this,s)||(this.setInForeground(),Z.type!=="mouse"&&this.div.focus(),Z.stopPropagation(),this.canvas.addEventListener("pointerleave",m(this,A)),this.canvas.addEventListener("pointermove",m(this,y)),ot(this,ut,$e).call(this,Z.offsetX,Z.offsetY))}canvasPointermove(Z){Z.stopPropagation(),ot(this,ft,ze).call(this,Z.offsetX,Z.offsetY)}canvasPointerup(Z){Z.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(Z.stopPropagation(),ot(this,E,Ee).call(this,Z),this.setInBackground())}canvasPointerleave(Z){ot(this,E,Ee).call(this,Z),this.setInBackground()}render(){if(this.div)return this.div;let Z,ht;this.width&&(Z=this.x,ht=this.y),super.render(),q._l10nPromise.get("editor_ink2_aria_label").then(kt=>{var wt;return(wt=this.div)==null?void 0:wt.setAttribute("aria-label",kt)});const[vt,St,Ft,Pt]=ot(this,$,Xe).call(this);if(this.setAt(vt,St,0,0),this.setDims(Ft,Pt),ot(this,O,ae).call(this),this.width){const[kt,wt]=this.parentDimensions;this.setAt(Z*kt,ht*wt,this.width*kt,this.height*wt),pt(this,r,!0),ot(this,z,Yt).call(this),this.setDims(this.width*kt,this.height*wt),ot(this,f,Gt).call(this),ot(this,P,xe).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return ot(this,V,oe).call(this),this.div}setDimensions(Z,ht){const vt=Math.round(Z),St=Math.round(ht);if(m(this,v)===vt&&m(this,t)===St)return;pt(this,v,vt),pt(this,t,St),this.canvas.style.visibility="hidden",m(this,C)&&Math.abs(m(this,C)-Z/ht)>.01&&(ht=Math.ceil(Z/m(this,C)),this.setDims(Z,ht));const[Ft,Pt]=this.parentDimensions;this.width=Z/Ft,this.height=ht/Pt,m(this,s)&&ot(this,F,Ce).call(this,Z,ht),ot(this,z,Yt).call(this),ot(this,f,Gt).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(Z,ht,vt){var Mt,Ot;const St=super.deserialize(Z,ht,vt);St.thickness=Z.thickness,St.color=l.Util.makeHexColor(...Z.color),St.opacity=Z.opacity;const[Ft,Pt]=St.pageDimensions,kt=St.width*Ft,wt=St.height*Pt,Rt=St.parentScale,Tt=Z.thickness/2;pt(St,C,kt/wt),pt(St,s,!0),pt(St,v,Math.round(kt)),pt(St,t,Math.round(wt));for(const{bezier:Lt}of Z.paths){const jt=[];St.paths.push(jt);let It=Rt*(Lt[0]-Tt),Bt=Rt*(wt-Lt[1]-Tt);for(let Ut=2,Zt=Lt.length;Ut<Zt;Ut+=6){const te=Rt*(Lt[Ut]-Tt),ee=Rt*(wt-Lt[Ut+1]-Tt),se=Rt*(Lt[Ut+2]-Tt),ne=Rt*(wt-Lt[Ut+3]-Tt),Fe=Rt*(Lt[Ut+4]-Tt),Re=Rt*(wt-Lt[Ut+5]-Tt);jt.push([[It,Bt],[te,ee],[se,ne],[Fe,Re]]),It=Fe,Bt=Re}const Ht=ot(this,x,Te).call(this,jt);St.bezierPath2D.push(Ht)}const Nt=ot(Mt=St,ct,we).call(Mt);return pt(St,w,Math.max(J,Nt[2]-Nt[0])),pt(St,_,Math.max(J,Nt[3]-Nt[1])),ot(Ot=St,F,Ce).call(Ot,kt,wt),St}serialize(){if(this.isEmpty())return null;const Z=this.getRect(0,0),ht=this.rotation%180===0?Z[3]-Z[1]:Z[2]-Z[0],vt=S.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:l.AnnotationEditorType.INK,color:vt,thickness:this.thickness,opacity:this.opacity,paths:ot(this,B,Ke).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,ht),pageIndex:this.pageIndex,rect:Z,rotation:this.rotation}}};let R=q;C=new WeakMap,_=new WeakMap,w=new WeakMap,y=new WeakMap,A=new WeakMap,d=new WeakMap,g=new WeakMap,s=new WeakMap,r=new WeakMap,k=new WeakMap,M=new WeakMap,v=new WeakMap,t=new WeakMap,c=new WeakMap,o=new WeakSet,qe=function(Z){const ht=this.thickness;this.addCommands({cmd:()=>{this.thickness=Z,ot(this,At,Kt).call(this)},undo:()=>{this.thickness=ht,ot(this,At,Kt).call(this)},mustExec:!0,type:l.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},u=new WeakSet,Ge=function(Z){const ht=this.color;this.addCommands({cmd:()=>{this.color=Z,ot(this,f,Gt).call(this)},undo:()=>{this.color=ht,ot(this,f,Gt).call(this)},mustExec:!0,type:l.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},a=new WeakSet,Ve=function(Z){Z/=100;const ht=this.opacity;this.addCommands({cmd:()=>{this.opacity=Z,ot(this,f,Gt).call(this)},undo:()=>{this.opacity=ht,ot(this,f,Gt).call(this)},mustExec:!0,type:l.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},$=new WeakSet,Xe=function(){const{parentRotation:Z,parentDimensions:[ht,vt]}=this;switch(Z){case 90:return[0,vt,vt,ht];case 180:return[ht,vt,ht,vt];case 270:return[ht,0,vt,ht];default:return[0,0,ht,vt]}},tt=new WeakSet,Se=function(){const{ctx:Z,color:ht,opacity:vt,thickness:St,parentScale:Ft,scaleFactor:Pt}=this;Z.lineWidth=St*Ft/Pt,Z.lineCap="round",Z.lineJoin="round",Z.miterLimit=10,Z.strokeStyle=`${ht}${(0,N.opacityToHex)(vt)}`},ut=new WeakSet,$e=function(Z,ht){this.isEditing=!0,m(this,r)||(pt(this,r,!0),ot(this,z,Yt).call(this),this.thickness||(this.thickness=q._defaultThickness),this.color||(this.color=q._defaultColor||S.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=q._defaultOpacity)),this.currentPath.push([Z,ht]),pt(this,k,null),ot(this,tt,Se).call(this),this.ctx.beginPath(),this.ctx.moveTo(Z,ht),pt(this,c,()=>{m(this,c)&&(m(this,k)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):ot(this,f,Gt).call(this),this.ctx.lineTo(...m(this,k)),pt(this,k,null),this.ctx.stroke()),window.requestAnimationFrame(m(this,c)))}),window.requestAnimationFrame(m(this,c))},ft=new WeakSet,ze=function(Z,ht){const[vt,St]=this.currentPath.at(-1);Z===vt&&ht===St||(this.currentPath.push([Z,ht]),pt(this,k,[Z,ht]))},yt=new WeakSet,Ye=function(Z,ht){var Rt;this.ctx.closePath(),pt(this,c,null),Z=Math.min(Math.max(Z,0),this.canvas.width),ht=Math.min(Math.max(ht,0),this.canvas.height);const[vt,St]=this.currentPath.at(-1);(Z!==vt||ht!==St)&&this.currentPath.push([Z,ht]);let Ft;if(this.currentPath.length!==1)Ft=(0,W.fitCurve)(this.currentPath,30,null);else{const Tt=[Z,ht];Ft=[[Tt,Tt.slice(),Tt.slice(),Tt]]}const Pt=ot(Rt=q,x,Te).call(Rt,Ft);this.currentPath.length=0;const kt=()=>{this.paths.push(Ft),this.bezierPath2D.push(Pt),this.rebuild()},wt=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(ot(this,O,ae).call(this),ot(this,V,oe).call(this)),ot(this,At,Kt).call(this))};this.addCommands({cmd:kt,undo:wt,mustExec:!0})},f=new WeakSet,Gt=function(){if(this.isEmpty()){ot(this,h,le).call(this);return}ot(this,tt,Se).call(this);const{canvas:Z,ctx:ht}=this;ht.setTransform(1,0,0,1,0,0),ht.clearRect(0,0,Z.width,Z.height),ot(this,h,le).call(this);for(const vt of this.bezierPath2D)ht.stroke(vt)},E=new WeakSet,Ee=function(Z){ot(this,yt,Ye).call(this,Z.offsetX,Z.offsetY),this.canvas.removeEventListener("pointerleave",m(this,A)),this.canvas.removeEventListener("pointermove",m(this,y)),this.addToAnnotationStorage()},O=new WeakSet,ae=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",q._l10nPromise.get("editor_ink_canvas_aria_label").then(Z=>{var ht;return(ht=this.canvas)==null?void 0:ht.setAttribute("aria-label",Z)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},V=new WeakSet,oe=function(){pt(this,M,new ResizeObserver(Z=>{const ht=Z[0].contentRect;ht.width&&ht.height&&this.setDimensions(ht.width,ht.height)})),m(this,M).observe(this.div)},z=new WeakSet,Yt=function(){if(!m(this,r))return;const[Z,ht]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Z),this.canvas.height=Math.ceil(this.height*ht),ot(this,h,le).call(this)},F=new WeakSet,Ce=function(Z,ht){const vt=ot(this,gt,ce).call(this),St=(Z-vt)/m(this,w),Ft=(ht-vt)/m(this,_);this.scaleFactor=Math.min(St,Ft)},h=new WeakSet,le=function(){const Z=ot(this,gt,ce).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Z,this.translationY*this.scaleFactor+Z)},x=new WeakSet,Te=function(Z){const ht=new Path2D;for(let vt=0,St=Z.length;vt<St;vt++){const[Ft,Pt,kt,wt]=Z[vt];vt===0&&ht.moveTo(...Ft),ht.bezierCurveTo(Pt[0],Pt[1],kt[0],kt[1],wt[0],wt[1])}return ht},B=new WeakSet,Ke=function(Z,ht,vt,St){const Pt=[],kt=this.thickness/2;let wt,Rt;for(const Tt of this.paths){wt=[],Rt=[];for(let Nt=0,Mt=Tt.length;Nt<Mt;Nt++){const[Ot,Lt,jt,It]=Tt[Nt],Bt=Z*(Ot[0]+ht)+kt,Ht=St-Z*(Ot[1]+vt)-kt,Ut=Z*(Lt[0]+ht)+kt,Zt=St-Z*(Lt[1]+vt)-kt,te=Z*(jt[0]+ht)+kt,ee=St-Z*(jt[1]+vt)-kt,se=Z*(It[0]+ht)+kt,ne=St-Z*(It[1]+vt)-kt;Nt===0&&(wt.push(Bt,Ht),Rt.push(Bt,Ht)),wt.push(Ut,Zt,te,ee,se,ne),ot(this,st,Je).call(this,Bt,Ht,Ut,Zt,te,ee,se,ne,4,Rt)}Pt.push({bezier:wt,points:Rt})}return Pt},st=new WeakSet,Je=function(Z,ht,vt,St,Ft,Pt,kt,wt,Rt,Tt){if(ot(this,at,Qe).call(this,Z,ht,vt,St,Ft,Pt,kt,wt)){Tt.push(kt,wt);return}for(let Nt=1;Nt<Rt-1;Nt++){const Mt=Nt/Rt,Ot=1-Mt;let Lt=Mt*Z+Ot*vt,jt=Mt*ht+Ot*St,It=Mt*vt+Ot*Ft,Bt=Mt*St+Ot*Pt;const Ht=Mt*Ft+Ot*kt,Ut=Mt*Pt+Ot*wt;Lt=Mt*Lt+Ot*It,jt=Mt*jt+Ot*Bt,It=Mt*It+Ot*Ht,Bt=Mt*Bt+Ot*Ut,Lt=Mt*Lt+Ot*It,jt=Mt*jt+Ot*Bt,Tt.push(Lt,jt)}Tt.push(kt,wt)},at=new WeakSet,Qe=function(Z,ht,vt,St,Ft,Pt,kt,wt){const Tt=(3*vt-2*Z-kt)**2,Nt=(3*St-2*ht-wt)**2,Mt=(3*Ft-Z-2*kt)**2,Ot=(3*Pt-ht-2*wt)**2;return Math.max(Tt,Mt)+Math.max(Nt,Ot)<=10},ct=new WeakSet,we=function(){let Z=1/0,ht=-1/0,vt=1/0,St=-1/0;for(const Ft of this.paths)for(const[Pt,kt,wt,Rt]of Ft){const Tt=l.Util.bezierBoundingBox(...Pt,...kt,...wt,...Rt);Z=Math.min(Z,Tt[0]),vt=Math.min(vt,Tt[1]),ht=Math.max(ht,Tt[2]),St=Math.max(St,Tt[3])}return[Z,vt,ht,St]},gt=new WeakSet,ce=function(){return m(this,s)?Math.ceil(this.thickness*this.parentScale):0},At=new WeakSet,Kt=function(Z=!1){if(this.isEmpty())return;if(!m(this,s)){ot(this,f,Gt).call(this);return}const ht=ot(this,ct,we).call(this),vt=ot(this,gt,ce).call(this);pt(this,w,Math.max(J,ht[2]-ht[0])),pt(this,_,Math.max(J,ht[3]-ht[1]));const St=Math.ceil(vt+m(this,w)*this.scaleFactor),Ft=Math.ceil(vt+m(this,_)*this.scaleFactor),[Pt,kt]=this.parentDimensions;this.width=St/Pt,this.height=Ft/kt,pt(this,C,St/Ft),ot(this,P,xe).call(this);const wt=this.translationX,Rt=this.translationY;this.translationX=-ht[0],this.translationY=-ht[1],ot(this,z,Yt).call(this),ot(this,f,Gt).call(this),pt(this,v,St),pt(this,t,Ft),this.setDims(St,Ft);const Tt=Z?vt/this.scaleFactor/2:0;this.translate(wt-this.translationX-Tt,Rt-this.translationY-Tt)},P=new WeakSet,xe=function(){const{style:Z}=this.div;m(this,C)>=1?(Z.minHeight=`${J}px`,Z.minWidth=`${Math.round(m(this,C)*J)}px`):(Z.minWidth=`${J}px`,Z.minHeight=`${Math.round(J/m(this,C))}px`)},et(R,x),Dt(R,"_defaultColor",null),Dt(R,"_defaultOpacity",1),Dt(R,"_defaultThickness",1),Dt(R,"_l10nPromise"),Dt(R,"_type","ink"),i.InkEditor=R},(K,i,L)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.fitCurve=void 0;const l=L(31);i.fitCurve=l},K=>{function i(d,g,s){if(!Array.isArray(d))throw new TypeError("First argument should be an array");if(d.forEach(v=>{if(!Array.isArray(v)||v.some(t=>typeof t!="number")||v.length!==d[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),d=d.filter((v,t)=>t===0||!v.every((c,o)=>c===d[t-1][o])),d.length<2)return[];const r=d.length,k=w(d[1],d[0]),M=w(d[r-2],d[r-1]);return L(d,k,M,g,s)}function L(d,g,s,r,k){var v,t,c,o,n,u,T,a,D,$,Y,tt,it;if(d.length===2)return tt=y.vectorLen(y.subtract(d[0],d[1]))/3,v=[d[0],y.addArrays(d[0],y.mulItems(g,tt)),y.addArrays(d[1],y.mulItems(s,tt)),d[1]],[v];if(t=J(d),[v,o,u]=l(d,t,t,g,s,k),o===0||o<r)return[v];if(o<r*r)for(c=t,n=o,T=u,it=0;it<20;it++){if(c=W(v,d,c),[v,o,u]=l(d,t,c,g,s,k),o<r)return[v];if(u===T){let ut=o/n;if(ut>.9999&&ut<1.0001)break}n=o,T=u}return Y=[],a=y.subtract(d[u-1],d[u+1]),a.every(ut=>ut===0)&&(a=y.subtract(d[u-1],d[u]),[a[0],a[1]]=[-a[1],a[0]]),D=y.normalize(a),$=y.mulItems(D,-1),Y=Y.concat(L(d.slice(0,u+1),g,D,r,k)),Y=Y.concat(L(d.slice(u),$,s,r,k)),Y}function l(d,g,s,r,k,M){var v,t,c;return v=S(d,s,r,k),[t,c]=R(d,v,g),M&&M({bez:v,points:d,params:g,maxErr:t,maxPoint:c}),[v,t,c]}function S(d,g,s,r){var k,M,v,t,c,o,n,u,T,a,D,$,Y,tt,it,ut,lt,ft=d[0],bt=d[d.length-1];for(k=[ft,null,null,bt],M=y.zeros_Xx2x2(g.length),Y=0,tt=g.length;Y<tt;Y++)ut=g[Y],lt=1-ut,v=M[Y],v[0]=y.mulItems(s,3*ut*(lt*lt)),v[1]=y.mulItems(r,3*lt*(ut*ut));for(t=[[0,0],[0,0]],c=[0,0],Y=0,tt=d.length;Y<tt;Y++)ut=g[Y],v=M[Y],t[0][0]+=y.dot(v[0],v[0]),t[0][1]+=y.dot(v[0],v[1]),t[1][0]+=y.dot(v[0],v[1]),t[1][1]+=y.dot(v[1],v[1]),it=y.subtract(d[Y],A.q([ft,ft,bt,bt],ut)),c[0]+=y.dot(v[0],it),c[1]+=y.dot(v[1],it);return o=t[0][0]*t[1][1]-t[1][0]*t[0][1],n=t[0][0]*c[1]-t[1][0]*c[0],u=c[0]*t[1][1]-c[1]*t[0][1],T=o===0?0:u/o,a=o===0?0:n/o,$=y.vectorLen(y.subtract(ft,bt)),D=1e-6*$,T<D||a<D?(k[1]=y.addArrays(ft,y.mulItems(s,$/3)),k[2]=y.addArrays(bt,y.mulItems(r,$/3))):(k[1]=y.addArrays(ft,y.mulItems(s,T)),k[2]=y.addArrays(bt,y.mulItems(r,a))),k}function W(d,g,s){return s.map((r,k)=>N(d,g[k],r))}function N(d,g,s){var r=y.subtract(A.q(d,s),g),k=A.qprime(d,s),M=y.mulMatrix(r,k),v=y.sum(y.squareItems(k))+2*y.mulMatrix(r,A.qprimeprime(d,s));return v===0?s:s-M/v}function J(d){var g=[],s,r,k;return d.forEach((M,v)=>{s=v?r+y.vectorLen(y.subtract(M,k)):0,g.push(s),r=s,k=M}),g=g.map(M=>M/r),g}function R(d,g,s){var r,k,M,v,t,c,o,n;k=0,M=Math.floor(d.length/2);const u=C(g,10);for(t=0,c=d.length;t<c;t++)o=d[t],n=_(g,s[t],u,10),v=y.subtract(A.q(g,n),o),r=v[0]*v[0]+v[1]*v[1],r>k&&(k=r,M=t);return[k,M]}var C=function(d,g){for(var s,r=[0],k=d[0],M=0,v=1;v<=g;v++)s=A.q(d,v/g),M+=y.vectorLen(y.subtract(s,k)),r.push(M),k=s;return r=r.map(t=>t/M),r};function _(d,g,s,r){if(g<0)return 0;if(g>1)return 1;for(var k,M,v,t,c,o=1;o<=r;o++)if(g<=s[o]){t=(o-1)/r,v=o/r,M=s[o-1],k=s[o],c=(g-M)/(k-M)*(v-t)+t;break}return c}function w(d,g){return y.normalize(y.subtract(d,g))}class y{static zeros_Xx2x2(g){for(var s=[];g--;)s.push([0,0]);return s}static mulItems(g,s){return g.map(r=>r*s)}static mulMatrix(g,s){return g.reduce((r,k,M)=>r+k*s[M],0)}static subtract(g,s){return g.map((r,k)=>r-s[k])}static addArrays(g,s){return g.map((r,k)=>r+s[k])}static addItems(g,s){return g.map(r=>r+s)}static sum(g){return g.reduce((s,r)=>s+r)}static dot(g,s){return y.mulMatrix(g,s)}static vectorLen(g){return Math.hypot(...g)}static divItems(g,s){return g.map(r=>r/s)}static squareItems(g){return g.map(s=>s*s)}static normalize(g){return this.divItems(g,this.vectorLen(g))}}class A{static q(g,s){var r=1-s,k=y.mulItems(g[0],r*r*r),M=y.mulItems(g[1],3*r*r*s),v=y.mulItems(g[2],3*r*s*s),t=y.mulItems(g[3],s*s*s);return y.addArrays(y.addArrays(k,M),y.addArrays(v,t))}static qprime(g,s){var r=1-s,k=y.mulItems(y.subtract(g[1],g[0]),3*r*r),M=y.mulItems(y.subtract(g[2],g[1]),6*r*s),v=y.mulItems(y.subtract(g[3],g[2]),3*s*s);return y.addArrays(y.addArrays(k,M),v)}static qprimeprime(g,s){return y.addArrays(y.mulItems(y.addArrays(y.subtract(g[2],y.mulItems(g[1],2)),g[0]),6*(1-s)),y.mulItems(y.addArrays(y.subtract(g[3],y.mulItems(g[2],2)),g[1]),6*s))}}K.exports=i,K.exports.fitCubic=L,K.exports.createTangent=w},(K,i,L)=>{var f,Xt,E,Ze,X,ke,Q,Pe;Object.defineProperty(i,"__esModule",{value:!0}),i.AnnotationLayer=void 0;var l=L(1),S=L(6),W=L(3),N=L(33),J=L(34);const R=1e3,C=9,_=new WeakSet;function w(F){return{width:F[2]-F[0],height:F[3]-F[1]}}class y{static create(e){switch(e.data.annotationType){case l.AnnotationType.LINK:return new d(e);case l.AnnotationType.TEXT:return new g(e);case l.AnnotationType.WIDGET:switch(e.data.fieldType){case"Tx":return new r(e);case"Btn":return e.data.radioButton?new M(e):e.data.checkBox?new k(e):new v(e);case"Ch":return new t(e)}return new s(e);case l.AnnotationType.POPUP:return new c(e);case l.AnnotationType.FREETEXT:return new n(e);case l.AnnotationType.LINE:return new u(e);case l.AnnotationType.SQUARE:return new T(e);case l.AnnotationType.CIRCLE:return new a(e);case l.AnnotationType.POLYLINE:return new D(e);case l.AnnotationType.CARET:return new Y(e);case l.AnnotationType.INK:return new tt(e);case l.AnnotationType.POLYGON:return new $(e);case l.AnnotationType.HIGHLIGHT:return new it(e);case l.AnnotationType.UNDERLINE:return new ut(e);case l.AnnotationType.SQUIGGLY:return new lt(e);case l.AnnotationType.STRIKEOUT:return new ft(e);case l.AnnotationType.STAMP:return new bt(e);case l.AnnotationType.FILEATTACHMENT:return new yt(e);default:return new A(e)}}}class A{constructor(e,{isRenderable:h=!1,ignoreBorder:b=!1,createQuadrilaterals:x=!1}={}){this.isRenderable=h,this.data=e.data,this.layer=e.layer,this.page=e.page,this.viewport=e.viewport,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,h&&(this.container=this._createContainer(b)),x&&(this.quadrilaterals=this._createQuadrilaterals(b))}_createContainer(e=!1){const{data:h,page:b,viewport:x}=this,I=document.createElement("section");I.setAttribute("data-annotation-id",h.id),h.noRotate&&I.classList.add("norotate");const{pageWidth:B,pageHeight:nt,pageX:st,pageY:rt}=x.rawDims,{width:at,height:dt}=w(h.rect),ct=l.Util.normalizeRect([h.rect[0],b.view[3]-h.rect[1]+b.view[1],h.rect[2],b.view[3]-h.rect[3]+b.view[1]]);if(!e&&h.borderStyle.width>0){I.style.borderWidth=`${h.borderStyle.width}px`;const gt=h.borderStyle.horizontalCornerRadius,Et=h.borderStyle.verticalCornerRadius;if(gt>0||Et>0){const xt=`calc(${gt}px * var(--scale-factor)) / calc(${Et}px * var(--scale-factor))`;I.style.borderRadius=xt}else if(this instanceof M){const xt=`calc(${at}px * var(--scale-factor)) / calc(${dt}px * var(--scale-factor))`;I.style.borderRadius=xt}switch(h.borderStyle.style){case l.AnnotationBorderStyleType.SOLID:I.style.borderStyle="solid";break;case l.AnnotationBorderStyleType.DASHED:I.style.borderStyle="dashed";break;case l.AnnotationBorderStyleType.BEVELED:(0,l.warn)("Unimplemented border style: beveled");break;case l.AnnotationBorderStyleType.INSET:(0,l.warn)("Unimplemented border style: inset");break;case l.AnnotationBorderStyleType.UNDERLINE:I.style.borderBottomStyle="solid";break}const At=h.borderColor||null;At?I.style.borderColor=l.Util.makeHexColor(At[0]|0,At[1]|0,At[2]|0):I.style.borderWidth=0}I.style.left=`${100*(ct[0]-st)/B}%`,I.style.top=`${100*(ct[1]-rt)/nt}%`;const{rotation:mt}=h;return h.hasOwnCanvas||mt===0?(I.style.width=`${100*at/B}%`,I.style.height=`${100*dt/nt}%`):this.setRotation(mt,I),I}setRotation(e,h=this.container){const{pageWidth:b,pageHeight:x}=this.viewport.rawDims,{width:I,height:B}=w(this.data.rect);let nt,st;e%180===0?(nt=100*I/b,st=100*B/x):(nt=100*B/b,st=100*I/x),h.style.width=`${nt}%`,h.style.height=`${st}%`,h.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(h,b,x)=>{const I=x.detail[h];x.target.style[b]=N.ColorConverters[`${I[0]}_HTML`](I.slice(1))};return(0,l.shadow)(this,"_commonActions",{display:h=>{const b=h.detail.display%2===1;this.container.style.visibility=b?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:b,print:h.detail.display===0||h.detail.display===3})},print:h=>{this.annotationStorage.setValue(this.data.id,{print:h.detail.print})},hidden:h=>{this.container.style.visibility=h.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:h.detail.hidden})},focus:h=>{setTimeout(()=>h.target.focus({preventScroll:!1}),0)},userName:h=>{h.target.title=h.detail.userName},readonly:h=>{h.detail.readonly?h.target.setAttribute("readonly",""):h.target.removeAttribute("readonly")},required:h=>{this._setRequired(h.target,h.detail.required)},bgColor:h=>{e("bgColor","backgroundColor",h)},fillColor:h=>{e("fillColor","backgroundColor",h)},fgColor:h=>{e("fgColor","color",h)},textColor:h=>{e("textColor","color",h)},borderColor:h=>{e("borderColor","borderColor",h)},strokeColor:h=>{e("strokeColor","borderColor",h)},rotation:h=>{const b=h.detail.rotation;this.setRotation(b),this.annotationStorage.setValue(this.data.id,{rotation:b})}})}_dispatchEventFromSandbox(e,h){const b=this._commonActions;for(const x of Object.keys(h.detail)){const I=e[x]||b[x];I==null||I(h)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const h=this.annotationStorage.getRawValue(this.data.id);if(!h)return;const b=this._commonActions;for(const[x,I]of Object.entries(h)){const B=b[x];if(B){const nt={detail:{[x]:I},target:e};B(nt),delete h[x]}}}_createQuadrilaterals(e=!1){if(!this.data.quadPoints)return null;const h=[],b=this.data.rect;for(const x of this.data.quadPoints)this.data.rect=[x[2].x,x[2].y,x[1].x,x[1].y],h.push(this._createContainer(e));return this.data.rect=b,h}_createPopup(e,h){let b=this.container;this.quadrilaterals&&(e=e||this.quadrilaterals,b=this.quadrilaterals[0]),e||(e=document.createElement("div"),e.classList.add("popupTriggerArea"),b.append(e));const I=new o({container:b,trigger:e,color:h.color,titleObj:h.titleObj,modificationDate:h.modificationDate,contentsObj:h.contentsObj,richText:h.richText,hideWrapper:!0}).render();I.style.left="100%",b.append(I)}_renderQuadrilaterals(e){for(const h of this.quadrilaterals)h.classList.add(e);return this.quadrilaterals}render(){(0,l.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,h=null){const b=[];if(this._fieldObjects){const x=this._fieldObjects[e];if(x)for(const{page:I,id:B,exportValues:nt}of x){if(I===-1||B===h)continue;const st=typeof nt=="string"?nt:null,rt=document.querySelector(`[data-element-id="${B}"]`);if(rt&&!_.has(rt)){(0,l.warn)(`_getElementsByName - element not allowed: ${B}`);continue}b.push({id:B,exportValue:st,domElement:rt})}return b}for(const x of document.getElementsByName(e)){const{exportValue:I}=x,B=x.getAttribute("data-element-id");B!==h&&_.has(x)&&b.push({id:B,exportValue:I,domElement:x})}return b}}class d extends A{constructor(h,b=null){super(h,{isRenderable:!0,ignoreBorder:!!(b!=null&&b.ignoreBorder),createQuadrilaterals:!0});et(this,f);et(this,E);this.isTooltipOnly=h.data.isTooltipOnly}render(){const{data:h,linkService:b}=this,x=document.createElement("a");x.setAttribute("data-element-id",h.id);let I=!1;return h.url?(b.addLinkAttributes(x,h.url,h.newWindow),I=!0):h.action?(this._bindNamedAction(x,h.action),I=!0):h.attachment?(this._bindAttachment(x,h.attachment),I=!0):h.setOCGState?(ot(this,E,Ze).call(this,x,h.setOCGState),I=!0):h.dest?(this._bindLink(x,h.dest),I=!0):(h.actions&&(h.actions.Action||h.actions["Mouse Up"]||h.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(x,h),I=!0),h.resetForm?(this._bindResetFormAction(x,h.resetForm),I=!0):this.isTooltipOnly&&!I&&(this._bindLink(x,""),I=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((B,nt)=>{const st=nt===0?x:x.cloneNode();return B.append(st),B}):(this.container.classList.add("linkAnnotation"),I&&this.container.append(x),this.container)}_bindLink(h,b){h.href=this.linkService.getDestinationHash(b),h.onclick=()=>(b&&this.linkService.goToDestination(b),!1),(b||b==="")&&ot(this,f,Xt).call(this)}_bindNamedAction(h,b){h.href=this.linkService.getAnchorUrl(""),h.onclick=()=>(this.linkService.executeNamedAction(b),!1),ot(this,f,Xt).call(this)}_bindAttachment(h,b){h.href=this.linkService.getAnchorUrl(""),h.onclick=()=>{var x;return(x=this.downloadManager)==null||x.openOrDownloadData(this.container,b.content,b.filename),!1},ot(this,f,Xt).call(this)}_bindJSAction(h,b){h.href=this.linkService.getAnchorUrl("");const x=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const I of Object.keys(b.actions)){const B=x.get(I);B&&(h[B]=()=>{var nt;return(nt=this.linkService.eventBus)==null||nt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:b.id,name:I}}),!1})}h.onclick||(h.onclick=()=>!1),ot(this,f,Xt).call(this)}_bindResetFormAction(h,b){const x=h.onclick;if(x||(h.href=this.linkService.getAnchorUrl("")),ot(this,f,Xt).call(this),!this._fieldObjects){(0,l.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),x||(h.onclick=()=>!1);return}h.onclick=()=>{var dt;x==null||x();const{fields:I,refs:B,include:nt}=b,st=[];if(I.length!==0||B.length!==0){const ct=new Set(B);for(const mt of I){const gt=this._fieldObjects[mt]||[];for(const{id:Et}of gt)ct.add(Et)}for(const mt of Object.values(this._fieldObjects))for(const gt of mt)ct.has(gt.id)===nt&&st.push(gt)}else for(const ct of Object.values(this._fieldObjects))st.push(...ct);const rt=this.annotationStorage,at=[];for(const ct of st){const{id:mt}=ct;switch(at.push(mt),ct.type){case"text":{const Et=ct.defaultValue||"";rt.setValue(mt,{value:Et});break}case"checkbox":case"radiobutton":{const Et=ct.defaultValue===ct.exportValues;rt.setValue(mt,{value:Et});break}case"combobox":case"listbox":{const Et=ct.defaultValue||"";rt.setValue(mt,{value:Et});break}default:continue}const gt=document.querySelector(`[data-element-id="${mt}"]`);if(gt){if(!_.has(gt)){(0,l.warn)(`_bindResetFormAction - element not allowed: ${mt}`);continue}}else continue;gt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((dt=this.linkService.eventBus)==null||dt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:at,name:"ResetForm"}})),!1}}}f=new WeakSet,Xt=function(){this.container.setAttribute("data-internal-link","")},E=new WeakSet,Ze=function(h,b){h.href=this.linkService.getAnchorUrl(""),h.onclick=()=>(this.linkService.executeSetOCGState(b),!1),ot(this,f,Xt).call(this)};class g extends A{constructor(e){var b,x,I;const h=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:h})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.alt="[{{type}} Annotation]",e.dataset.l10nId="text_annotation_type",e.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(e,this.data),this.container.append(e),this.container}}class s extends A{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(e){const{isWin:h,isMac:b}=l.FeatureTest.platform;return h&&e.ctrlKey||b&&e.metaKey}_setEventListener(e,h,b,x){h.includes("mouse")?e.addEventListener(h,I=>{var B;(B=this.linkService.eventBus)==null||B.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:b,value:x(I),shift:I.shiftKey,modifier:this._getKeyModifier(I)}})}):e.addEventListener(h,I=>{var B;(B=this.linkService.eventBus)==null||B.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:b,value:x(I)}})})}_setEventListeners(e,h,b){var x;for(const[I,B]of h)(B==="Action"||(x=this.data.actions)!=null&&x[B])&&this._setEventListener(e,I,B,b)}_setBackgroundColor(e){const h=this.data.backgroundColor||null;e.style.backgroundColor=h===null?"transparent":l.Util.makeHexColor(h[0],h[1],h[2])}_setTextStyle(e){const h=["left","center","right"],{fontColor:b}=this.data.defaultAppearanceData,x=this.data.defaultAppearanceData.fontSize||C,I=e.style;let B;const nt=2,st=rt=>Math.round(10*rt)/10;if(this.data.multiLine){const rt=Math.abs(this.data.rect[3]-this.data.rect[1]-nt),at=Math.round(rt/(l.LINE_FACTOR*x))||1,dt=rt/at;B=Math.min(x,st(dt/l.LINE_FACTOR))}else{const rt=Math.abs(this.data.rect[3]-this.data.rect[1]-nt);B=Math.min(x,st(rt/l.LINE_FACTOR))}I.fontSize=`calc(${B}px * var(--scale-factor))`,I.color=l.Util.makeHexColor(b[0],b[1],b[2]),this.data.textAlignment!==null&&(I.textAlign=h[this.data.textAlignment])}_setRequired(e,h){h?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",h)}}class r extends s{constructor(e){const h=e.renderForms||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:h})}setPropertyOnSiblings(e,h,b,x){const I=this.annotationStorage;for(const B of this._getElementsByName(e.name,e.id))B.domElement&&(B.domElement[h]=b),I.setValue(B.id,{[x]:b})}render(){var x;const e=this.annotationStorage,h=this.data.id;this.container.classList.add("textWidgetAnnotation");let b=null;if(this.renderForms){const I=e.getValue(h,{value:this.data.fieldValue});let B=I.formattedValue||I.value||"";const nt=e.getValue(h,{charLimit:this.data.maxLen}).charLimit;nt&&B.length>nt&&(B=B.slice(0,nt));const st={userValue:B,formattedValue:null,lastCommittedValue:null,commitKey:1};this.data.multiLine?(b=document.createElement("textarea"),b.textContent=B,this.data.doNotScroll&&(b.style.overflowY="hidden")):(b=document.createElement("input"),b.type="text",b.setAttribute("value",B),this.data.doNotScroll&&(b.style.overflowX="hidden")),_.add(b),b.setAttribute("data-element-id",h),b.disabled=this.data.readOnly,b.name=this.data.fieldName,b.tabIndex=R,this._setRequired(b,this.data.required),nt&&(b.maxLength=nt),b.addEventListener("input",at=>{e.setValue(h,{value:at.target.value}),this.setPropertyOnSiblings(b,"value",at.target.value,"value")}),b.addEventListener("resetform",at=>{const dt=this.data.defaultFieldValue??"";b.value=st.userValue=dt,st.formattedValue=null});let rt=at=>{const{formattedValue:dt}=st;dt!=null&&(at.target.value=dt),at.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){b.addEventListener("focus",dt=>{const{target:ct}=dt;st.userValue&&(ct.value=st.userValue),st.lastCommittedValue=ct.value,st.commitKey=1}),b.addEventListener("updatefromsandbox",dt=>{const ct={value(mt){st.userValue=mt.detail.value??"",e.setValue(h,{value:st.userValue.toString()}),mt.target.value=st.userValue},formattedValue(mt){const{formattedValue:gt}=mt.detail;st.formattedValue=gt,gt!=null&&mt.target!==document.activeElement&&(mt.target.value=gt),e.setValue(h,{formattedValue:gt})},selRange(mt){mt.target.setSelectionRange(...mt.detail.selRange)},charLimit:mt=>{var xt;const{charLimit:gt}=mt.detail,{target:Et}=mt;if(gt===0){Et.removeAttribute("maxLength");return}Et.setAttribute("maxLength",gt);let At=st.userValue;!At||At.length<=gt||(At=At.slice(0,gt),Et.value=st.userValue=At,e.setValue(h,{value:At}),(xt=this.linkService.eventBus)==null||xt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:h,name:"Keystroke",value:At,willCommit:!0,commitKey:1,selStart:Et.selectionStart,selEnd:Et.selectionEnd}}))}};this._dispatchEventFromSandbox(ct,dt)}),b.addEventListener("keydown",dt=>{var gt;st.commitKey=1;let ct=-1;if(dt.key==="Escape"?ct=0:dt.key==="Enter"&&!this.data.multiLine?ct=2:dt.key==="Tab"&&(st.commitKey=3),ct===-1)return;const{value:mt}=dt.target;st.lastCommittedValue!==mt&&(st.lastCommittedValue=mt,st.userValue=mt,(gt=this.linkService.eventBus)==null||gt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:h,name:"Keystroke",value:mt,willCommit:!0,commitKey:ct,selStart:dt.target.selectionStart,selEnd:dt.target.selectionEnd}}))});const at=rt;rt=null,b.addEventListener("blur",dt=>{var mt;if(!dt.relatedTarget)return;const{value:ct}=dt.target;st.userValue=ct,st.lastCommittedValue!==ct&&((mt=this.linkService.eventBus)==null||mt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:h,name:"Keystroke",value:ct,willCommit:!0,commitKey:st.commitKey,selStart:dt.target.selectionStart,selEnd:dt.target.selectionEnd}})),at(dt)}),(x=this.data.actions)!=null&&x.Keystroke&&b.addEventListener("beforeinput",dt=>{var H;st.lastCommittedValue=null;const{data:ct,target:mt}=dt,{value:gt,selectionStart:Et,selectionEnd:At}=mt;let xt=Et,P=At;switch(dt.inputType){case"deleteWordBackward":{const q=gt.substring(0,Et).match(/\w*[^\w]*$/);q&&(xt-=q[0].length);break}case"deleteWordForward":{const q=gt.substring(Et).match(/^[^\w]*\w*/);q&&(P+=q[0].length);break}case"deleteContentBackward":Et===At&&(xt-=1);break;case"deleteContentForward":Et===At&&(P+=1);break}dt.preventDefault(),(H=this.linkService.eventBus)==null||H.dispatch("dispatcheventinsandbox",{source:this,detail:{id:h,name:"Keystroke",value:gt,change:ct||"",willCommit:!1,selStart:xt,selEnd:P}})}),this._setEventListeners(b,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],dt=>dt.target.value)}if(rt&&b.addEventListener("blur",rt),this.data.comb){const dt=(this.data.rect[2]-this.data.rect[0])/nt;b.classList.add("comb"),b.style.letterSpacing=`calc(${dt}px * var(--scale-factor) - 1ch)`}}else b=document.createElement("div"),b.textContent=this.data.fieldValue,b.style.verticalAlign="middle",b.style.display="table-cell";return this._setTextStyle(b),this._setBackgroundColor(b),this._setDefaultPropertiesFromJS(b),this.container.append(b),this.container}}class k extends s{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,h=this.data,b=h.id;let x=e.getValue(b,{value:h.exportValue===h.fieldValue}).value;typeof x=="string"&&(x=x!=="Off",e.setValue(b,{value:x})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const I=document.createElement("input");return _.add(I),I.setAttribute("data-element-id",b),I.disabled=h.readOnly,this._setRequired(I,this.data.required),I.type="checkbox",I.name=h.fieldName,x&&I.setAttribute("checked",!0),I.setAttribute("exportValue",h.exportValue),I.tabIndex=R,I.addEventListener("change",B=>{const{name:nt,checked:st}=B.target;for(const rt of this._getElementsByName(nt,b)){const at=st&&rt.exportValue===h.exportValue;rt.domElement&&(rt.domElement.checked=at),e.setValue(rt.id,{value:at})}e.setValue(b,{value:st})}),I.addEventListener("resetform",B=>{const nt=h.defaultFieldValue||"Off";B.target.checked=nt===h.exportValue}),this.enableScripting&&this.hasJSActions&&(I.addEventListener("updatefromsandbox",B=>{const nt={value(st){st.target.checked=st.detail.value!=="Off",e.setValue(b,{value:st.target.checked})}};this._dispatchEventFromSandbox(nt,B)}),this._setEventListeners(I,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],B=>B.target.checked)),this._setBackgroundColor(I),this._setDefaultPropertiesFromJS(I),this.container.append(I),this.container}}class M extends s{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,h=this.data,b=h.id;let x=e.getValue(b,{value:h.fieldValue===h.buttonValue}).value;typeof x=="string"&&(x=x!==h.buttonValue,e.setValue(b,{value:x}));const I=document.createElement("input");if(_.add(I),I.setAttribute("data-element-id",b),I.disabled=h.readOnly,this._setRequired(I,this.data.required),I.type="radio",I.name=h.fieldName,x&&I.setAttribute("checked",!0),I.tabIndex=R,I.addEventListener("change",B=>{const{name:nt,checked:st}=B.target;for(const rt of this._getElementsByName(nt,b))e.setValue(rt.id,{value:!1});e.setValue(b,{value:st})}),I.addEventListener("resetform",B=>{const nt=h.defaultFieldValue;B.target.checked=nt!=null&&nt===h.buttonValue}),this.enableScripting&&this.hasJSActions){const B=h.buttonValue;I.addEventListener("updatefromsandbox",nt=>{const st={value:rt=>{const at=B===rt.detail.value;for(const dt of this._getElementsByName(rt.target.name)){const ct=at&&dt.id===b;dt.domElement&&(dt.domElement.checked=ct),e.setValue(dt.id,{value:ct})}}};this._dispatchEventFromSandbox(st,nt)}),this._setEventListeners(I,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],nt=>nt.target.checked)}return this._setBackgroundColor(I),this._setDefaultPropertiesFromJS(I),this.container.append(I),this.container}}class v extends d{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(e.title=this.data.alternativeText);const h=e.lastChild;return this.enableScripting&&this.hasJSActions&&h&&(this._setDefaultPropertiesFromJS(h),h.addEventListener("updatefromsandbox",b=>{this._dispatchEventFromSandbox({},b)})),e}}class t extends s{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,h=this.data.id,b=e.getValue(h,{value:this.data.fieldValue}),x=document.createElement("select");_.add(x),x.setAttribute("data-element-id",h),x.disabled=this.data.readOnly,this._setRequired(x,this.data.required),x.name=this.data.fieldName,x.tabIndex=R;let I=this.data.combo&&this.data.options.length>0;this.data.combo||(x.size=this.data.options.length,this.data.multiSelect&&(x.multiple=!0)),x.addEventListener("resetform",at=>{const dt=this.data.defaultFieldValue;for(const ct of x.options)ct.selected=ct.value===dt});for(const at of this.data.options){const dt=document.createElement("option");dt.textContent=at.displayValue,dt.value=at.exportValue,b.value.includes(at.exportValue)&&(dt.setAttribute("selected",!0),I=!1),x.append(dt)}let B=null;if(I){const at=document.createElement("option");at.value=" ",at.setAttribute("hidden",!0),at.setAttribute("selected",!0),x.prepend(at),B=()=>{at.remove(),x.removeEventListener("input",B),B=null},x.addEventListener("input",B)}const nt=at=>{const dt=at?"value":"textContent",{options:ct,multiple:mt}=x;return mt?Array.prototype.filter.call(ct,gt=>gt.selected).map(gt=>gt[dt]):ct.selectedIndex===-1?null:ct[ct.selectedIndex][dt]};let st=nt(!1);const rt=at=>{const dt=at.target.options;return Array.prototype.map.call(dt,ct=>({displayValue:ct.textContent,exportValue:ct.value}))};return this.enableScripting&&this.hasJSActions?(x.addEventListener("updatefromsandbox",at=>{const dt={value(ct){B==null||B();const mt=ct.detail.value,gt=new Set(Array.isArray(mt)?mt:[mt]);for(const Et of x.options)Et.selected=gt.has(Et.value);e.setValue(h,{value:nt(!0)}),st=nt(!1)},multipleSelection(ct){x.multiple=!0},remove(ct){const mt=x.options,gt=ct.detail.remove;mt[gt].selected=!1,x.remove(gt),mt.length>0&&Array.prototype.findIndex.call(mt,At=>At.selected)===-1&&(mt[0].selected=!0),e.setValue(h,{value:nt(!0),items:rt(ct)}),st=nt(!1)},clear(ct){for(;x.length!==0;)x.remove(0);e.setValue(h,{value:null,items:[]}),st=nt(!1)},insert(ct){const{index:mt,displayValue:gt,exportValue:Et}=ct.detail.insert,At=x.children[mt],xt=document.createElement("option");xt.textContent=gt,xt.value=Et,At?At.before(xt):x.append(xt),e.setValue(h,{value:nt(!0),items:rt(ct)}),st=nt(!1)},items(ct){const{items:mt}=ct.detail;for(;x.length!==0;)x.remove(0);for(const gt of mt){const{displayValue:Et,exportValue:At}=gt,xt=document.createElement("option");xt.textContent=Et,xt.value=At,x.append(xt)}x.options.length>0&&(x.options[0].selected=!0),e.setValue(h,{value:nt(!0),items:rt(ct)}),st=nt(!1)},indices(ct){const mt=new Set(ct.detail.indices);for(const gt of ct.target.options)gt.selected=mt.has(gt.index);e.setValue(h,{value:nt(!0)}),st=nt(!1)},editable(ct){ct.target.disabled=!ct.detail.editable}};this._dispatchEventFromSandbox(dt,at)}),x.addEventListener("input",at=>{var ct;const dt=nt(!0);e.setValue(h,{value:dt}),at.preventDefault(),(ct=this.linkService.eventBus)==null||ct.dispatch("dispatcheventinsandbox",{source:this,detail:{id:h,name:"Keystroke",value:st,changeEx:dt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(x,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],at=>at.target.value)):x.addEventListener("input",function(at){e.setValue(h,{value:nt(!0)})}),this.data.combo&&this._setTextStyle(x),this._setBackgroundColor(x),this._setDefaultPropertiesFromJS(x),this.container.append(x),this.container}}const O=class extends A{constructor(e){var x,I,B;const{data:h}=e,b=!O.IGNORE_TYPES.has(h.parentType)&&!!((x=h.titleObj)!=null&&x.str||(I=h.contentsObj)!=null&&I.str||(B=h.richText)!=null&&B.str);super(e,{isRenderable:b})}render(){this.container.classList.add("popupAnnotation");const e=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(e.length===0)return this.container;const h=new o({container:this.container,trigger:Array.from(e),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),b=this.page,x=l.Util.normalizeRect([this.data.parentRect[0],b.view[3]-this.data.parentRect[1]+b.view[1],this.data.parentRect[2],b.view[3]-this.data.parentRect[3]+b.view[1]]),I=x[0]+this.data.parentRect[2]-this.data.parentRect[0],B=x[1],{pageWidth:nt,pageHeight:st,pageX:rt,pageY:at}=this.viewport.rawDims;return this.container.style.left=`${100*(I-rt)/nt}%`,this.container.style.top=`${100*(B-at)/st}%`,this.container.append(h.render()),this.container}};let c=O;Dt(c,"IGNORE_TYPES",new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]));class o{constructor(e){this.container=e.container,this.trigger=e.trigger,this.color=e.color,this.titleObj=e.titleObj,this.modificationDate=e.modificationDate,this.contentsObj=e.contentsObj,this.richText=e.richText,this.hideWrapper=e.hideWrapper||!1,this.pinned=!1}render(){var nt,st;const h=document.createElement("div");h.classList.add("popupWrapper"),this.hideElement=this.hideWrapper?h:this.container,this.hideElement.hidden=!0;const b=document.createElement("div");b.classList.add("popup");const x=this.color;if(x){const rt=.7*(255-x[0])+x[0],at=.7*(255-x[1])+x[1],dt=.7*(255-x[2])+x[2];b.style.backgroundColor=l.Util.makeHexColor(rt|0,at|0,dt|0)}const I=document.createElement("h1");I.dir=this.titleObj.dir,I.textContent=this.titleObj.str,b.append(I);const B=S.PDFDateString.toDateObject(this.modificationDate);if(B){const rt=document.createElement("span");rt.classList.add("popupDate"),rt.textContent="{{date}}, {{time}}",rt.dataset.l10nId="annotation_date_string",rt.dataset.l10nArgs=JSON.stringify({date:B.toLocaleDateString(),time:B.toLocaleTimeString()}),b.append(rt)}if((nt=this.richText)!=null&&nt.str&&(!((st=this.contentsObj)!=null&&st.str)||this.contentsObj.str===this.richText.str))J.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:b}),b.lastChild.classList.add("richText","popupContent");else{const rt=this._formatContents(this.contentsObj);b.append(rt)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const rt of this.trigger)rt.addEventListener("click",this._toggle.bind(this)),rt.addEventListener("mouseover",this._show.bind(this,!1)),rt.addEventListener("mouseout",this._hide.bind(this,!1));return b.addEventListener("click",this._hide.bind(this,!0)),h.append(b),h}_formatContents({str:e,dir:h}){const b=document.createElement("p");b.classList.add("popupContent"),b.dir=h;const x=e.split(/(?:\r\n?|\n)/);for(let I=0,B=x.length;I<B;++I){const nt=x[I];b.append(document.createTextNode(nt)),I<B-1&&b.append(document.createElement("br"))}return b}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(e=!1){e&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(e=!0){e&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class n extends A{constructor(e){var b,x,I;const h=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:h,ignoreBorder:!0}),this.textContent=e.data.textContent}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const h of this.textContent){const b=document.createElement("span");b.textContent=h,e.append(b)}this.container.append(e)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class u extends A{constructor(e){var b,x,I;const h=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:h,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:h,height:b}=w(e.rect),x=this.svgFactory.create(h,b,!0),I=this.svgFactory.createElement("svg:line");return I.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),I.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),I.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),I.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),I.setAttribute("stroke-width",e.borderStyle.width||1),I.setAttribute("stroke","transparent"),I.setAttribute("fill","transparent"),x.append(I),this.container.append(x),this._createPopup(I,e),this.container}}class T extends A{constructor(e){var b,x,I;const h=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:h,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:h,height:b}=w(e.rect),x=this.svgFactory.create(h,b,!0),I=e.borderStyle.width,B=this.svgFactory.createElement("svg:rect");return B.setAttribute("x",I/2),B.setAttribute("y",I/2),B.setAttribute("width",h-I),B.setAttribute("height",b-I),B.setAttribute("stroke-width",I||1),B.setAttribute("stroke","transparent"),B.setAttribute("fill","transparent"),x.append(B),this.container.append(x),this._createPopup(B,e),this.container}}class a extends A{constructor(e){var b,x,I;const h=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:h,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:h,height:b}=w(e.rect),x=this.svgFactory.create(h,b,!0),I=e.borderStyle.width,B=this.svgFactory.createElement("svg:ellipse");return B.setAttribute("cx",h/2),B.setAttribute("cy",b/2),B.setAttribute("rx",h/2-I/2),B.setAttribute("ry",b/2-I/2),B.setAttribute("stroke-width",I||1),B.setAttribute("stroke","transparent"),B.setAttribute("fill","transparent"),x.append(B),this.container.append(x),this._createPopup(B,e),this.container}}class D extends A{constructor(e){var b,x,I;const h=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:h,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:h,height:b}=w(e.rect),x=this.svgFactory.create(h,b,!0);let I=[];for(const nt of e.vertices){const st=nt.x-e.rect[0],rt=e.rect[3]-nt.y;I.push(st+","+rt)}I=I.join(" ");const B=this.svgFactory.createElement(this.svgElementName);return B.setAttribute("points",I),B.setAttribute("stroke-width",e.borderStyle.width||1),B.setAttribute("stroke","transparent"),B.setAttribute("fill","transparent"),x.append(B),this.container.append(x),this._createPopup(B,e),this.container}}class $ extends D{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Y extends A{constructor(e){var b,x,I;const h=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:h,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class tt extends A{constructor(e){var b,x,I;const h=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:h,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:h,height:b}=w(e.rect),x=this.svgFactory.create(h,b,!0);for(const I of e.inkLists){let B=[];for(const st of I){const rt=st.x-e.rect[0],at=e.rect[3]-st.y;B.push(`${rt},${at}`)}B=B.join(" ");const nt=this.svgFactory.createElement(this.svgElementName);nt.setAttribute("points",B),nt.setAttribute("stroke-width",e.borderStyle.width||1),nt.setAttribute("stroke","transparent"),nt.setAttribute("fill","transparent"),this._createPopup(nt,e),x.append(nt)}return this.container.append(x),this.container}}class it extends A{constructor(e){var b,x,I;const h=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:h,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.classList.add("highlightAnnotation"),this.container)}}class ut extends A{constructor(e){var b,x,I;const h=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:h,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.classList.add("underlineAnnotation"),this.container)}}class lt extends A{constructor(e){var b,x,I;const h=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:h,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.classList.add("squigglyAnnotation"),this.container)}}class ft extends A{constructor(e){var b,x,I;const h=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:h,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.classList.add("strikeoutAnnotation"),this.container)}}class bt extends A{constructor(e){var b,x,I;const h=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(x=e.data.contentsObj)!=null&&x.str||(I=e.data.richText)!=null&&I.str);super(e,{isRenderable:h,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class yt extends A{constructor(e){var x;super(e,{isRenderable:!0});const{filename:h,content:b}=this.data.file;this.filename=(0,S.getFilenameFromUrl)(h,!0),this.content=b,(x=this.linkService.eventBus)==null||x.dispatch("fileattachmentannotation",{source:this,filename:h,content:b})}render(){var h,b;this.container.classList.add("fileAttachmentAnnotation");let e;return this.data.hasAppearance?e=document.createElement("div"):(e=document.createElement("img"),e.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),e.classList.add("popupTriggerArea"),e.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((h=this.data.titleObj)!=null&&h.str||(b=this.data.contentsObj)!=null&&b.str||this.data.richText)&&this._createPopup(e,this.data),this.container.append(e),this.container}_download(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.container,this.content,this.filename)}}const j=class{static render(e){var st,rt;const{annotations:h,div:b,viewport:x,accessibilityManager:I}=e;(0,S.setLayerDimensions)(b,x);const B={data:null,layer:b,page:e.page,viewport:x,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new S.DOMSVGFactory,annotationStorage:e.annotationStorage||new W.AnnotationStorage,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects};let nt=0;for(const at of h){if(at.noHTML)continue;if(at.annotationType!==l.AnnotationType.POPUP){const{width:mt,height:gt}=w(at.rect);if(mt<=0||gt<=0)continue}B.data=at;const dt=y.create(B);if(!dt.isRenderable)continue;const ct=dt.render();if(at.hidden&&(ct.style.visibility="hidden"),Array.isArray(ct))for(const mt of ct)mt.style.zIndex=nt++,ot(st=j,X,ke).call(st,mt,at.id,b,I);else ct.style.zIndex=nt++,dt instanceof c?b.prepend(ct):ot(rt=j,X,ke).call(rt,ct,at.id,b,I)}ot(this,Q,Pe).call(this,b,e.annotationCanvasMap)}static update(e){const{annotationCanvasMap:h,div:b,viewport:x}=e;(0,S.setLayerDimensions)(b,{rotation:x.rotation}),ot(this,Q,Pe).call(this,b,h),b.hidden=!1}};let G=j;X=new WeakSet,ke=function(e,h,b,x){const I=e.firstChild||e;I.id=`${S.AnnotationPrefix}${h}`,b.append(e),x==null||x.moveElementInDOM(b,e,I,!1)},Q=new WeakSet,Pe=function(e,h){if(h){for(const[b,x]of h){const I=e.querySelector(`[data-annotation-id="${b}"]`);if(!I)continue;const{firstChild:B}=I;B?B.nodeName==="CANVAS"?B.replaceWith(x):B.before(x):I.append(x)}h.clear()}},et(G,X),et(G,Q),i.AnnotationLayer=G},(K,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ColorConverters=void 0;function L(S){return Math.floor(Math.max(0,Math.min(1,S))*255).toString(16).padStart(2,"0")}class l{static CMYK_G([W,N,J,R]){return["G",1-Math.min(1,.3*W+.59*J+.11*N+R)]}static G_CMYK([W]){return["CMYK",0,0,0,1-W]}static G_RGB([W]){return["RGB",W,W,W]}static G_HTML([W]){const N=L(W);return`#${N}${N}${N}`}static RGB_G([W,N,J]){return["G",.3*W+.59*N+.11*J]}static RGB_HTML([W,N,J]){const R=L(W),C=L(N),_=L(J);return`#${R}${C}${_}`}static T_HTML(){return"#00000000"}static CMYK_RGB([W,N,J,R]){return["RGB",1-Math.min(1,W+R),1-Math.min(1,J+R),1-Math.min(1,N+R)]}static CMYK_HTML(W){const N=this.CMYK_RGB(W).slice(1);return this.RGB_HTML(N)}static RGB_CMYK([W,N,J]){const R=1-W,C=1-N,_=1-J,w=Math.min(R,C,_);return["CMYK",R,C,_,w]}}i.ColorConverters=l},(K,i,L)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.XfaLayer=void 0;var l=L(19);class S{static setupStorage(N,J,R,C,_){const w=C.getValue(J,{value:null});switch(R.name){case"textarea":if(w.value!==null&&(N.textContent=w.value),_==="print")break;N.addEventListener("input",y=>{C.setValue(J,{value:y.target.value})});break;case"input":if(R.attributes.type==="radio"||R.attributes.type==="checkbox"){if(w.value===R.attributes.xfaOn?N.setAttribute("checked",!0):w.value===R.attributes.xfaOff&&N.removeAttribute("checked"),_==="print")break;N.addEventListener("change",y=>{C.setValue(J,{value:y.target.checked?y.target.getAttribute("xfaOn"):y.target.getAttribute("xfaOff")})})}else{if(w.value!==null&&N.setAttribute("value",w.value),_==="print")break;N.addEventListener("input",y=>{C.setValue(J,{value:y.target.value})})}break;case"select":if(w.value!==null)for(const y of R.children)y.attributes.value===w.value&&(y.attributes.selected=!0);N.addEventListener("input",y=>{const A=y.target.options,d=A.selectedIndex===-1?"":A[A.selectedIndex].value;C.setValue(J,{value:d})});break}}static setAttributes({html:N,element:J,storage:R=null,intent:C,linkService:_}){const{attributes:w}=J,y=N instanceof HTMLAnchorElement;w.type==="radio"&&(w.name=`${w.name}-${C}`);for(const[A,d]of Object.entries(w))if(d!=null)switch(A){case"class":d.length&&N.setAttribute(A,d.join(" "));break;case"dataId":break;case"id":N.setAttribute("data-element-id",d);break;case"style":Object.assign(N.style,d);break;case"textContent":N.textContent=d;break;default:(!y||A!=="href"&&A!=="newWindow")&&N.setAttribute(A,d)}y&&_.addLinkAttributes(N,w.href,w.newWindow),R&&w.dataId&&this.setupStorage(N,w.dataId,J,R)}static render(N){var g;const J=N.annotationStorage,R=N.linkService,C=N.xfaHtml,_=N.intent||"display",w=document.createElement(C.name);C.attributes&&this.setAttributes({html:w,element:C,intent:_,linkService:R});const y=[[C,-1,w]],A=N.div;if(A.append(w),N.viewport){const s=`matrix(${N.viewport.transform.join(",")})`;A.style.transform=s}_!=="richText"&&A.setAttribute("class","xfaLayer xfaFont");const d=[];for(;y.length>0;){const[s,r,k]=y.at(-1);if(r+1===s.children.length){y.pop();continue}const M=s.children[++y.at(-1)[1]];if(M===null)continue;const{name:v}=M;if(v==="#text"){const c=document.createTextNode(M.value);d.push(c),k.append(c);continue}let t;if((g=M==null?void 0:M.attributes)!=null&&g.xmlns?t=document.createElementNS(M.attributes.xmlns,v):t=document.createElement(v),k.append(t),M.attributes&&this.setAttributes({html:t,element:M,storage:J,intent:_,linkService:R}),M.children&&M.children.length>0)y.push([M,-1,t]);else if(M.value){const c=document.createTextNode(M.value);l.XfaText.shouldBuildText(v)&&d.push(c),t.append(c)}}for(const s of A.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))s.setAttribute("readOnly",!0);return{textDivs:d}}static update(N){const J=`matrix(${N.viewport.transform.join(",")})`;N.div.style.transform=J,N.div.hidden=!1}}i.XfaLayer=S},(K,i,L)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.SVGGraphics=void 0;var l=L(6),S=L(1),W=L(10);let N=class{constructor(){(0,S.unreachable)("Not implemented: SVGGraphics")}};i.SVGGraphics=N;{let g=function(t){let c=[];const o=[];for(const n of t){if(n.fn==="save"){c.push({fnId:92,fn:"group",items:[]}),o.push(c),c=c.at(-1).items;continue}n.fn==="restore"?c=o.pop():c.push(n)}return c},s=function(t){if(Number.isInteger(t))return t.toString();const c=t.toFixed(10);let o=c.length-1;if(c[o]!=="0")return c;do o--;while(c[o]==="0");return c.substring(0,c[o]==="."?o:o+1)},r=function(t){if(t[4]===0&&t[5]===0){if(t[1]===0&&t[2]===0)return t[0]===1&&t[3]===1?"":`scale(${s(t[0])} ${s(t[3])})`;if(t[0]===t[3]&&t[1]===-t[2]){const c=Math.acos(t[0])*180/Math.PI;return`rotate(${s(c)})`}}else if(t[0]===1&&t[1]===0&&t[2]===0&&t[3]===1)return`translate(${s(t[4])} ${s(t[5])})`;return`matrix(${s(t[0])} ${s(t[1])} ${s(t[2])} ${s(t[3])} ${s(t[4])} ${s(t[5])})`};const J={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},R="http://www.w3.org/XML/1998/namespace",C="http://www.w3.org/1999/xlink",_=["butt","round","square"],w=["miter","round","bevel"],y=function(t,c="",o=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!o)return URL.createObjectURL(new Blob([t],{type:c}));const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let u=`data:${c};base64,`;for(let T=0,a=t.length;T<a;T+=3){const D=t[T]&255,$=t[T+1]&255,Y=t[T+2]&255,tt=D>>2,it=(D&3)<<4|$>>4,ut=T+1<a?($&15)<<2|Y>>6:64,lt=T+2<a?Y&63:64;u+=n[tt]+n[it]+n[ut]+n[lt]}return u},A=function(){const t=new Uint8Array([137,80,78,71,13,10,26,10]),c=12,o=new Int32Array(256);for(let Y=0;Y<256;Y++){let tt=Y;for(let it=0;it<8;it++)tt&1?tt=3988292384^tt>>1&2147483647:tt=tt>>1&2147483647;o[Y]=tt}function n(Y,tt,it){let ut=-1;for(let lt=tt;lt<it;lt++){const ft=(ut^Y[lt])&255,bt=o[ft];ut=ut>>>8^bt}return ut^-1}function u(Y,tt,it,ut){let lt=ut;const ft=tt.length;it[lt]=ft>>24&255,it[lt+1]=ft>>16&255,it[lt+2]=ft>>8&255,it[lt+3]=ft&255,lt+=4,it[lt]=Y.charCodeAt(0)&255,it[lt+1]=Y.charCodeAt(1)&255,it[lt+2]=Y.charCodeAt(2)&255,it[lt+3]=Y.charCodeAt(3)&255,lt+=4,it.set(tt,lt),lt+=tt.length;const bt=n(it,ut+4,lt);it[lt]=bt>>24&255,it[lt+1]=bt>>16&255,it[lt+2]=bt>>8&255,it[lt+3]=bt&255}function T(Y,tt,it){let ut=1,lt=0;for(let ft=tt;ft<it;++ft)ut=(ut+(Y[ft]&255))%65521,lt=(lt+ut)%65521;return lt<<16|ut}function a(Y){if(!W.isNodeJS)return D(Y);try{let tt;parseInt(process.versions.node)>=8?tt=Y:tt=Buffer.from(Y);const it=require$$5.deflateSync(tt,{level:9});return it instanceof Uint8Array?it:new Uint8Array(it)}catch(tt){(0,S.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+tt)}return D(Y)}function D(Y){let tt=Y.length;const it=65535,ut=Math.ceil(tt/it),lt=new Uint8Array(2+tt+ut*5+4);let ft=0;lt[ft++]=120,lt[ft++]=156;let bt=0;for(;tt>it;)lt[ft++]=0,lt[ft++]=255,lt[ft++]=255,lt[ft++]=0,lt[ft++]=0,lt.set(Y.subarray(bt,bt+it),ft),ft+=it,bt+=it,tt-=it;lt[ft++]=1,lt[ft++]=tt&255,lt[ft++]=tt>>8&255,lt[ft++]=~tt&65535&255,lt[ft++]=(~tt&65535)>>8&255,lt.set(Y.subarray(bt),ft),ft+=Y.length-bt;const yt=T(Y,0,Y.length);return lt[ft++]=yt>>24&255,lt[ft++]=yt>>16&255,lt[ft++]=yt>>8&255,lt[ft++]=yt&255,lt}function $(Y,tt,it,ut){const lt=Y.width,ft=Y.height;let bt,yt,G;const f=Y.data;switch(tt){case S.ImageKind.GRAYSCALE_1BPP:yt=0,bt=1,G=lt+7>>3;break;case S.ImageKind.RGB_24BPP:yt=2,bt=8,G=lt*3;break;case S.ImageKind.RGBA_32BPP:yt=6,bt=8,G=lt*4;break;default:throw new Error("invalid format")}const p=new Uint8Array((1+G)*ft);let E=0,U=0;for(let j=0;j<ft;++j)p[E++]=0,p.set(f.subarray(U,U+G),E),U+=G,E+=G;if(tt===S.ImageKind.GRAYSCALE_1BPP&&ut){E=0;for(let j=0;j<ft;j++){E++;for(let F=0;F<G;F++)p[E++]^=255}}const O=new Uint8Array([lt>>24&255,lt>>16&255,lt>>8&255,lt&255,ft>>24&255,ft>>16&255,ft>>8&255,ft&255,bt,yt,0,0,0]),X=a(p),V=t.length+c*3+O.length+X.length,Q=new Uint8Array(V);let z=0;return Q.set(t,z),z+=t.length,u("IHDR",O,Q,z),z+=c+O.length,u("IDATA",X,Q,z),z+=c+X.length,u("IEND",new Uint8Array(0),Q,z),y(Q,"image/png",it)}return function(tt,it,ut){const lt=tt.kind===void 0?S.ImageKind.GRAYSCALE_1BPP:tt.kind;return $(tt,lt,it,ut)}}();class d{constructor(){this.fontSizeScale=1,this.fontWeight=J.fontWeight,this.fontSize=0,this.textMatrix=S.IDENTITY_MATRIX,this.fontMatrix=S.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=S.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=J.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(c,o){this.x=c,this.y=o}}let k=0,M=0,v=0;i.SVGGraphics=N=class{constructor(t,c,o=!1){(0,l.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new l.DOMSVGFactory,this.current=new d,this.transformMatrix=S.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=t,this.objs=c,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!o,this._operatorIdMapping=[];for(const n in S.OPS)this._operatorIdMapping[S.OPS[n]]=n}getObject(t,c=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):c}save(){this.transformStack.push(this.transformMatrix);const t=this.current;this.extraStack.push(t),this.current=t.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(t){this.save(),this.executeOpTree(t),this.restore()}loadDependencies(t){const c=t.fnArray,o=t.argsArray;for(let n=0,u=c.length;n<u;n++)if(c[n]===S.OPS.dependency)for(const T of o[n]){const a=T.startsWith("g_")?this.commonObjs:this.objs,D=new Promise($=>{a.get(T,$)});this.current.dependencies.push(D)}return Promise.all(this.current.dependencies)}transform(t,c,o,n,u,T){const a=[t,c,o,n,u,T];this.transformMatrix=S.Util.transform(this.transformMatrix,a),this.tgrp=null}getSVG(t,c){this.viewport=c;const o=this._initialize(c);return this.loadDependencies(t).then(()=>(this.transformMatrix=S.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(t)),o))}convertOpList(t){const c=this._operatorIdMapping,o=t.argsArray,n=t.fnArray,u=[];for(let T=0,a=n.length;T<a;T++){const D=n[T];u.push({fnId:D,fn:c[D],args:o[T]})}return g(u)}executeOpTree(t){for(const c of t){const o=c.fn,n=c.fnId,u=c.args;switch(n|0){case S.OPS.beginText:this.beginText();break;case S.OPS.dependency:break;case S.OPS.setLeading:this.setLeading(u);break;case S.OPS.setLeadingMoveText:this.setLeadingMoveText(u[0],u[1]);break;case S.OPS.setFont:this.setFont(u);break;case S.OPS.showText:this.showText(u[0]);break;case S.OPS.showSpacedText:this.showText(u[0]);break;case S.OPS.endText:this.endText();break;case S.OPS.moveText:this.moveText(u[0],u[1]);break;case S.OPS.setCharSpacing:this.setCharSpacing(u[0]);break;case S.OPS.setWordSpacing:this.setWordSpacing(u[0]);break;case S.OPS.setHScale:this.setHScale(u[0]);break;case S.OPS.setTextMatrix:this.setTextMatrix(u[0],u[1],u[2],u[3],u[4],u[5]);break;case S.OPS.setTextRise:this.setTextRise(u[0]);break;case S.OPS.setTextRenderingMode:this.setTextRenderingMode(u[0]);break;case S.OPS.setLineWidth:this.setLineWidth(u[0]);break;case S.OPS.setLineJoin:this.setLineJoin(u[0]);break;case S.OPS.setLineCap:this.setLineCap(u[0]);break;case S.OPS.setMiterLimit:this.setMiterLimit(u[0]);break;case S.OPS.setFillRGBColor:this.setFillRGBColor(u[0],u[1],u[2]);break;case S.OPS.setStrokeRGBColor:this.setStrokeRGBColor(u[0],u[1],u[2]);break;case S.OPS.setStrokeColorN:this.setStrokeColorN(u);break;case S.OPS.setFillColorN:this.setFillColorN(u);break;case S.OPS.shadingFill:this.shadingFill(u[0]);break;case S.OPS.setDash:this.setDash(u[0],u[1]);break;case S.OPS.setRenderingIntent:this.setRenderingIntent(u[0]);break;case S.OPS.setFlatness:this.setFlatness(u[0]);break;case S.OPS.setGState:this.setGState(u[0]);break;case S.OPS.fill:this.fill();break;case S.OPS.eoFill:this.eoFill();break;case S.OPS.stroke:this.stroke();break;case S.OPS.fillStroke:this.fillStroke();break;case S.OPS.eoFillStroke:this.eoFillStroke();break;case S.OPS.clip:this.clip("nonzero");break;case S.OPS.eoClip:this.clip("evenodd");break;case S.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case S.OPS.paintImageXObject:this.paintImageXObject(u[0]);break;case S.OPS.paintInlineImageXObject:this.paintInlineImageXObject(u[0]);break;case S.OPS.paintImageMaskXObject:this.paintImageMaskXObject(u[0]);break;case S.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(u[0],u[1]);break;case S.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case S.OPS.closePath:this.closePath();break;case S.OPS.closeStroke:this.closeStroke();break;case S.OPS.closeFillStroke:this.closeFillStroke();break;case S.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case S.OPS.nextLine:this.nextLine();break;case S.OPS.transform:this.transform(u[0],u[1],u[2],u[3],u[4],u[5]);break;case S.OPS.constructPath:this.constructPath(u[0],u[1]);break;case S.OPS.endPath:this.endPath();break;case 92:this.group(c.items);break;default:(0,S.warn)(`Unimplemented operator ${o}`);break}}}setWordSpacing(t){this.current.wordSpacing=t}setCharSpacing(t){this.current.charSpacing=t}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(t,c,o,n,u,T){const a=this.current;a.textMatrix=a.lineMatrix=[t,c,o,n,u,T],a.textMatrixScale=Math.hypot(t,c),a.x=a.lineX=0,a.y=a.lineY=0,a.xcoords=[],a.ycoords=[],a.tspan=this.svgFactory.createElement("svg:tspan"),a.tspan.setAttributeNS(null,"font-family",a.fontFamily),a.tspan.setAttributeNS(null,"font-size",`${s(a.fontSize)}px`),a.tspan.setAttributeNS(null,"y",s(-a.y)),a.txtElement=this.svgFactory.createElement("svg:text"),a.txtElement.append(a.tspan)}beginText(){const t=this.current;t.x=t.lineX=0,t.y=t.lineY=0,t.textMatrix=S.IDENTITY_MATRIX,t.lineMatrix=S.IDENTITY_MATRIX,t.textMatrixScale=1,t.tspan=this.svgFactory.createElement("svg:tspan"),t.txtElement=this.svgFactory.createElement("svg:text"),t.txtgrp=this.svgFactory.createElement("svg:g"),t.xcoords=[],t.ycoords=[]}moveText(t,c){const o=this.current;o.x=o.lineX+=t,o.y=o.lineY+=c,o.xcoords=[],o.ycoords=[],o.tspan=this.svgFactory.createElement("svg:tspan"),o.tspan.setAttributeNS(null,"font-family",o.fontFamily),o.tspan.setAttributeNS(null,"font-size",`${s(o.fontSize)}px`),o.tspan.setAttributeNS(null,"y",s(-o.y))}showText(t){const c=this.current,o=c.font,n=c.fontSize;if(n===0)return;const u=c.fontSizeScale,T=c.charSpacing,a=c.wordSpacing,D=c.fontDirection,$=c.textHScale*D,Y=o.vertical,tt=Y?1:-1,it=o.defaultVMetrics,ut=n*c.fontMatrix[0];let lt=0;for(const yt of t){if(yt===null){lt+=D*a;continue}else if(typeof yt=="number"){lt+=tt*yt*n/1e3;continue}const G=(yt.isSpace?a:0)+T,f=yt.fontChar;let p,E,U=yt.width;if(Y){let X;const V=yt.vmetric||it;X=yt.vmetric?V[1]:U*.5,X=-X*ut;const Q=V[2]*ut;U=V?-V[0]:U,p=X/u,E=(lt+Q)/u}else p=lt/u,E=0;(yt.isInFont||o.missingFile)&&(c.xcoords.push(c.x+p),Y&&c.ycoords.push(-c.y+E),c.tspan.textContent+=f);let O;Y?O=U*ut-G*D:O=U*ut+G*D,lt+=O}c.tspan.setAttributeNS(null,"x",c.xcoords.map(s).join(" ")),Y?c.tspan.setAttributeNS(null,"y",c.ycoords.map(s).join(" ")):c.tspan.setAttributeNS(null,"y",s(-c.y)),Y?c.y-=lt:c.x+=lt*$,c.tspan.setAttributeNS(null,"font-family",c.fontFamily),c.tspan.setAttributeNS(null,"font-size",`${s(c.fontSize)}px`),c.fontStyle!==J.fontStyle&&c.tspan.setAttributeNS(null,"font-style",c.fontStyle),c.fontWeight!==J.fontWeight&&c.tspan.setAttributeNS(null,"font-weight",c.fontWeight);const ft=c.textRenderingMode&S.TextRenderingMode.FILL_STROKE_MASK;if(ft===S.TextRenderingMode.FILL||ft===S.TextRenderingMode.FILL_STROKE?(c.fillColor!==J.fillColor&&c.tspan.setAttributeNS(null,"fill",c.fillColor),c.fillAlpha<1&&c.tspan.setAttributeNS(null,"fill-opacity",c.fillAlpha)):c.textRenderingMode===S.TextRenderingMode.ADD_TO_PATH?c.tspan.setAttributeNS(null,"fill","transparent"):c.tspan.setAttributeNS(null,"fill","none"),ft===S.TextRenderingMode.STROKE||ft===S.TextRenderingMode.FILL_STROKE){const yt=1/(c.textMatrixScale||1);this._setStrokeAttributes(c.tspan,yt)}let bt=c.textMatrix;c.textRise!==0&&(bt=bt.slice(),bt[5]+=c.textRise),c.txtElement.setAttributeNS(null,"transform",`${r(bt)} scale(${s($)}, -1)`),c.txtElement.setAttributeNS(R,"xml:space","preserve"),c.txtElement.append(c.tspan),c.txtgrp.append(c.txtElement),this._ensureTransformGroup().append(c.txtElement)}setLeadingMoveText(t,c){this.setLeading(-c),this.moveText(t,c)}addFontStyle(t){if(!t.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const c=y(t.data,t.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${t.loadedName}"; src: url(${c}); }
`}setFont(t){const c=this.current,o=this.commonObjs.get(t[0]);let n=t[1];c.font=o,this.embedFonts&&!o.missingFile&&!this.embeddedFonts[o.loadedName]&&(this.addFontStyle(o),this.embeddedFonts[o.loadedName]=o),c.fontMatrix=o.fontMatrix||S.FONT_IDENTITY_MATRIX;let u="normal";o.black?u="900":o.bold&&(u="bold");const T=o.italic?"italic":"normal";n<0?(n=-n,c.fontDirection=-1):c.fontDirection=1,c.fontSize=n,c.fontFamily=o.loadedName,c.fontWeight=u,c.fontStyle=T,c.tspan=this.svgFactory.createElement("svg:tspan"),c.tspan.setAttributeNS(null,"y",s(-c.y)),c.xcoords=[],c.ycoords=[]}endText(){var c;const t=this.current;t.textRenderingMode&S.TextRenderingMode.ADD_TO_PATH_FLAG&&((c=t.txtElement)!=null&&c.hasChildNodes())&&(t.element=t.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(t){t>0&&(this.current.lineWidth=t)}setLineCap(t){this.current.lineCap=_[t]}setLineJoin(t){this.current.lineJoin=w[t]}setMiterLimit(t){this.current.miterLimit=t}setStrokeAlpha(t){this.current.strokeAlpha=t}setStrokeRGBColor(t,c,o){this.current.strokeColor=S.Util.makeHexColor(t,c,o)}setFillAlpha(t){this.current.fillAlpha=t}setFillRGBColor(t,c,o){this.current.fillColor=S.Util.makeHexColor(t,c,o),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(t){this.current.strokeColor=this._makeColorN_Pattern(t)}setFillColorN(t){this.current.fillColor=this._makeColorN_Pattern(t)}shadingFill(t){const c=this.viewport.width,o=this.viewport.height,n=S.Util.inverseTransform(this.transformMatrix),u=S.Util.applyTransform([0,0],n),T=S.Util.applyTransform([0,o],n),a=S.Util.applyTransform([c,0],n),D=S.Util.applyTransform([c,o],n),$=Math.min(u[0],T[0],a[0],D[0]),Y=Math.min(u[1],T[1],a[1],D[1]),tt=Math.max(u[0],T[0],a[0],D[0]),it=Math.max(u[1],T[1],a[1],D[1]),ut=this.svgFactory.createElement("svg:rect");ut.setAttributeNS(null,"x",$),ut.setAttributeNS(null,"y",Y),ut.setAttributeNS(null,"width",tt-$),ut.setAttributeNS(null,"height",it-Y),ut.setAttributeNS(null,"fill",this._makeShadingPattern(t)),this.current.fillAlpha<1&&ut.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(ut)}_makeColorN_Pattern(t){return t[0]==="TilingPattern"?this._makeTilingPattern(t):this._makeShadingPattern(t)}_makeTilingPattern(t){const c=t[1],o=t[2],n=t[3]||S.IDENTITY_MATRIX,[u,T,a,D]=t[4],$=t[5],Y=t[6],tt=t[7],it=`shading${v++}`,[ut,lt,ft,bt]=S.Util.normalizeRect([...S.Util.applyTransform([u,T],n),...S.Util.applyTransform([a,D],n)]),[yt,G]=S.Util.singularValueDecompose2dScale(n),f=$*yt,p=Y*G,E=this.svgFactory.createElement("svg:pattern");E.setAttributeNS(null,"id",it),E.setAttributeNS(null,"patternUnits","userSpaceOnUse"),E.setAttributeNS(null,"width",f),E.setAttributeNS(null,"height",p),E.setAttributeNS(null,"x",`${ut}`),E.setAttributeNS(null,"y",`${lt}`);const U=this.svg,O=this.transformMatrix,X=this.current.fillColor,V=this.current.strokeColor,Q=this.svgFactory.create(ft-ut,bt-lt);if(this.svg=Q,this.transformMatrix=n,tt===2){const z=S.Util.makeHexColor(...c);this.current.fillColor=z,this.current.strokeColor=z}return this.executeOpTree(this.convertOpList(o)),this.svg=U,this.transformMatrix=O,this.current.fillColor=X,this.current.strokeColor=V,E.append(Q.childNodes[0]),this.defs.append(E),`url(#${it})`}_makeShadingPattern(t){switch(typeof t=="string"&&(t=this.objs.get(t)),t[0]){case"RadialAxial":const c=`shading${v++}`,o=t[3];let n;switch(t[1]){case"axial":const u=t[4],T=t[5];n=this.svgFactory.createElement("svg:linearGradient"),n.setAttributeNS(null,"id",c),n.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),n.setAttributeNS(null,"x1",u[0]),n.setAttributeNS(null,"y1",u[1]),n.setAttributeNS(null,"x2",T[0]),n.setAttributeNS(null,"y2",T[1]);break;case"radial":const a=t[4],D=t[5],$=t[6],Y=t[7];n=this.svgFactory.createElement("svg:radialGradient"),n.setAttributeNS(null,"id",c),n.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),n.setAttributeNS(null,"cx",D[0]),n.setAttributeNS(null,"cy",D[1]),n.setAttributeNS(null,"r",Y),n.setAttributeNS(null,"fx",a[0]),n.setAttributeNS(null,"fy",a[1]),n.setAttributeNS(null,"fr",$);break;default:throw new Error(`Unknown RadialAxial type: ${t[1]}`)}for(const u of o){const T=this.svgFactory.createElement("svg:stop");T.setAttributeNS(null,"offset",u[0]),T.setAttributeNS(null,"stop-color",u[1]),n.append(T)}return this.defs.append(n),`url(#${c})`;case"Mesh":return(0,S.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${t[0]}`)}}setDash(t,c){this.current.dashArray=t,this.current.dashPhase=c}constructPath(t,c){const o=this.current;let n=o.x,u=o.y,T=[],a=0;for(const D of t)switch(D|0){case S.OPS.rectangle:n=c[a++],u=c[a++];const $=c[a++],Y=c[a++],tt=n+$,it=u+Y;T.push("M",s(n),s(u),"L",s(tt),s(u),"L",s(tt),s(it),"L",s(n),s(it),"Z");break;case S.OPS.moveTo:n=c[a++],u=c[a++],T.push("M",s(n),s(u));break;case S.OPS.lineTo:n=c[a++],u=c[a++],T.push("L",s(n),s(u));break;case S.OPS.curveTo:n=c[a+4],u=c[a+5],T.push("C",s(c[a]),s(c[a+1]),s(c[a+2]),s(c[a+3]),s(n),s(u)),a+=6;break;case S.OPS.curveTo2:T.push("C",s(n),s(u),s(c[a]),s(c[a+1]),s(c[a+2]),s(c[a+3])),n=c[a+2],u=c[a+3],a+=4;break;case S.OPS.curveTo3:n=c[a+2],u=c[a+3],T.push("C",s(c[a]),s(c[a+1]),s(n),s(u),s(n),s(u)),a+=4;break;case S.OPS.closePath:T.push("Z");break}T=T.join(" "),o.path&&t.length>0&&t[0]!==S.OPS.rectangle&&t[0]!==S.OPS.moveTo?T=o.path.getAttributeNS(null,"d")+T:(o.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(o.path)),o.path.setAttributeNS(null,"d",T),o.path.setAttributeNS(null,"fill","none"),o.element=o.path,o.setCurrentPoint(n,u)}endPath(){const t=this.current;if(t.path=null,!this.pendingClip)return;if(!t.element){this.pendingClip=null;return}const c=`clippath${k++}`,o=this.svgFactory.createElement("svg:clipPath");o.setAttributeNS(null,"id",c),o.setAttributeNS(null,"transform",r(this.transformMatrix));const n=t.element.cloneNode(!0);if(this.pendingClip==="evenodd"?n.setAttributeNS(null,"clip-rule","evenodd"):n.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,o.append(n),this.defs.append(o),t.activeClipUrl){t.clipGroup=null;for(const u of this.extraStack)u.clipGroup=null;o.setAttributeNS(null,"clip-path",t.activeClipUrl)}t.activeClipUrl=`url(#${c})`,this.tgrp=null}clip(t){this.pendingClip=t}closePath(){const t=this.current;if(t.path){const c=`${t.path.getAttributeNS(null,"d")}Z`;t.path.setAttributeNS(null,"d",c)}}setLeading(t){this.current.leading=-t}setTextRise(t){this.current.textRise=t}setTextRenderingMode(t){this.current.textRenderingMode=t}setHScale(t){this.current.textHScale=t/100}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[c,o]of t)switch(c){case"LW":this.setLineWidth(o);break;case"LC":this.setLineCap(o);break;case"LJ":this.setLineJoin(o);break;case"ML":this.setMiterLimit(o);break;case"D":this.setDash(o[0],o[1]);break;case"RI":this.setRenderingIntent(o);break;case"FL":this.setFlatness(o);break;case"Font":this.setFont(o);break;case"CA":this.setStrokeAlpha(o);break;case"ca":this.setFillAlpha(o);break;default:(0,S.warn)(`Unimplemented graphic state operator ${c}`);break}}fill(){const t=this.current;t.element&&(t.element.setAttributeNS(null,"fill",t.fillColor),t.element.setAttributeNS(null,"fill-opacity",t.fillAlpha),this.endPath())}stroke(){const t=this.current;t.element&&(this._setStrokeAttributes(t.element),t.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(t,c=1){const o=this.current;let n=o.dashArray;c!==1&&n.length>0&&(n=n.map(function(u){return c*u})),t.setAttributeNS(null,"stroke",o.strokeColor),t.setAttributeNS(null,"stroke-opacity",o.strokeAlpha),t.setAttributeNS(null,"stroke-miterlimit",s(o.miterLimit)),t.setAttributeNS(null,"stroke-linecap",o.lineCap),t.setAttributeNS(null,"stroke-linejoin",o.lineJoin),t.setAttributeNS(null,"stroke-width",s(c*o.lineWidth)+"px"),t.setAttributeNS(null,"stroke-dasharray",n.map(s).join(" ")),t.setAttributeNS(null,"stroke-dashoffset",s(c*o.dashPhase)+"px")}eoFill(){var t;(t=this.current.element)==null||t.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var t;(t=this.current.element)==null||t.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const t=this.svgFactory.createElement("svg:rect");t.setAttributeNS(null,"x","0"),t.setAttributeNS(null,"y","0"),t.setAttributeNS(null,"width","1px"),t.setAttributeNS(null,"height","1px"),t.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(t)}paintImageXObject(t){const c=this.getObject(t);if(!c){(0,S.warn)(`Dependent image with object ID ${t} is not ready yet`);return}this.paintInlineImageXObject(c)}paintInlineImageXObject(t,c){const o=t.width,n=t.height,u=A(t,this.forceDataSchema,!!c),T=this.svgFactory.createElement("svg:rect");T.setAttributeNS(null,"x","0"),T.setAttributeNS(null,"y","0"),T.setAttributeNS(null,"width",s(o)),T.setAttributeNS(null,"height",s(n)),this.current.element=T,this.clip("nonzero");const a=this.svgFactory.createElement("svg:image");a.setAttributeNS(C,"xlink:href",u),a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y",s(-n)),a.setAttributeNS(null,"width",s(o)+"px"),a.setAttributeNS(null,"height",s(n)+"px"),a.setAttributeNS(null,"transform",`scale(${s(1/o)} ${s(-1/n)})`),c?c.append(a):this._ensureTransformGroup().append(a)}paintImageMaskXObject(t){const c=this.getObject(t.data,t);if(c.bitmap){(0,S.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const o=this.current,n=c.width,u=c.height,T=o.fillColor;o.maskId=`mask${M++}`;const a=this.svgFactory.createElement("svg:mask");a.setAttributeNS(null,"id",o.maskId);const D=this.svgFactory.createElement("svg:rect");D.setAttributeNS(null,"x","0"),D.setAttributeNS(null,"y","0"),D.setAttributeNS(null,"width",s(n)),D.setAttributeNS(null,"height",s(u)),D.setAttributeNS(null,"fill",T),D.setAttributeNS(null,"mask",`url(#${o.maskId})`),this.defs.append(a),this._ensureTransformGroup().append(D),this.paintInlineImageXObject(c,a)}paintFormXObjectBegin(t,c){if(Array.isArray(t)&&t.length===6&&this.transform(t[0],t[1],t[2],t[3],t[4],t[5]),c){const o=c[2]-c[0],n=c[3]-c[1],u=this.svgFactory.createElement("svg:rect");u.setAttributeNS(null,"x",c[0]),u.setAttributeNS(null,"y",c[1]),u.setAttributeNS(null,"width",s(o)),u.setAttributeNS(null,"height",s(n)),this.current.element=u,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(t){const c=this.svgFactory.create(t.width,t.height),o=this.svgFactory.createElement("svg:defs");c.append(o),this.defs=o;const n=this.svgFactory.createElement("svg:g");return n.setAttributeNS(null,"transform",r(t.transform)),c.append(n),this.svg=n,c}_ensureClipGroup(){if(!this.current.clipGroup){const t=this.svgFactory.createElement("svg:g");t.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(t),this.current.clipGroup=t}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",r(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}}],__webpack_module_cache__={};function __w_pdfjs_require__(K){var i=__webpack_module_cache__[K];if(i!==void 0)return i.exports;var L=__webpack_module_cache__[K]={exports:{}};return __webpack_modules__[K](L,L.exports,__w_pdfjs_require__),L.exports}var __webpack_exports__={};return(()=>{var K=__webpack_exports__;Object.defineProperty(K,"__esModule",{value:!0}),Object.defineProperty(K,"AbortException",{enumerable:!0,get:function(){return i.AbortException}}),Object.defineProperty(K,"AnnotationEditorLayer",{enumerable:!0,get:function(){return W.AnnotationEditorLayer}}),Object.defineProperty(K,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return i.AnnotationEditorParamsType}}),Object.defineProperty(K,"AnnotationEditorType",{enumerable:!0,get:function(){return i.AnnotationEditorType}}),Object.defineProperty(K,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return N.AnnotationEditorUIManager}}),Object.defineProperty(K,"AnnotationLayer",{enumerable:!0,get:function(){return J.AnnotationLayer}}),Object.defineProperty(K,"AnnotationMode",{enumerable:!0,get:function(){return i.AnnotationMode}}),Object.defineProperty(K,"CMapCompressionType",{enumerable:!0,get:function(){return i.CMapCompressionType}}),Object.defineProperty(K,"FeatureTest",{enumerable:!0,get:function(){return i.FeatureTest}}),Object.defineProperty(K,"GlobalWorkerOptions",{enumerable:!0,get:function(){return R.GlobalWorkerOptions}}),Object.defineProperty(K,"InvalidPDFException",{enumerable:!0,get:function(){return i.InvalidPDFException}}),Object.defineProperty(K,"MissingPDFException",{enumerable:!0,get:function(){return i.MissingPDFException}}),Object.defineProperty(K,"OPS",{enumerable:!0,get:function(){return i.OPS}}),Object.defineProperty(K,"PDFDataRangeTransport",{enumerable:!0,get:function(){return L.PDFDataRangeTransport}}),Object.defineProperty(K,"PDFDateString",{enumerable:!0,get:function(){return l.PDFDateString}}),Object.defineProperty(K,"PDFWorker",{enumerable:!0,get:function(){return L.PDFWorker}}),Object.defineProperty(K,"PasswordResponses",{enumerable:!0,get:function(){return i.PasswordResponses}}),Object.defineProperty(K,"PermissionFlag",{enumerable:!0,get:function(){return i.PermissionFlag}}),Object.defineProperty(K,"PixelsPerInch",{enumerable:!0,get:function(){return l.PixelsPerInch}}),Object.defineProperty(K,"RenderingCancelledException",{enumerable:!0,get:function(){return l.RenderingCancelledException}}),Object.defineProperty(K,"SVGGraphics",{enumerable:!0,get:function(){return C.SVGGraphics}}),Object.defineProperty(K,"UnexpectedResponseException",{enumerable:!0,get:function(){return i.UnexpectedResponseException}}),Object.defineProperty(K,"Util",{enumerable:!0,get:function(){return i.Util}}),Object.defineProperty(K,"VerbosityLevel",{enumerable:!0,get:function(){return i.VerbosityLevel}}),Object.defineProperty(K,"XfaLayer",{enumerable:!0,get:function(){return _.XfaLayer}}),Object.defineProperty(K,"build",{enumerable:!0,get:function(){return L.build}}),Object.defineProperty(K,"createPromiseCapability",{enumerable:!0,get:function(){return i.createPromiseCapability}}),Object.defineProperty(K,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return i.createValidAbsoluteUrl}}),Object.defineProperty(K,"getDocument",{enumerable:!0,get:function(){return L.getDocument}}),Object.defineProperty(K,"getFilenameFromUrl",{enumerable:!0,get:function(){return l.getFilenameFromUrl}}),Object.defineProperty(K,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return l.getPdfFilenameFromUrl}}),Object.defineProperty(K,"getXfaPageViewport",{enumerable:!0,get:function(){return l.getXfaPageViewport}}),Object.defineProperty(K,"isDataScheme",{enumerable:!0,get:function(){return l.isDataScheme}}),Object.defineProperty(K,"isPdfFile",{enumerable:!0,get:function(){return l.isPdfFile}}),Object.defineProperty(K,"loadScript",{enumerable:!0,get:function(){return l.loadScript}}),Object.defineProperty(K,"renderTextLayer",{enumerable:!0,get:function(){return S.renderTextLayer}}),Object.defineProperty(K,"setLayerDimensions",{enumerable:!0,get:function(){return l.setLayerDimensions}}),Object.defineProperty(K,"shadow",{enumerable:!0,get:function(){return i.shadow}}),Object.defineProperty(K,"updateTextLayer",{enumerable:!0,get:function(){return S.updateTextLayer}}),Object.defineProperty(K,"version",{enumerable:!0,get:function(){return L.version}});var i=__w_pdfjs_require__(1),L=__w_pdfjs_require__(2),l=__w_pdfjs_require__(6),S=__w_pdfjs_require__(26),W=__w_pdfjs_require__(27),N=__w_pdfjs_require__(5),J=__w_pdfjs_require__(32),R=__w_pdfjs_require__(14),C=__w_pdfjs_require__(35),_=__w_pdfjs_require__(34)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;const PdfViewer_svelte_svelte_type_style_lang="";function create_fragment$1(K){let i,L;return{c(){i=element("div"),L=element("div"),this.h()},l(l){i=claim_element(l,"DIV",{class:!0});var S=children(i);L=claim_element(S,"DIV",{class:!0,style:!0}),children(L).forEach(detach),S.forEach(detach),this.h()},h(){attr(L,"class","pdf-wrapper svelte-1wof5r0"),set_style(L,"--scale-factor","1.2"),attr(i,"class","pdf-container svelte-1wof5r0")},m(l,S){insert_hydration(l,i,S),append_hydration(i,L),K[2](L)},p:noop,i:noop,o:noop,d(l){l&&detach(i),K[2](null)}}}function instance$1(K,i,L){pdfExports.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.5.141/pdf.worker.min.js";let{url:l=""}=i,S;async function W(R){const C=R.getViewport({scale:1}),_=document.createElement("div");_.style.marginBottom="16px",_.style.position="relative",_.style.width="100%",_.style.maxWidth="100%",_.id=`page-${R._pageIndex+1}`;const w=document.createElement("canvas"),y=w.getContext("2d");if(!y)return;const A=S.clientWidth-32,d=Math.min(1.2,A/C.width),g=R.getViewport({scale:d});w.height=g.height,w.width=g.width,w.style.width="100%",w.style.height="auto",w.style.maxWidth="100%",_.appendChild(w),S.appendChild(_),R.render({canvasContext:y,viewport:g});const s=document.createElement("div");s.className="textLayer",s.style.width="100%",s.style.height=g.height+"px";const r=await R.getTextContent();pdfExports.renderTextLayer({textContentSource:r,viewport:g,container:s}),_.appendChild(s)}let N=!1;onMount(async()=>{const R=await pdfExports.getDocument(l).promise;if(!N)for(let C=1;C<=R.numPages;C++)R.getPage(C).then(W)}),onDestroy(()=>{N=!0});function J(R){binding_callbacks[R?"unshift":"push"](()=>{S=R,L(0,S)})}return K.$$set=R=>{"url"in R&&L(1,l=R.url)},[S,l,J]}class PdfViewer extends SvelteComponent{constructor(i){super(),init(this,i,instance$1,create_fragment$1,safe_not_equal,{url:1})}}function create_if_block_6(K){let i,L,l=K[0].error+"",S;return{c(){i=element("div"),L=text("Error: "),S=text(l),this.h()},l(W){i=claim_element(W,"DIV",{class:!0});var N=children(i);L=claim_text(N,"Error: "),S=claim_text(N,l),N.forEach(detach),this.h()},h(){attr(i,"class","p-4 bg-red-100 border border-red-400 text-red-700 rounded")},m(W,N){insert_hydration(W,i,N),append_hydration(i,L),append_hydration(i,S)},p(W,N){N&1&&l!==(l=W[0].error+"")&&set_data(S,l)},d(W){W&&detach(i)}}}function create_if_block(K){let i,L,l,S,W,N,J,R,C=!K[3]&&create_if_block_5(K),_=!K[1]&&create_if_block_2(K),w=K[2]&&create_if_block_1(K);return{c(){i=element("div"),L=element("div"),C&&C.c(),S=space(),W=element("div"),_&&_.c(),J=space(),w&&w.c(),this.h()},l(y){i=claim_element(y,"DIV",{class:!0,style:!0});var A=children(i);L=claim_element(A,"DIV",{class:!0});var d=children(L);C&&C.l(d),d.forEach(detach),S=claim_space(A),W=claim_element(A,"DIV",{class:!0});var g=children(W);_&&_.l(g),g.forEach(detach),J=claim_space(A),w&&w.l(A),A.forEach(detach),this.h()},h(){attr(L,"class",l="chat-panel transition-all duration-300 ease-in-out border border-slate-700 rounded-lg overflow-hidden w-full "+(K[3]?"md:w-0 md:opacity-0 md:min-w-0":K[1]?"md:w-full":"md:w-2/5")),attr(W,"class",N="hidden md:flex pdf-panel transition-all duration-300 ease-in-out bg-slate-800 border border-slate-700 rounded-lg overflow-hidden "+(K[1]?"w-0 opacity-0 min-w-0":K[3]?"w-full":"w-3/5")),attr(i,"class","chat-container h-full flex relative bg-slate-900 overflow-hidden gap-0 md:gap-2"),set_style(i,"height","calc(100vh - 120px)")},m(y,A){insert_hydration(y,i,A),append_hydration(i,L),C&&C.m(L,null),append_hydration(i,S),append_hydration(i,W),_&&_.m(W,null),append_hydration(i,J),w&&w.m(i,null),R=!0},p(y,A){y[3]?C&&(group_outros(),transition_out(C,1,1,()=>{C=null}),check_outros()):C?(C.p(y,A),A&8&&transition_in(C,1)):(C=create_if_block_5(y),C.c(),transition_in(C,1),C.m(L,null)),(!R||A&10&&l!==(l="chat-panel transition-all duration-300 ease-in-out border border-slate-700 rounded-lg overflow-hidden w-full "+(y[3]?"md:w-0 md:opacity-0 md:min-w-0":y[1]?"md:w-full":"md:w-2/5")))&&attr(L,"class",l),y[1]?_&&(group_outros(),transition_out(_,1,1,()=>{_=null}),check_outros()):_?(_.p(y,A),A&2&&transition_in(_,1)):(_=create_if_block_2(y),_.c(),transition_in(_,1),_.m(W,null)),(!R||A&10&&N!==(N="hidden md:flex pdf-panel transition-all duration-300 ease-in-out bg-slate-800 border border-slate-700 rounded-lg overflow-hidden "+(y[1]?"w-0 opacity-0 min-w-0":y[3]?"w-full":"w-3/5")))&&attr(W,"class",N),y[2]?w?(w.p(y,A),A&4&&transition_in(w,1)):(w=create_if_block_1(y),w.c(),transition_in(w,1),w.m(i,null)):w&&(group_outros(),transition_out(w,1,1,()=>{w=null}),check_outros())},i(y){R||(transition_in(C),transition_in(_),transition_in(w),R=!0)},o(y){transition_out(C),transition_out(_),transition_out(w),R=!1},d(y){y&&detach(i),C&&C.d(),_&&_.d(),w&&w.d()}}}function create_if_block_5(K){let i,L;return i=new ChatPanel({props:{documentId:K[4].id,documentName:K[4].name,onSubmit:K[6],isPdfCollapsed:K[1],togglePdfPanel:K[7],toggleMobilePdf:K[8]}}),{c(){create_component(i.$$.fragment)},l(l){claim_component(i.$$.fragment,l)},m(l,S){mount_component(i,l,S),L=!0},p(l,S){const W={};S&2&&(W.isPdfCollapsed=l[1]),i.$set(W)},i(l){L||(transition_in(i.$$.fragment,l),L=!0)},o(l){transition_out(i.$$.fragment,l),L=!1},d(l){destroy_component(i,l)}}}function create_if_block_2(K){let i,L,l,S,W,N,J,R=truncateFilename(K[4].name,40)+"",C,_,w,y,A,d,g,s,r,k,M,v;function t(u,T){return u[3]?create_if_block_4:create_else_block}let c=t(K),o=c(K),n=!K[3]&&create_if_block_3(K);return r=new PdfViewer({props:{url:K[5]}}),{c(){i=element("div"),L=element("div"),l=element("div"),S=svg_element("svg"),W=svg_element("path"),N=space(),J=element("h3"),C=text(R),_=space(),w=element("div"),y=element("button"),o.c(),d=space(),n&&n.c(),g=space(),s=element("div"),create_component(r.$$.fragment),this.h()},l(u){i=claim_element(u,"DIV",{class:!0});var T=children(i);L=claim_element(T,"DIV",{class:!0});var a=children(L);l=claim_element(a,"DIV",{class:!0});var D=children(l);S=claim_svg_element(D,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var $=children(S);W=claim_svg_element($,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),children(W).forEach(detach),$.forEach(detach),N=claim_space(D),J=claim_element(D,"H3",{class:!0,title:!0});var Y=children(J);C=claim_text(Y,R),Y.forEach(detach),D.forEach(detach),_=claim_space(a),w=claim_element(a,"DIV",{class:!0});var tt=children(w);y=claim_element(tt,"BUTTON",{class:!0,title:!0});var it=children(y);o.l(it),it.forEach(detach),d=claim_space(tt),n&&n.l(tt),tt.forEach(detach),a.forEach(detach),g=claim_space(T),s=claim_element(T,"DIV",{class:!0});var ut=children(s);claim_component(r.$$.fragment,ut),ut.forEach(detach),T.forEach(detach),this.h()},h(){attr(W,"stroke-linecap","round"),attr(W,"stroke-linejoin","round"),attr(W,"stroke-width","2"),attr(W,"d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"),attr(S,"class","w-3.5 h-3.5 text-red-400 flex-shrink-0"),attr(S,"fill","none"),attr(S,"stroke","currentColor"),attr(S,"viewBox","0 0 24 24"),attr(J,"class","text-white font-medium text-xs truncate"),attr(J,"title",K[4].name),attr(l,"class","flex items-center gap-2 min-w-0"),attr(y,"class","p-1 text-slate-400 hover:text-white hover:bg-slate-600 rounded transition-colors"),attr(y,"title",A=K[3]?"Exit Fullscreen":"Fullscreen"),attr(w,"class","flex items-center gap-1.5"),attr(L,"class","flex items-center justify-between p-2.5 bg-slate-700 border-b border-slate-600"),attr(s,"class","flex-1 overflow-hidden bg-gray-100"),attr(i,"class","h-full flex flex-col w-full")},m(u,T){insert_hydration(u,i,T),append_hydration(i,L),append_hydration(L,l),append_hydration(l,S),append_hydration(S,W),append_hydration(l,N),append_hydration(l,J),append_hydration(J,C),append_hydration(L,_),append_hydration(L,w),append_hydration(w,y),o.m(y,null),append_hydration(w,d),n&&n.m(w,null),append_hydration(i,g),append_hydration(i,s),mount_component(r,s,null),k=!0,M||(v=listen(y,"click",K[9]),M=!0)},p(u,T){c!==(c=t(u))&&(o.d(1),o=c(u),o&&(o.c(),o.m(y,null))),(!k||T&8&&A!==(A=u[3]?"Exit Fullscreen":"Fullscreen"))&&attr(y,"title",A),u[3]?n&&(n.d(1),n=null):n?n.p(u,T):(n=create_if_block_3(u),n.c(),n.m(w,null))},i(u){k||(transition_in(r.$$.fragment,u),k=!0)},o(u){transition_out(r.$$.fragment,u),k=!1},d(u){u&&detach(i),o.d(),n&&n.d(),destroy_component(r),M=!1,v()}}}function create_else_block(K){let i,L;return{c(){i=svg_element("svg"),L=svg_element("path"),this.h()},l(l){i=claim_svg_element(l,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var S=children(i);L=claim_svg_element(S,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),children(L).forEach(detach),S.forEach(detach),this.h()},h(){attr(L,"stroke-linecap","round"),attr(L,"stroke-linejoin","round"),attr(L,"stroke-width","2"),attr(L,"d","M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"),attr(i,"class","w-3.5 h-3.5"),attr(i,"fill","none"),attr(i,"stroke","currentColor"),attr(i,"viewBox","0 0 24 24")},m(l,S){insert_hydration(l,i,S),append_hydration(i,L)},d(l){l&&detach(i)}}}function create_if_block_4(K){let i,L;return{c(){i=svg_element("svg"),L=svg_element("path"),this.h()},l(l){i=claim_svg_element(l,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var S=children(i);L=claim_svg_element(S,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),children(L).forEach(detach),S.forEach(detach),this.h()},h(){attr(L,"stroke-linecap","round"),attr(L,"stroke-linejoin","round"),attr(L,"stroke-width","2"),attr(L,"d","M6 18L18 6M6 6l12 12"),attr(i,"class","w-3.5 h-3.5"),attr(i,"fill","none"),attr(i,"stroke","currentColor"),attr(i,"viewBox","0 0 24 24")},m(l,S){insert_hydration(l,i,S),append_hydration(i,L)},d(l){l&&detach(i)}}}function create_if_block_3(K){let i,L,l,S,W;return{c(){i=element("button"),L=svg_element("svg"),l=svg_element("path"),this.h()},l(N){i=claim_element(N,"BUTTON",{class:!0,title:!0});var J=children(i);L=claim_svg_element(J,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var R=children(L);l=claim_svg_element(R,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),children(l).forEach(detach),R.forEach(detach),J.forEach(detach),this.h()},h(){attr(l,"stroke-linecap","round"),attr(l,"stroke-linejoin","round"),attr(l,"stroke-width","2"),attr(l,"d","M6 18L18 6M6 6l12 12"),attr(L,"class","w-3.5 h-3.5"),attr(L,"fill","none"),attr(L,"stroke","currentColor"),attr(L,"viewBox","0 0 24 24"),attr(i,"class","p-1 text-slate-400 hover:text-white hover:bg-slate-600 rounded transition-colors"),attr(i,"title","Close PDF")},m(N,J){insert_hydration(N,i,J),append_hydration(i,L),append_hydration(L,l),S||(W=listen(i,"click",K[7]),S=!0)},p:noop,d(N){N&&detach(i),S=!1,W()}}}function create_if_block_1(K){let i,L,l,S,W,N,J,R,C=truncateFilename(K[4].name,30)+"",_,w,y,A,d,g,s,r,k,M,v;return r=new PdfViewer({props:{url:K[5]}}),{c(){i=element("div"),L=element("div"),l=element("div"),S=element("div"),W=svg_element("svg"),N=svg_element("path"),J=space(),R=element("h3"),_=text(C),w=space(),y=element("button"),A=svg_element("svg"),d=svg_element("path"),g=space(),s=element("div"),create_component(r.$$.fragment),this.h()},l(t){i=claim_element(t,"DIV",{class:!0});var c=children(i);L=claim_element(c,"DIV",{class:!0});var o=children(L);l=claim_element(o,"DIV",{class:!0});var n=children(l);S=claim_element(n,"DIV",{class:!0});var u=children(S);W=claim_svg_element(u,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var T=children(W);N=claim_svg_element(T,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),children(N).forEach(detach),T.forEach(detach),J=claim_space(u),R=claim_element(u,"H3",{class:!0,title:!0});var a=children(R);_=claim_text(a,C),a.forEach(detach),u.forEach(detach),w=claim_space(n),y=claim_element(n,"BUTTON",{class:!0,title:!0});var D=children(y);A=claim_svg_element(D,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var $=children(A);d=claim_svg_element($,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),children(d).forEach(detach),$.forEach(detach),D.forEach(detach),n.forEach(detach),g=claim_space(o),s=claim_element(o,"DIV",{class:!0});var Y=children(s);claim_component(r.$$.fragment,Y),Y.forEach(detach),o.forEach(detach),c.forEach(detach),this.h()},h(){attr(N,"stroke-linecap","round"),attr(N,"stroke-linejoin","round"),attr(N,"stroke-width","2"),attr(N,"d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"),attr(W,"class","w-4 h-4 text-red-400 flex-shrink-0"),attr(W,"fill","none"),attr(W,"stroke","currentColor"),attr(W,"viewBox","0 0 24 24"),attr(R,"class","font-medium text-sm truncate"),attr(R,"title",K[4].name),attr(S,"class","flex items-center gap-2 min-w-0"),attr(d,"stroke-linecap","round"),attr(d,"stroke-linejoin","round"),attr(d,"stroke-width","2"),attr(d,"d","M6 18L18 6M6 6l12 12"),attr(A,"class","w-5 h-5"),attr(A,"fill","none"),attr(A,"stroke","currentColor"),attr(A,"viewBox","0 0 24 24"),attr(y,"class","p-1.5 text-slate-300 hover:text-white hover:bg-slate-600 rounded transition-colors"),attr(y,"title","Close PDF"),attr(l,"class","flex items-center justify-between p-3 bg-slate-700 text-white border-b border-slate-600 flex-shrink-0"),attr(s,"class","flex-1 overflow-hidden bg-gray-100"),attr(L,"class","bg-white h-full w-full flex flex-col"),attr(i,"class","md:hidden fixed inset-0 z-50 bg-black bg-opacity-50")},m(t,c){insert_hydration(t,i,c),append_hydration(i,L),append_hydration(L,l),append_hydration(l,S),append_hydration(S,W),append_hydration(W,N),append_hydration(S,J),append_hydration(S,R),append_hydration(R,_),append_hydration(l,w),append_hydration(l,y),append_hydration(y,A),append_hydration(A,d),append_hydration(L,g),append_hydration(L,s),mount_component(r,s,null),k=!0,M||(v=[listen(y,"click",K[8]),listen(L,"click",stop_propagation(K[10])),listen(i,"click",K[8])],M=!0)},p:noop,i(t){k||(transition_in(r.$$.fragment,t),k=!0)},o(t){transition_out(r.$$.fragment,t),k=!1},d(t){t&&detach(i),destroy_component(r),M=!1,run_all(v)}}}function create_fragment(K){let i,L,l,S=K[0].error&&create_if_block_6(K),W=K[4]&&create_if_block(K);return{c(){S&&S.c(),i=space(),W&&W.c(),L=empty()},l(N){S&&S.l(N),i=claim_space(N),W&&W.l(N),L=empty()},m(N,J){S&&S.m(N,J),insert_hydration(N,i,J),W&&W.m(N,J),insert_hydration(N,L,J),l=!0},p(N,[J]){N[0].error?S?S.p(N,J):(S=create_if_block_6(N),S.c(),S.m(i.parentNode,i)):S&&(S.d(1),S=null),N[4]&&W.p(N,J)},i(N){l||(transition_in(W),l=!0)},o(N){transition_out(W),l=!1},d(N){S&&S.d(N),N&&detach(i),W&&W.d(N),N&&detach(L)}}}function truncateFilename(K,i=30){if(K.length<=i)return K;const L=K.split(".").pop(),l=K.substring(0,K.lastIndexOf("."));if(L){const S=i-L.length-4;return l.substring(0,S)+"...."+L}return K.substring(0,i-3)+"..."}function instance(K,i,L){let{data:l}=i;const S=l.document,W=l.documentUrl;let N=!1,J=!1,R=!1;function C(d,g){sendMessage({role:"user",content:d},{useStreaming:g,documentId:S.id})}function _(){R&&L(3,R=!1),L(1,N=!N)}function w(){L(2,J=!J)}function y(){L(3,R=!R),R&&L(1,N=!1)}beforeNavigate(resetAll);function A(d){bubble.call(this,K,d)}return K.$$set=d=>{"data"in d&&L(0,l=d.data)},[l,N,J,R,S,W,C,_,w,y,A]}class Page extends SvelteComponent{constructor(i){super(),init(this,i,instance,create_fragment,safe_not_equal,{data:0})}}export{Page as default};
